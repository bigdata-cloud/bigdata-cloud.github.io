<!DOCTYPE html><html lang="en"><head><meta charSet="utf-8"/><meta http-equiv="x-ua-compatible" content="ie=edge"/><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"/><meta property="twitter:card" content="summary_large_image"/><link rel="shortcut icon" type="image/svg" href="https://media.glassdoor.com/sqll/591152/central-european-university-squarelogo-1430146462267.png"/><noscript></noscript><meta name="generator" content="Gatsby 2.24.85"/><link rel="sitemap" type="application/xml" href="/courseware/sitemap.xml"/><title data-react-helmet="true">Week 6 - Apache Spark APIs</title><link data-react-helmet="true" rel="canonical" href="http://localhost:8000//courseware//sparkAPI"/><meta data-react-helmet="true" name="title" content="Week 6 - Apache Spark APIs"/><meta data-react-helmet="true" name="description" content="Week 6 - Apache Spark APIs"/><meta data-react-helmet="true" property="og:title" content="Week 6 - Apache Spark APIs"/><meta data-react-helmet="true" property="og:description" content="Week 6 - Apache Spark APIs"/><meta data-react-helmet="true" property="twitter:title" content="Week 6 - Apache Spark APIs"/><meta data-react-helmet="true" property="twitter:description" content="Week 6 - Apache Spark APIs"/><link as="script" rel="preload" href="/courseware/webpack-runtime-d9051b0ba854d717e0f5.js"/><link as="script" rel="preload" href="/courseware/framework-c90682c3d94fb45fdc20.js"/><link as="script" rel="preload" href="/courseware/commons-2ef445fb87a62dd81c1d.js"/><link as="script" rel="preload" href="/courseware/app-0f03f9d6df3e68604912.js"/><link as="fetch" rel="preload" href="/courseware/page-data/sparkAPI/page-data.json" crossorigin="anonymous"/><link as="fetch" rel="preload" href="/courseware/page-data/sq/d/2619113677.json" crossorigin="anonymous"/><link as="fetch" rel="preload" href="/courseware/page-data/sq/d/2619113677.json" crossorigin="anonymous"/><link as="fetch" rel="preload" href="/courseware/page-data/sq/d/3706406642.json" crossorigin="anonymous"/><link as="fetch" rel="preload" href="/courseware/page-data/sq/d/3706406642.json" crossorigin="anonymous"/><link as="fetch" rel="preload" href="/courseware/page-data/sq/d/417421954.json" crossorigin="anonymous"/><link as="fetch" rel="preload" href="/courseware/page-data/sq/d/417421954.json" crossorigin="anonymous"/><link as="fetch" rel="preload" href="/courseware/page-data/app-data.json" crossorigin="anonymous"/></head><body><div id="___gatsby"><div style="outline:none" tabindex="-1" id="gatsby-focus-wrapper"><div><style data-emotion-css="0"></style><div class="navBarWrapper"><nav class="navBarDefault"><div class="navBarHeader"><a href="https://ceu.edu/" class="navBarBrand"><img class="img-responsive displayInline" src="https://upload.wikimedia.org/wikipedia/commons/thumb/2/23/Central_European_University_Logo.svg/1280px-Central_European_University_Logo.svg.png" alt="logo"/></a><div class="headerTitle displayInline"><a href='https://datapao.com/'><img class='img-responsive' src='https://datapao.com/wp-content/themes/datapao/img/footer.svg'/></a></div></div><ul class="socialWrapper visibleMobileView"><li>
		    <a href="https://twitter.com/DE2course" target="_blank" rel="noopener">
		      <div class="twitterBtn">
		        <img src='https://graphql-engine-cdn.hasura.io/learn-hasura/assets/homepage/twitter-brands-block.svg' alt={'Twitter'}/>
		      </div>
		    </a>
		  </li>
			<li>
		    <a href="https://ceu-bizanalytics.slack.com/#/" target="_blank" rel="noopener">
		      <div class="discordBtn">
		        <img src='https://cdn-5dc591f7f911c91c58a5564e.closte.com/wp-content/uploads/2020/03/slack-icon.png' alt={'Slack'}/>
		      </div>
		    </a>
		  </li></ul><div id="navbar" class="topnav"><div class="visibleMobile"><style data-emotion-css="8uxxw2">.css-8uxxw2{width:100%;height:100vh;overflow:auto;position:fixed;padding-left:0px;position:-webkit-sticky;position:-moz-sticky;position:-webkit-sticky;position:sticky;top:0;padding-right:0;-webkit-box-shadow:-1px 0px 4px 1px rgba(175,158,232,0.4);}@media only screen and (max-width:1023px){.css-8uxxw2{width:100%;height:100vh;}}@media (min-width:767px) and (max-width:1023px){.css-8uxxw2{padding-left:0;}}@media only screen and (max-width:767px){.css-8uxxw2{padding-left:0px;height:auto;}}</style><aside class="css-8uxxw2 eer5zio1"><div class="sidebarTitle hiddenMobile"><a href='#'>CEU </a><div class='greenCircle'></div><a href='#'>Courseware</a></div><ul class="sideBarUL"><li class="hideFrontLine firstLevel item "><ul><li class=" item "><a href="/courseware/syllabus">Welcome - Syllabus</a></li><li class=" item "><a href="/courseware/internet">Week 1- Internet<button aria-label="collapse" class="collapser"><svg xmlns="http://www.w3.org/2000/svg" width="12" height="12" viewBox="0 0 24 24"><path d="M7.33 24l-2.83-2.829 9.339-9.175-9.339-9.167 2.83-2.829 12.17 11.996z"></path></svg></button></a></li><li class=" item "><a href="/courseware/aws">Week 2 - AWS<button aria-label="collapse" class="collapser"><svg xmlns="http://www.w3.org/2000/svg" width="12" height="12" viewBox="0 0 24 24"><path d="M7.33 24l-2.83-2.829 9.339-9.175-9.339-9.167 2.83-2.829 12.17 11.996z"></path></svg></button></a></li><li class=" item "><a href="/courseware/serverless">Week 3 - Serverless<button aria-label="collapse" class="collapser"><svg xmlns="http://www.w3.org/2000/svg" width="12" height="12" viewBox="0 0 24 24"><path d="M7.33 24l-2.83-2.829 9.339-9.175-9.339-9.167 2.83-2.829 12.17 11.996z"></path></svg></button></a></li><li class=" item "><a href="/courseware/apachespark">Week 4 - Apache Spark<button aria-label="collapse" class="collapser"><svg xmlns="http://www.w3.org/2000/svg" width="12" height="12" viewBox="0 0 24 24"><path d="M7.33 24l-2.83-2.829 9.339-9.175-9.339-9.167 2.83-2.829 12.17 11.996z"></path></svg></button></a></li><li class=" item "><a href="/courseware/sparkinternals">Week 5 - Spark Internals<button aria-label="collapse" class="collapser"><svg xmlns="http://www.w3.org/2000/svg" width="12" height="12" viewBox="0 0 24 24"><path d="M7.33 24l-2.83-2.829 9.339-9.175-9.339-9.167 2.83-2.829 12.17 11.996z"></path></svg></button></a></li><li class=" item "><a aria-current="page" class="" href="/courseware/sparkAPI">Week 6 - Apache Spark APIs<button aria-label="collapse" class="collapser"><svg xmlns="http://www.w3.org/2000/svg" width="12" height="12" viewBox="0 0 24 24"><path d="M7.33 24l-2.83-2.829 9.339-9.175-9.339-9.167 2.83-2.829 12.17 11.996z"></path></svg></button></a></li><li class=" item "><a href="/courseware/spark-continued">Week 7 - Apacke Spark Hands-on<button aria-label="collapse" class="collapser"><svg xmlns="http://www.w3.org/2000/svg" width="12" height="12" viewBox="0 0 24 24"><path d="M7.33 24l-2.83-2.829 9.339-9.175-9.339-9.167 2.83-2.829 12.17 11.996z"></path></svg></button></a></li><li class=" item "><a href="/courseware/bigdatahistory">Big Data History [Optional Reading]</a></li><li class=" item "><a href="/courseware/resources">Resources/Help</a></li></ul></li><style data-emotion-css="1q387v1">.css-1q387v1{list-style:none;padding:0.5rem 0;}.css-1q387v1 hr{margin:0;padding:0;border:0;border-bottom:1px solid #ede7f3;}</style><li class="css-1q387v1 eer5zio2"><hr/></li><style data-emotion-css="1ldulps">.css-1ldulps{list-style:none;}.css-1ldulps a{color:#5c6975;-webkit-text-decoration:none;text-decoration:none;font-weight:400;padding:0.45rem 0 0.45rem 2rem;display:block;position:relative;}.css-1ldulps a:hover{color:#125fb3 !important;}.css-1ldulps a svg{float:right;margin-right:1rem;}</style><li class="css-1ldulps eer5zio0"><a href="http://localhost:8000/" to="http://localhost:8000/" target="_blank" rel="noopener noreferrer"> <!-- -->&lt;- Go Back<svg xmlns="http://www.w3.org/2000/svg" width="14" height="14" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M18 13v6a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V8a2 2 0 0 1 2-2h6"></path><polyline points="15 3 21 3 21 9"></polyline><line x1="10" y1="14" x2="21" y2="3"></line></svg> </a> </li></ul></aside><hr/></div><ul class="navBarUL navBarNav navBarULRight"><li><a href="https://twitter.com/intent/tweet?&amp;text=Big Data and Cloud Computing Courseware, https://github.com/zoltanctoth/ceu-cloud-bigdata-course" target="_blank" rel="noopener noreferrer"><img class="shareIcon" src="data:image/svg+xml;base64,PD94bWwgdmVyc2lvbj0iMS4wIiBlbmNvZGluZz0idXRmLTgiPz4KPCEtLSBHZW5lcmF0b3I6IEFkb2JlIElsbHVzdHJhdG9yIDIzLjAuMywgU1ZHIEV4cG9ydCBQbHVnLUluIC4gU1ZHIFZlcnNpb246IDYuMDAgQnVpbGQgMCkgIC0tPgo8c3ZnIHZlcnNpb249IjEuMSIgaWQ9IkxheWVyXzEiIHhtbG5zPSJodHRwOi8vd3d3LnczLm9yZy8yMDAwL3N2ZyIgeG1sbnM6eGxpbms9Imh0dHA6Ly93d3cudzMub3JnLzE5OTkveGxpbmsiIHg9IjBweCIgeT0iMHB4IgoJIHZpZXdCb3g9IjAgMCAzNSAyNyIgc3R5bGU9ImVuYWJsZS1iYWNrZ3JvdW5kOm5ldyAwIDAgMzUgMjc7IiB4bWw6c3BhY2U9InByZXNlcnZlIj4KPHN0eWxlIHR5cGU9InRleHQvY3NzIj4KCS5zdDB7ZmlsbC1ydWxlOmV2ZW5vZGQ7Y2xpcC1ydWxlOmV2ZW5vZGQ7ZmlsbDojRkZGRkZGO30KPC9zdHlsZT4KPHBhdGggY2xhc3M9InN0MCIgZD0iTTE3LDcuMmwwLjEsMS4ybC0xLjMtMC4xYy00LjYtMC41LTguNi0yLjQtMTItNS41TDIuMSwxLjFMMS43LDIuM0MwLjgsNC44LDEuMyw3LjUsMy4yLDkuM2MxLDEsMC44LDEuMS0xLDAuNQoJQzEuNyw5LjcsMS4xLDkuNSwxLjEsOS42QzAuOSw5LjgsMS41LDExLjksMiwxMi44YzAuNywxLjIsMiwyLjQsMy41LDMuMWwxLjIsMC41bC0xLjUsMGMtMS40LDAtMS41LDAtMS4zLDAuNQoJYzAuNSwxLjUsMi41LDMuMiw0LjcsMy45bDEuNiwwLjVsLTEuNCwwLjhjLTIsMS4xLTQuNCwxLjctNi44LDEuOEMwLjksMjMuOSwwLDI0LDAsMjQuMWMwLDAuMiwzLjEsMS42LDQuOSwyLjEKCWM1LjQsMS41LDExLjgsMC45LDE2LjYtMS44YzMuNC0xLjksNi44LTUuNiw4LjQtOS4yYzAuOS0xLjksMS43LTUuNSwxLjctNy4xYzAtMS4xLDAuMS0xLjIsMS41LTIuNmMwLjgtMC44LDEuNi0xLjYsMS44LTEuOAoJYzAuMy0wLjUsMC4yLTAuNS0xLjEsMGMtMi4xLDAuNy0yLjUsMC42LTEuNC0wLjVjMC44LTAuOCwxLjctMi4xLDEuNy0yLjVjMC0wLjEtMC40LDAtMC44LDAuM2MtMC41LDAuMi0xLjUsMC42LTIuMiwwLjhsLTEuNCwwLjQKCWwtMS4yLTAuOGMtMC43LTAuNC0xLjYtMC45LTIuMS0xYy0xLjMtMC4zLTMuMy0wLjMtNC40LDAuMUMxOC44LDEuNCwxNi44LDQuMiwxNyw3LjJ6Ii8+Cjwvc3ZnPgo=" alt="Twitter"/></a></li><li class="divider hiddenMobile"></li><li class="hiddenMobile"><ul class="socialWrapper"><li>
		    <a href="https://twitter.com/DE2course" target="_blank" rel="noopener">
		      <div class="twitterBtn">
		        <img src='https://graphql-engine-cdn.hasura.io/learn-hasura/assets/homepage/twitter-brands-block.svg' alt={'Twitter'}/>
		      </div>
		    </a>
		  </li>
			<li>
		    <a href="https://ceu-bizanalytics.slack.com/#/" target="_blank" rel="noopener">
		      <div class="discordBtn">
		        <img src='https://cdn-5dc591f7f911c91c58a5564e.closte.com/wp-content/uploads/2020/03/slack-icon.png' alt={'Slack'}/>
		      </div>
		    </a>
		  </li></ul></li><li class="githubBtn"><span><a href="https://github.com/zoltanctoth/ceu-cloud-bigdata-course" data-show-count="true" aria-label="Star on GitHub">Star</a></span></li><li><style data-emotion-css="o9dm8b">.css-o9dm8b{display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-box-pack:end;-webkit-justify-content:flex-end;-ms-flex-pack:end;justify-content:flex-end;width:100%;padding:0 20px 0 25px;}.css-o9dm8b .switch{position:relative;display:inline-block;width:50px;height:20px;}.css-o9dm8b .switch input{opacity:0;width:0;height:0;}.css-o9dm8b .slider{position:absolute;cursor:pointer;top:0;left:0;right:0;bottom:0;background-color:#ccc;-webkit-transition:0.4s;-webkit-transition:0.4s;transition:0.4s;}.css-o9dm8b .slider:before{position:absolute;content:'';height:30px;width:30px;left:0px;bottom:4px;top:0;bottom:0;margin:auto 0;-webkit-transition:0.4s;-webkit-transition:0.4s;transition:0.4s;box-shadow:0 0px 15px #2020203d;background:white url(data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABgAAAAYCAYAAADgdz34AAAABHNCSVQICAgIfAhkiAAAAAlwSFlzAAAAsQAAALEBxi1JjQAAABl0RVh0U29mdHdhcmUAd3d3Lmlua3NjYXBlLm9yZ5vuPBoAAAOfSURBVEiJlZVLaFxVGMd/333NJG2a+ujUJnGSSWljGvPoQ0tBbIooulDoQgSpEou4UOqiLlzpxoVFEIsgaotaaEhBEXVV8EUXgrao0SYxk6ROjCUxfaQvm8fMPfd+LqZJ5k4ySfxW93yP/+Ocw7mwTOhw21odbG8rzuf6N3fl+iqNDm5rXGreKlXwB1oe8vtr0yanF4JY1YeR2lDzbgnHn5JwxvYJjuhwR7wUjixUXBc3Wfsk/lg7sUYkvmXC1vB+qe3K5IZa90s2cxTNWQASa4B4C0AAfO8kOx8pxnMi4OdaEmbmcg9mIoF7NxLfAiIvSLIrAyChjswpsysg3jy7tEEuLeZgbotUsQL/SjdmIoF4SPl2QM7YNce/mO1xG85+p27dy3lp1XMbIPCrfbGsY0kCM7DxWzWXqgCINQIugh4TQSMuYRRAxSnM/Ss7jvglCfy+1gfwx/bMuhWv/lbR/rp4wLZw88qzPYIcBDIscpazkZdhXf2YMLy1DwnIq1Muxv5eMLCp5zPta6qQTb03oRdVDkO7XYpAdLhtrZkcuoKavIp4MxK7ByDrJDtLXr+VhmWy/oE5cECkfPYzpiNP37ZSIE23pLSvyVtAIGR3RTLizn0ay25ZEXjm3vVGL/wWxCrfU22PXH1LMVXR7lzhYu+y4H+1bjWTf45jV6/Bq38+OF/zTYTAEnUjAzozb0bp0H+eW7cUgdT93o274QxeDQChhK9GCELcy5GJILKsDHxzaFkX4qUJp99F5agrzrWIgFy68SPxM/vnMw6y5glg/uYJctBOHn9nOaLCyJ1/ZqeE4WrLldgHUTkGzY1EU+jb/si+t4oPsFSYkX3PWqqnLJGdAmD+SNzU4PqquQ6rDKl4LOIi70T7FN6wA/crSR2bKaypPmmbUfdBCezXEN0DqC1hgwAEg42Hwmwmcjji1UPZ9lIipxB+Ah1FLR90A3AfcGdBz5dOsnOv5Nmxgv7ENQ2uV0RgynYgXmolu1Ic03YQbJPUiXT+xyGEtnPXw1heGG37Bc2e+9/oAq9I6kQaCp5r2Xz2tHqpA4hb8DwrzHSjUz9COL0icEXftJOd7xeQRcMMNT1ObuxzDafcaMVGvFrw6sC6HWTB6DTwkpPs/KTIzSIqhrauM8GNTzHjuwsfwvkpB6w1IHEQVGV1r+vc8aJsPPXDgtaSXgEd2FXtc/V1gslHLabWa5jzEAXsACm/IVbZz8iqw05Dz8lSGP8BjRZeDZkbZsEAAAAASUVORK5CYII=);background-repeat:no-repeat;background-position:center;}.css-o9dm8b input:checked + .slider{background:linear-gradient(to right,white,#125fb3);}.css-o9dm8b input:checked + .slider:before{-webkit-transform:translateX(24px);-ms-transform:translateX(24px);-webkit-transform:translateX(24px);-ms-transform:translateX(24px);transform:translateX(24px);background:white url(data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABgAAAAYCAYAAADgdz34AAAABHNCSVQICAgIfAhkiAAAAAlwSFlzAAAApgAAAKYB3X3/OAAAABl0RVh0U29mdHdhcmUAd3d3Lmlua3NjYXBlLm9yZ5vuPBoAAANGSURBVEiJndVPbNRVEAfwz9vd/q8tBQtoxSYYDKYmejMGD3DxYloMiRoT22IEDQcPno3xoFclMf6JHrDFyIVEI3g2eiDoRWOMfygqNrSkoeAWCtIu230e3m+77e6KCZO8vH3zZuY7M+/7mxVjVFu7C+vPt7mmh4fi+eEDMUYFVZkdeZU7dhgIzxOj25ULe3fJx6PYamZkDYD4rRDmmgafDIdE3aIJbcrKxkQF4/GtBtuY/43KGVBxOsT/S3YijAomEVBCBe0geNlYfLfBZ3bfJmFlp7u/ONUcYCIMCw6jL1vhFikUURS9Zn88Vn9ZaOJA8DTuA3n0Zjm3ZlDL2VrASpZE8CwaABormAgPC75Cny7cmYE0kwou4Rq4IWeP0fhdc4DjIe+GD0QvIKcbmzOrtl56t9O2gRBYvsKVcyz9ne7nsQgiPhUdtD8uNVYwGRbQK497qu3ZzsYHUuB1EimepTiVKplBGZQM6rI7liFX5/Ur0rPmpYw3ZcEL7fRso3eQQgcCfffT0Z+i9K3GOFMNvh7gWOjDYGpJpuvbkQK1dND/IF1b6Oynf4jW7jU2a3zY6uPQ3whw0/u4S5DYIqsAOjdrkKqutSfbVcncL+ejOoAQsC39VGN9yOiTa8LmXIGOx8h11RxqzzTgeHLOAGKUM4pFFdzMzJYX0n79YiPAP/O0PUSlHTE9cCXdCJ7zVFxZA4DReA4/gKVMd/WvtJcWKf6e6FlapPgHS0UW3uPyN9b58IuxOFU91Ne+E+kL7cb1Oa5O0zPI0kJaa+XaLIszif21q4x2if+1ClLP/iRrUfYNufQTF79P2ceY2lFaZP5HLqaCFaUxmOSsT3RWD42j4mh4RnQEnTZYP+pCLh1Se2uZF0FZdNC0o16Plf8GgMnwOZ5Eot9GiefVmbQiDbtitif52njcUx+q+TSNTgoZQAlzddblJj7ByWah0htc2LvL7L5Nq9r98YhBLSo2481Vfbkh+DtytljWaiy+3QwgxOnhIfl4AmdoGTXw2eUGq8lwWNCDD1WUBC+hYNyLTf9iZ554RAiPG/jyjYKcR7E1wa3sxKkGh/H4Sp3mULNsVyVvTgxTqYIYmRk5oOK0e0/8fEvH25B/AZyRWA6LDlu9AAAAAElFTkSuQmCC);background-repeat:no-repeat;background-position:center;}.css-o9dm8b .slider.round{border-radius:34px;}.css-o9dm8b .slider.round:before{border-radius:50%;}</style><div class="css-o9dm8b e1brsgsc0"><label id="switch" class="switch"><input type="checkbox" id="slider" checked=""/> <span class="slider round"> </span> </label> </div></li></ul></div></nav><style data-emotion-css="1gvjyvp">.css-1gvjyvp{height:60px;box-shadow:0 3px 6px 0 rgba(0,0,0,0.16);background-color:#f8f8f8;position:relative;display:none;}@media (max-width:767px){.css-1gvjyvp{display:block;}}</style><div class="css-1gvjyvp e1ykirhh0"><div class="navBarDefault removePadd"><span class="navBarToggle" role="button" tabindex="0"><span class="iconBar"></span><span class="iconBar"></span><span class="iconBar"></span></span></div></div></div><style data-emotion-css="1orzczj">.css-1orzczj{display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-box-pack:justify;-webkit-justify-content:space-between;-ms-flex-pack:justify;justify-content:space-between;background:#fff;}.css-1orzczj .sideBarUL li a{color:#3B454E;}.css-1orzczj .sideBarUL .item > a:hover{background-color:#125fb3;color:#fff !important;}@media only screen and (max-width:767px){.css-1orzczj{display:block;}}</style><div class="css-1orzczj eso2aao0"><style data-emotion-css="192n44p">.css-192n44p{width:298px;}</style><div class="hiddenMobile css-192n44p eso2aao3"><style data-emotion-css="8uxxw2">.css-8uxxw2{width:100%;height:100vh;overflow:auto;position:fixed;padding-left:0px;position:-webkit-sticky;position:-moz-sticky;position:-webkit-sticky;position:sticky;top:0;padding-right:0;-webkit-box-shadow:-1px 0px 4px 1px rgba(175,158,232,0.4);}@media only screen and (max-width:1023px){.css-8uxxw2{width:100%;height:100vh;}}@media (min-width:767px) and (max-width:1023px){.css-8uxxw2{padding-left:0;}}@media only screen and (max-width:767px){.css-8uxxw2{padding-left:0px;height:auto;}}</style><aside class="css-8uxxw2 eer5zio1"><div class="sidebarTitle hiddenMobile"><a href='#'>CEU </a><div class='greenCircle'></div><a href='#'>Courseware</a></div><ul class="sideBarUL"><li class="hideFrontLine firstLevel item "><ul><li class=" item "><a href="/courseware/syllabus">Welcome - Syllabus</a></li><li class=" item "><a href="/courseware/internet">Week 1- Internet<button aria-label="collapse" class="collapser"><svg xmlns="http://www.w3.org/2000/svg" width="12" height="12" viewBox="0 0 24 24"><path d="M7.33 24l-2.83-2.829 9.339-9.175-9.339-9.167 2.83-2.829 12.17 11.996z"></path></svg></button></a></li><li class=" item "><a href="/courseware/aws">Week 2 - AWS<button aria-label="collapse" class="collapser"><svg xmlns="http://www.w3.org/2000/svg" width="12" height="12" viewBox="0 0 24 24"><path d="M7.33 24l-2.83-2.829 9.339-9.175-9.339-9.167 2.83-2.829 12.17 11.996z"></path></svg></button></a></li><li class=" item "><a href="/courseware/serverless">Week 3 - Serverless<button aria-label="collapse" class="collapser"><svg xmlns="http://www.w3.org/2000/svg" width="12" height="12" viewBox="0 0 24 24"><path d="M7.33 24l-2.83-2.829 9.339-9.175-9.339-9.167 2.83-2.829 12.17 11.996z"></path></svg></button></a></li><li class=" item "><a href="/courseware/apachespark">Week 4 - Apache Spark<button aria-label="collapse" class="collapser"><svg xmlns="http://www.w3.org/2000/svg" width="12" height="12" viewBox="0 0 24 24"><path d="M7.33 24l-2.83-2.829 9.339-9.175-9.339-9.167 2.83-2.829 12.17 11.996z"></path></svg></button></a></li><li class=" item "><a href="/courseware/sparkinternals">Week 5 - Spark Internals<button aria-label="collapse" class="collapser"><svg xmlns="http://www.w3.org/2000/svg" width="12" height="12" viewBox="0 0 24 24"><path d="M7.33 24l-2.83-2.829 9.339-9.175-9.339-9.167 2.83-2.829 12.17 11.996z"></path></svg></button></a></li><li class=" item "><a aria-current="page" class="" href="/courseware/sparkAPI">Week 6 - Apache Spark APIs<button aria-label="collapse" class="collapser"><svg xmlns="http://www.w3.org/2000/svg" width="12" height="12" viewBox="0 0 24 24"><path d="M7.33 24l-2.83-2.829 9.339-9.175-9.339-9.167 2.83-2.829 12.17 11.996z"></path></svg></button></a></li><li class=" item "><a href="/courseware/spark-continued">Week 7 - Apacke Spark Hands-on<button aria-label="collapse" class="collapser"><svg xmlns="http://www.w3.org/2000/svg" width="12" height="12" viewBox="0 0 24 24"><path d="M7.33 24l-2.83-2.829 9.339-9.175-9.339-9.167 2.83-2.829 12.17 11.996z"></path></svg></button></a></li><li class=" item "><a href="/courseware/bigdatahistory">Big Data History [Optional Reading]</a></li><li class=" item "><a href="/courseware/resources">Resources/Help</a></li></ul></li><style data-emotion-css="1q387v1">.css-1q387v1{list-style:none;padding:0.5rem 0;}.css-1q387v1 hr{margin:0;padding:0;border:0;border-bottom:1px solid #ede7f3;}</style><li class="css-1q387v1 eer5zio2"><hr/></li><style data-emotion-css="1ldulps">.css-1ldulps{list-style:none;}.css-1ldulps a{color:#5c6975;-webkit-text-decoration:none;text-decoration:none;font-weight:400;padding:0.45rem 0 0.45rem 2rem;display:block;position:relative;}.css-1ldulps a:hover{color:#125fb3 !important;}.css-1ldulps a svg{float:right;margin-right:1rem;}</style><li class="css-1ldulps eer5zio0"><a href="http://localhost:8000/" to="http://localhost:8000/" target="_blank" rel="noopener noreferrer"> <!-- -->&lt;- Go Back<svg xmlns="http://www.w3.org/2000/svg" width="14" height="14" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M18 13v6a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V8a2 2 0 0 1 2-2h6"></path><polyline points="15 3 21 3 21 9"></polyline><line x1="10" y1="14" x2="21" y2="3"></line></svg> </a> </li></ul></aside></div><div class="sidebarTitle sideBarShow"><a href='#'>CEU </a><div class='greenCircle'></div><a href='#'>Courseware</a></div><style data-emotion-css="zj4uvr">.css-zj4uvr{display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-box-flex:1;-webkit-flex-grow:1;-ms-flex-positive:1;flex-grow:1;margin:0px 88px;padding-top:3rem;background:#fff;}.css-zj4uvr table tr{background:#fff;}@media only screen and (max-width:1023px){.css-zj4uvr{padding-left:0;margin:0 10px;padding-top:3rem;}}</style><main class="css-zj4uvr eso2aao1"><style data-emotion-css="14zj307">@media only screen and (max-width:50rem){.css-14zj307{width:100%;position:relative;}}</style><div class="css-14zj307 eso2aao2"><div class="titleWrapper"><style data-emotion-css="1q31z9a">.css-1q31z9a{font-size:32px;line-height:1.5;font-weight:500;border-left:2px solid #125fb3;padding:0 16px;-webkit-flex:1;-ms-flex:1;flex:1;margin-top:0;padding-top:0;color:#000;}</style><h1 class="css-1q31z9a e1uwyxyb0">Week 6 - Apache Spark APIs</h1><style data-emotion-css="qu2iew">.css-qu2iew{padding:1rem 1.5rem;text-align:right;}.css-qu2iew a{font-size:14px;font-weight:500;line-height:1em;-webkit-text-decoration:none;text-decoration:none;color:#555;border:1px solid rgb(211,220,228);cursor:pointer;border-radius:3px;-webkit-transition:all 0.2s ease-out 0s;transition:all 0.2s ease-out 0s;-webkit-text-decoration:none;text-decoration:none;color:rgb(36,42,49);background-color:rgb(255,255,255);box-shadow:rgba(116,129,141,0.1) 0px 1px 1px 0px;height:30px;padding:5px 16px;}.css-qu2iew a:hover{background-color:rgb(245,247,249);}</style><div class="mobileView css-qu2iew e1uwyxyb1"><a href="https://github.com/zoltanctoth/ceu-cloud-bigdata-course/tree/master/sparkAPI.md" class="gitBtn"><img src="data:image/svg+xml;base64,PD94bWwgdmVyc2lvbj0iMS4wIiBlbmNvZGluZz0idXRmLTgiPz4NCjwhLS0gR2VuZXJhdG9yOiBBZG9iZSBJbGx1c3RyYXRvciAyMi4xLjAsIFNWRyBFeHBvcnQgUGx1Zy1JbiAuIFNWRyBWZXJzaW9uOiA2LjAwIEJ1aWxkIDApICAtLT4NCjxzdmcgdmVyc2lvbj0iMS4yIiBiYXNlUHJvZmlsZT0idGlueSIgaWQ9IkxheWVyXzEiIHhtbG5zPSJodHRwOi8vd3d3LnczLm9yZy8yMDAwL3N2ZyIgeG1sbnM6eGxpbms9Imh0dHA6Ly93d3cudzMub3JnLzE5OTkveGxpbmsiDQoJIHg9IjBweCIgeT0iMHB4IiB2aWV3Qm94PSIwIDAgMjM1MCAyMzE0LjgiIHhtbDpzcGFjZT0icHJlc2VydmUiPg0KPHBhdGggZD0iTTExNzUsMEM1MjUuOCwwLDAsNTI1LjgsMCwxMTc1YzAsNTUyLjIsMzc4LjksMTAxMC41LDg5MC4xLDExMzkuN2MtNS45LTE0LjctOC44LTM1LjMtOC44LTU1Ljh2LTE5OS44SDczNC40DQoJYy03OS4zLDAtMTUyLjgtMzUuMi0xODUuMS05OS45Yy0zOC4yLTcwLjUtNDQuMS0xNzkuMi0xNDEtMjQ2LjhjLTI5LjQtMjMuNS01LjktNDcsMjYuNC00NC4xYzYxLjcsMTcuNiwxMTEuNiw1OC44LDE1OC42LDEyMC40DQoJYzQ3LDYxLjcsNjcuNiw3Ni40LDE1NS43LDc2LjRjNDEuMSwwLDEwNS43LTIuOSwxNjQuNS0xMS44YzMyLjMtODIuMyw4OC4xLTE1NS43LDE1NS43LTE5MC45Yy0zOTMuNi00Ny01ODEuNi0yNDAuOS01ODEuNi01MDUuMw0KCWMwLTExNC42LDQ5LjktMjIzLjMsMTMyLjItMzE3LjNjLTI2LjQtOTEuMS02MS43LTI3OS4xLDExLjgtMzUyLjVjMTc2LjMsMCwyODIsMTE0LjYsMzA4LjQsMTQzLjljODguMS0yOS40LDE4NS4xLTQ3LDI4NC45LTQ3DQoJYzEwMi44LDAsMTk2LjgsMTcuNiwyODQuOSw0N2MyNi40LTI5LjQsMTMyLjItMTQzLjksMzA4LjQtMTQzLjljNzAuNSw3MC41LDM4LjIsMjYxLjQsOC44LDM1Mi41YzgyLjMsOTEuMSwxMjkuMywyMDIuNywxMjkuMywzMTcuMw0KCWMwLDI2NC40LTE4NS4xLDQ1OC4zLTU3NS43LDQ5OS40YzEwOC43LDU1LjgsMTg1LjEsMjE0LjQsMTg1LjEsMzMxLjlWMjI1NmMwLDguOC0yLjksMTcuNi0yLjksMjYuNA0KCUMyMDIxLDIxMjMuOCwyMzUwLDE2ODkuMSwyMzUwLDExNzVDMjM1MCw1MjUuOCwxODI0LjIsMCwxMTc1LDBMMTE3NSwweiIvPg0KPC9zdmc+DQo=" alt="Github logo"/> Edit on GitHub</a></div></div><style data-emotion-css="1qktglx">.css-1qktglx{max-width:750px;color:#3B454E;}.css-1qktglx ul,.css-1qktglx ol{-webkit-padding-start:40px;-moz-padding-start:40px;-o-padding-start:40px;margin:24px 0px;padding:0px 0px 0px 2em;}.css-1qktglx ul li,.css-1qktglx ol li{font-size:16px;line-height:1.8;font-weight:400;}.css-1qktglx a{-webkit-transition:color 0.15s;transition:color 0.15s;color:#1000EE;}.css-1qktglx code{border:1px solid #ede7f3;border-radius:4px;padding:2px 6px;font-size:0.9375em;background:#fff;}@media (max-width:767px){.css-1qktglx{padding:0 15px;}}</style><div class="css-1qktglx e1uwyxyb2"><h1 class="heading1" id="thesparkdataframeandsqlapi">The Spark DataFrame and SQL API</h1><p class="paragraph"><a href="https://databricks-prod-cloudfront.cloud.databricks.com/public/4027ec902e239c93eaaa8714f173bcfc/346304/2168141618055043/484361/latest.html" target="_blank" rel="noopener noreferrer">A Gentle Introduction to Apache Spark on Databricks</a></p><p class="paragraph"><a href="https://databricks-prod-cloudfront.cloud.databricks.com/public/4027ec902e239c93eaaa8714f173bcfc/346304/2168141618055109/484361/latest.html" target="_blank" rel="noopener noreferrer">Apache Spark on Databricks for Data Engineers</a></p><h1 class="heading1" id="fundamentalconcepts:">Fundamental concepts:</h1><p class="paragraph">Spark is a distributed programming model in which the user specifies transformations. These transformations build up a directed acyclic graph (DAG) of transformations and action. An action begins the process of execution that graph of instructions, as a single job, by breaking it down into stages and tasks to execute across the cluster. The logical structures that we manipulate with transformations and actions are DataFrames and Datasets. To create a new DataFrame or Dataset, you call a transformation. To start computation or convert to native language types, you call an action.</p><h1 class="heading1" id="structuredapioverview">Structured API Overview</h1><p class="paragraph">Structured APIs are a tool for manipulating all sorts of data, from unstructured log files to semi-structured CSV files and highly structured Parquet (Apache Parquet is a columnar storage format available to any project in the Hadoop ecosystem, regardless of the choice of data processing framework, data model or programming language) files. These APIs refer to three core types of distributed collection APIs:</p><ul><li>Datasets</li><li>DataFrames</li><li>SQL Tables and Views</li></ul><p class="paragraph">Majority of the Structured APIs apply to both batch and streaming computation. This means that when you work with the Structured APIs, it should be simple to migrate from batch to streaming or vice versa with little to no effort. Structured APIs are the fundamental abstraction used to write the majority of data flows. </p><h1 class="heading1" id="dataframesanddatasets">DataFrames and Datasets</h1><p class="paragraph">DataFrames and Datasets are distributed table-like collection with well-defined rows and columns. Each column must have the same number of rows as all the other columns although you can use null to specify the absence of a value and each column has type information that must be consistent for every row in the collection. To Spark, DataFrames and Datasets represent immutable, lazily evaluated plans(transformations) that specify what operations to apply to data residing at a location to generate some output. When we perform an action on a DataFrame, we instruct Spark to perform the actual transformations and return the results. These represent plans of how to manipulate rows and columns to compute the user&#x27;s desired result. </p><p class="paragraph"><strong>Schema:</strong> defines the column names and types of a DataFrame. You can define schemas manually or read a schema from a data source. Schemas consist of types meaning that you need a way of specifying what lies where.</p><p class="paragraph">Spark is effectively a programming language of its own. Spark uses an engine called Catalyst:
<strong>Catalyst:</strong> maintains its own type information through the planning and processing of work. This opens up execution optimizations. </p><h1 class="heading1" id="structuredapis">Structured APIs</h1><table><thead><tr><th>DataFrame</th><th>DataSet</th></tr></thead><tbody><tr><td>untyped (Spark maintains them completely)</td><td>typed (checks whether types conform to the specification at compile time.) Only available to JVM based languages Scala and Java.</td></tr></tbody></table><p class="paragraph">DataFrames are Datasets of <strong>Type Row.</strong> The &quot;Row&quot; type is Spark&#x27;s internal representation of its optimized in-memory format for computation. To Spark in Python and R there is no such thing as a Dataset, everything is a DataFrame and therefore we always operate on that optimized format.</p><h1 class="heading1" id="overviewofstructuredapiexecution">Overview of Structured API Execution</h1><ul><li>Write DataFrame/Dataset/SQL Code</li><li>If valid code, Spark converts this to a Logical Plan</li><li>Spark transforms this Logical Plan, checking for optimizations along the way</li><li>Spark then executes this Physical Plan on the cluster</li></ul><h1 class="heading1" id="logicalplanning">Logical Planning</h1><p class="paragraph">The first phase takes user code and converts it into a logical plan (optimized version of the user&#x27;s set of expressions)
It does this by converting user code into an unresolved logical plan. The plan is unresolved because although your code might be valid, the tables and columns that it refers to might or might not exist. Spark uses the catalog, a repository of all table and DataFrame information to resolve columns and tables in the analyzer. The analyzer might reject the unresolved logical plan if the required column name does not exist in the catalog. If the analyzer can resolve it, the result is passed through the Catalyst Optimizer, a collection of rules that attempt to optimize the logical plan by pushing down predicates or selections. Packages can extend the Catalyst to include their own rules for domain-specific optimizations.</p><h1 class="heading1" id="physicalplanning">Physical Planning</h1><p class="paragraph">After creating the optimized logical plan, Spark begins the physical planning process. The physical plan - often called Spark plan - specifies how the logical plan will execute on the cluster by generating different physical execution strategies and comparing them through a cost model. (Upon selecting a physical plan Spark runs all of this code over RDDs.)</p><h1 class="heading1" id="basicstructuredoperations">Basic Structured Operations</h1><p class="paragraph">DataFrame consists of a series of records that are of type Row and a number of columns that represent a computation expression that can perform on each individual record in the Dataset. Schemas define the name as well as the type of data in each column. Partitioning of the DataFrame defines the layout of the DataFrame or Dataset&#x27;s physical distribution across the cluster. The partitioning scheme defines how that is allocated.</p><h1 class="heading1" id="dataframe">DataFrame</h1><p class="paragraph"><strong>Create DataFrame:</strong></p><style data-emotion-css="fkgcw9">.css-fkgcw9{padding:16px;background:rgb(245,247,249);}</style><pre class="css-fkgcw9 eyprwjk0"><pre><pre class="prism-code language-javascript pre" style="color:#9CDCFE;background-color:#1E1E1E" p="3"><div class="token-line"><span class="token plain">df </span><span class="token operator" style="color:rgb(212, 212, 212)">=</span><span class="token plain"> spark</span><span class="token punctuation" style="color:rgb(212, 212, 212)">.</span><span class="token property-access">read</span><span class="token punctuation" style="color:rgb(212, 212, 212)">.</span><span class="token method function property-access" style="color:rgb(220, 220, 170)">format</span><span class="token punctuation" style="color:rgb(212, 212, 212)">(</span><span class="token string" style="color:rgb(206, 145, 120)">&quot;json/csv/..&quot;</span><span class="token punctuation" style="color:rgb(212, 212, 212)">)</span><span class="token punctuation" style="color:rgb(212, 212, 212)">.</span><span class="token method function property-access" style="color:rgb(220, 220, 170)">load</span><span class="token punctuation" style="color:rgb(212, 212, 212)">(</span><span class="token string" style="color:rgb(206, 145, 120)">&quot;Some/path&quot;</span><span class="token punctuation" style="color:rgb(212, 212, 212)">)</span><span class="token plain"></span></div></pre></pre></pre><p class="paragraph"><strong>Print Schema:</strong></p><pre class="css-fkgcw9 eyprwjk0"><pre><pre class="prism-code language-javascript pre" style="color:#9CDCFE;background-color:#1E1E1E" p="3"><div class="token-line"><span class="token plain">printSchema</span></div><div class="token-line"><span class="token plain">df</span><span class="token punctuation" style="color:rgb(212, 212, 212)">.</span><span class="token method function property-access" style="color:rgb(220, 220, 170)">printSchema</span><span class="token punctuation" style="color:rgb(212, 212, 212)">(</span><span class="token punctuation" style="color:rgb(212, 212, 212)">)</span><span class="token plain"></span></div></pre></pre></pre><h1 class="heading1" id="columnsandexpressions">Columns and Expressions</h1><ul><li>Expressions - when you select, remove manipulate columns from DataFrames</li></ul><p class="paragraph"><strong>Create Column:</strong></p><pre class="css-fkgcw9 eyprwjk0"><pre><pre class="prism-code language-javascript pre" style="color:#9CDCFE;background-color:#1E1E1E" p="3"><div class="token-line"><span class="token keyword module" style="color:rgb(86, 156, 214)">from</span><span class="token plain"> pyspark</span><span class="token punctuation" style="color:rgb(212, 212, 212)">.</span><span class="token property-access">sql</span><span class="token punctuation" style="color:rgb(212, 212, 212)">.</span><span class="token property-access">functions</span><span class="token plain"> </span><span class="token keyword module" style="color:rgb(86, 156, 214)">import</span><span class="token plain"> col</span><span class="token punctuation" style="color:rgb(212, 212, 212)">,</span><span class="token plain"> column</span></div><div class="token-line"><span class="token plain"></span><span class="token function" style="color:rgb(220, 220, 170)">col</span><span class="token punctuation" style="color:rgb(212, 212, 212)">(</span><span class="token string" style="color:rgb(206, 145, 120)">&quot;someColumnName&quot;</span><span class="token punctuation" style="color:rgb(212, 212, 212)">)</span><span class="token plain"></span></div><div class="token-line"><span class="token plain"></span><span class="token function" style="color:rgb(220, 220, 170)">column</span><span class="token punctuation" style="color:rgb(212, 212, 212)">(</span><span class="token string" style="color:rgb(206, 145, 120)">&quot;someColumnName&quot;</span><span class="token punctuation" style="color:rgb(212, 212, 212)">)</span><span class="token plain"></span></div></pre></pre></pre><p class="paragraph"><em>Explicit Column References</em></p><ul><li>If you need to refer to a specific DataFrame&#x27;s column, you can use the col method on the specific DataFrame. This can be useful when performing a join and need to refer to a specific column in one DataFrame that might share the same name with another column in the joined DataFrame.</li></ul><p class="paragraph"><em>Expressions</em></p><ul><li>Columns are expressions. An expression is a set of transformations on one or more values in a record in a DataFrame. 
An expression created via the expr function is just a DataFrame column reference.
expr(&quot;someCol&quot;) is equivalent to col(&quot;someCol&quot;)</li></ul><h1 class="heading1" id="recordsandrows">Records and Rows</h1><ul><li>Each row in a DataFrame is a single  record as an object type Row. </li><li>Spark manipulates Row objects using column expressions in order to produce usable values. </li></ul><p class="paragraph"><strong>Create Rows:</strong></p><pre class="css-fkgcw9 eyprwjk0"><pre><pre class="prism-code language-javascript pre" style="color:#9CDCFE;background-color:#1E1E1E" p="3"><div class="token-line"><span class="token keyword module" style="color:rgb(86, 156, 214)">from</span><span class="token plain"> pyspark</span><span class="token punctuation" style="color:rgb(212, 212, 212)">.</span><span class="token property-access">sql</span><span class="token plain"> </span><span class="token keyword module" style="color:rgb(86, 156, 214)">import</span><span class="token plain"> </span><span class="token maybe-class-name">Row</span><span class="token plain"></span></div><div class="token-line"><span class="token plain">myRow </span><span class="token operator" style="color:rgb(212, 212, 212)">=</span><span class="token plain"> </span><span class="token function maybe-class-name" style="color:rgb(220, 220, 170)">Row</span><span class="token punctuation" style="color:rgb(212, 212, 212)">(</span><span class="token string" style="color:rgb(206, 145, 120)">&quot;Hello&quot;</span><span class="token punctuation" style="color:rgb(212, 212, 212)">,</span><span class="token plain"> </span><span class="token maybe-class-name">None</span><span class="token punctuation" style="color:rgb(212, 212, 212)">,</span><span class="token plain"> </span><span class="token number" style="color:rgb(181, 206, 168)">1</span><span class="token punctuation" style="color:rgb(212, 212, 212)">,</span><span class="token plain"> </span><span class="token maybe-class-name">False</span><span class="token punctuation" style="color:rgb(212, 212, 212)">)</span><span class="token plain"></span></div></pre></pre></pre><p class="paragraph"><em>DataFrame Transformations</em></p><ul><li>We can add rows or columns</li><li>We can remove rows and columns</li><li>We can transform a row into a column or vice versa</li><li>We can change the order of rows based on the values in columns</li></ul><h1 class="heading1" id="dataframeapiexampleusingdifferenttypesoffunctionality">DataFrame API Example Using Different types of Functionality</h1><p class="paragraph"><strong>Reading Data:</strong></p><pre class="css-fkgcw9 eyprwjk0"><pre><pre class="prism-code language-javascript pre" style="color:#9CDCFE;background-color:#1E1E1E" p="3"><div class="token-line"><span class="token plain">df </span><span class="token operator" style="color:rgb(212, 212, 212)">=</span><span class="token plain"> spark</span><span class="token punctuation" style="color:rgb(212, 212, 212)">.</span><span class="token property-access">read</span><span class="token plain"> \</span></div><div class="token-line"><span class="token plain">  </span><span class="token punctuation" style="color:rgb(212, 212, 212)">.</span><span class="token method function property-access" style="color:rgb(220, 220, 170)">option</span><span class="token punctuation" style="color:rgb(212, 212, 212)">(</span><span class="token string" style="color:rgb(206, 145, 120)">&quot;header&quot;</span><span class="token punctuation" style="color:rgb(212, 212, 212)">,</span><span class="token plain"> </span><span class="token maybe-class-name">True</span><span class="token punctuation" style="color:rgb(212, 212, 212)">)</span><span class="token plain"> \</span></div><div class="token-line"><span class="token plain">  </span><span class="token punctuation" style="color:rgb(212, 212, 212)">.</span><span class="token method function property-access" style="color:rgb(220, 220, 170)">option</span><span class="token punctuation" style="color:rgb(212, 212, 212)">(</span><span class="token string" style="color:rgb(206, 145, 120)">&quot;sep&quot;</span><span class="token punctuation" style="color:rgb(212, 212, 212)">,</span><span class="token plain"> </span><span class="token string" style="color:rgb(206, 145, 120)">&quot;,&quot;</span><span class="token punctuation" style="color:rgb(212, 212, 212)">)</span><span class="token plain"> \</span></div><div class="token-line"><span class="token plain">  </span><span class="token punctuation" style="color:rgb(212, 212, 212)">.</span><span class="token method function property-access" style="color:rgb(220, 220, 170)">option</span><span class="token punctuation" style="color:rgb(212, 212, 212)">(</span><span class="token string" style="color:rgb(206, 145, 120)">&quot;inferSchema&quot;</span><span class="token punctuation" style="color:rgb(212, 212, 212)">,</span><span class="token plain"> </span><span class="token maybe-class-name">True</span><span class="token punctuation" style="color:rgb(212, 212, 212)">)</span><span class="token plain"> \</span></div><div class="token-line"><span class="token plain">  </span><span class="token punctuation" style="color:rgb(212, 212, 212)">.</span><span class="token method function property-access" style="color:rgb(220, 220, 170)">csv</span><span class="token punctuation" style="color:rgb(212, 212, 212)">(</span><span class="token string" style="color:rgb(206, 145, 120)">&quot;PATH/file.csv&quot;</span><span class="token punctuation" style="color:rgb(212, 212, 212)">)</span><span class="token plain"> </span></div></pre></pre></pre><h2 class="heading2" id="show()">show()</h2><blockquote><p class="paragraph">If you want to see top 20 rows of DataFrame in a tabular form then use the following command.</p></blockquote><pre class="css-fkgcw9 eyprwjk0"><pre><pre class="prism-code language-javascript pre" style="color:#9CDCFE;background-color:#1E1E1E" p="3"><div class="token-line"><span class="token plain" style="display:inline-block"></span></div><div class="token-line"><span class="token plain">carDataFrame</span><span class="token punctuation" style="color:rgb(212, 212, 212)">.</span><span class="token method function property-access" style="color:rgb(220, 220, 170)">show</span><span class="token punctuation" style="color:rgb(212, 212, 212)">(</span><span class="token punctuation" style="color:rgb(212, 212, 212)">)</span><span class="token plain"></span></div><div class="token-line"><span class="token plain" style="display:inline-block"></span></div></pre></pre></pre><p class="paragraph"><img src="https://github.com/rklick-solutions/spark-tutorial/wiki/images/showdata.png" alt="alt text"/></p><h2 class="heading2" id="show(n)">show(n)</h2><blockquote><p class="paragraph">If you want to see n  rows of DataFrame in a tabular form then use the following command.</p></blockquote><pre class="css-fkgcw9 eyprwjk0"><pre><pre class="prism-code language-javascript pre" style="color:#9CDCFE;background-color:#1E1E1E" p="3"><div class="token-line"><span class="token plain" style="display:inline-block"></span></div><div class="token-line"><span class="token plain">carDataFrame</span><span class="token punctuation" style="color:rgb(212, 212, 212)">.</span><span class="token method function property-access" style="color:rgb(220, 220, 170)">show</span><span class="token punctuation" style="color:rgb(212, 212, 212)">(</span><span class="token number" style="color:rgb(181, 206, 168)">2</span><span class="token punctuation" style="color:rgb(212, 212, 212)">)</span><span class="token plain"></span></div><div class="token-line"><span class="token plain" style="display:inline-block"></span></div></pre></pre></pre><p class="paragraph"><img src="https://github.com/rklick-solutions/spark-tutorial/wiki/images/shown.png" alt="alt text"/></p><h2 class="heading2" id="take()">take()</h2><blockquote><p class="paragraph">take(n) Returns the first n rows in the DataFrame.</p></blockquote><pre class="css-fkgcw9 eyprwjk0"><pre><pre class="prism-code language-javascript pre" style="color:#9CDCFE;background-color:#1E1E1E" p="3"><div class="token-line"><span class="token plain" style="display:inline-block"></span></div><div class="token-line"><span class="token plain">carDataFrame</span><span class="token punctuation" style="color:rgb(212, 212, 212)">.</span><span class="token method function property-access" style="color:rgb(220, 220, 170)">take</span><span class="token punctuation" style="color:rgb(212, 212, 212)">(</span><span class="token number" style="color:rgb(181, 206, 168)">2</span><span class="token punctuation" style="color:rgb(212, 212, 212)">)</span><span class="token punctuation" style="color:rgb(212, 212, 212)">.</span><span class="token method function property-access" style="color:rgb(220, 220, 170)">foreach</span><span class="token punctuation" style="color:rgb(212, 212, 212)">(</span><span class="token plain">println</span><span class="token punctuation" style="color:rgb(212, 212, 212)">)</span><span class="token plain"></span></div><div class="token-line"><span class="token plain" style="display:inline-block"></span></div></pre></pre></pre><p class="paragraph"><img src="https://github.com/rklick-solutions/spark-tutorial/wiki/images/takedata.png" alt="alt text"/></p><h2 class="heading2" id="count()">count()</h2><blockquote><p class="paragraph">Returns the number of rows.</p></blockquote><pre class="css-fkgcw9 eyprwjk0"><pre><pre class="prism-code language-javascript pre" style="color:#9CDCFE;background-color:#1E1E1E" p="3"><div class="token-line"><span class="token plain" style="display:inline-block"></span></div><div class="token-line"><span class="token plain">carDataFrame</span><span class="token punctuation" style="color:rgb(212, 212, 212)">.</span><span class="token method function property-access" style="color:rgb(220, 220, 170)">groupBy</span><span class="token punctuation" style="color:rgb(212, 212, 212)">(</span><span class="token string" style="color:rgb(206, 145, 120)">&quot;speed&quot;</span><span class="token punctuation" style="color:rgb(212, 212, 212)">)</span><span class="token punctuation" style="color:rgb(212, 212, 212)">.</span><span class="token method function property-access" style="color:rgb(220, 220, 170)">count</span><span class="token punctuation" style="color:rgb(212, 212, 212)">(</span><span class="token punctuation" style="color:rgb(212, 212, 212)">)</span><span class="token punctuation" style="color:rgb(212, 212, 212)">.</span><span class="token method function property-access" style="color:rgb(220, 220, 170)">show</span><span class="token punctuation" style="color:rgb(212, 212, 212)">(</span><span class="token punctuation" style="color:rgb(212, 212, 212)">)</span><span class="token plain"></span></div><div class="token-line"><span class="token plain" style="display:inline-block"></span></div></pre></pre></pre><p class="paragraph"><img src="https://github.com/rklick-solutions/spark-tutorial/wiki/images/countdata.png" alt="alt text"/></p><h2 class="heading2" id="head()">head()</h2><blockquote><p class="paragraph">head () is used to returns first row.</p></blockquote><pre class="css-fkgcw9 eyprwjk0"><pre><pre class="prism-code language-javascript pre" style="color:#9CDCFE;background-color:#1E1E1E" p="3"><div class="token-line"><span class="token plain" style="display:inline-block"></span></div><div class="token-line"><span class="token plain">resultHead </span><span class="token operator" style="color:rgb(212, 212, 212)">=</span><span class="token plain"> carDataFrame</span><span class="token punctuation" style="color:rgb(212, 212, 212)">.</span><span class="token method function property-access" style="color:rgb(220, 220, 170)">head</span><span class="token punctuation" style="color:rgb(212, 212, 212)">(</span><span class="token punctuation" style="color:rgb(212, 212, 212)">)</span><span class="token plain"></span></div><div class="token-line"><span class="token plain" style="display:inline-block"></span></div><div class="token-line"><span class="token plain">    </span><span class="token function" style="color:rgb(220, 220, 170)">println</span><span class="token punctuation" style="color:rgb(212, 212, 212)">(</span><span class="token plain">resultHead</span><span class="token punctuation" style="color:rgb(212, 212, 212)">.</span><span class="token method function property-access" style="color:rgb(220, 220, 170)">mkString</span><span class="token punctuation" style="color:rgb(212, 212, 212)">(</span><span class="token string" style="color:rgb(206, 145, 120)">&quot;,&quot;</span><span class="token punctuation" style="color:rgb(212, 212, 212)">)</span><span class="token punctuation" style="color:rgb(212, 212, 212)">)</span><span class="token plain"></span></div></pre></pre></pre><p class="paragraph"><img src="https://github.com/rklick-solutions/spark-tutorial/wiki/images/headdata.png" alt="alt text"/></p><h2 class="heading2" id="head(n)">head(n)</h2><blockquote><p class="paragraph">head(n) returns first n rows.</p></blockquote><pre class="css-fkgcw9 eyprwjk0"><pre><pre class="prism-code language-javascript pre" style="color:#9CDCFE;background-color:#1E1E1E" p="3"><div class="token-line"><span class="token plain">resultHeadNo </span><span class="token operator" style="color:rgb(212, 212, 212)">=</span><span class="token plain"> carDataFrame</span><span class="token punctuation" style="color:rgb(212, 212, 212)">.</span><span class="token method function property-access" style="color:rgb(220, 220, 170)">head</span><span class="token punctuation" style="color:rgb(212, 212, 212)">(</span><span class="token number" style="color:rgb(181, 206, 168)">3</span><span class="token punctuation" style="color:rgb(212, 212, 212)">)</span><span class="token plain"></span></div><div class="token-line"><span class="token plain" style="display:inline-block"></span></div><div class="token-line"><span class="token plain">    </span><span class="token function" style="color:rgb(220, 220, 170)">println</span><span class="token punctuation" style="color:rgb(212, 212, 212)">(</span><span class="token plain">resultHeadNo</span><span class="token punctuation" style="color:rgb(212, 212, 212)">.</span><span class="token method function property-access" style="color:rgb(220, 220, 170)">mkString</span><span class="token punctuation" style="color:rgb(212, 212, 212)">(</span><span class="token string" style="color:rgb(206, 145, 120)">&quot;,&quot;</span><span class="token punctuation" style="color:rgb(212, 212, 212)">)</span><span class="token punctuation" style="color:rgb(212, 212, 212)">)</span><span class="token plain"></span></div></pre></pre></pre><p class="paragraph"><img src="https://github.com/rklick-solutions/spark-tutorial/wiki/images/headn.png" alt="alt text"/></p><h2 class="heading2" id="first()">first()</h2><blockquote><p class="paragraph">Returns the first row.</p></blockquote><pre class="css-fkgcw9 eyprwjk0"><pre><pre class="prism-code language-javascript pre" style="color:#9CDCFE;background-color:#1E1E1E" p="3"><div class="token-line"><span class="token plain">resultFirst </span><span class="token operator" style="color:rgb(212, 212, 212)">=</span><span class="token plain"> carDataFrame</span><span class="token punctuation" style="color:rgb(212, 212, 212)">.</span><span class="token method function property-access" style="color:rgb(220, 220, 170)">first</span><span class="token punctuation" style="color:rgb(212, 212, 212)">(</span><span class="token punctuation" style="color:rgb(212, 212, 212)">)</span><span class="token plain"></span></div><div class="token-line"><span class="token plain" style="display:inline-block"></span></div><div class="token-line"><span class="token plain">    </span><span class="token function" style="color:rgb(220, 220, 170)">println</span><span class="token punctuation" style="color:rgb(212, 212, 212)">(</span><span class="token string" style="color:rgb(206, 145, 120)">&quot;fist:&quot;</span><span class="token plain"> </span><span class="token operator" style="color:rgb(212, 212, 212)">+</span><span class="token plain"> resultFirst</span><span class="token punctuation" style="color:rgb(212, 212, 212)">.</span><span class="token method function property-access" style="color:rgb(220, 220, 170)">mkString</span><span class="token punctuation" style="color:rgb(212, 212, 212)">(</span><span class="token string" style="color:rgb(206, 145, 120)">&quot;,&quot;</span><span class="token punctuation" style="color:rgb(212, 212, 212)">)</span><span class="token punctuation" style="color:rgb(212, 212, 212)">)</span><span class="token plain"></span></div><div class="token-line"><span class="token plain" style="display:inline-block"></span></div></pre></pre></pre><p class="paragraph"><img src="https://github.com/rklick-solutions/spark-tutorial/wiki/images/firstdata.png" alt="alt text"/></p><h2 class="heading2" id="collect()">collect()</h2><blockquote><p class="paragraph">Returns an array that contains all of Rows in this DataFrame.</p></blockquote><pre class="css-fkgcw9 eyprwjk0"><pre><pre class="prism-code language-javascript pre" style="color:#9CDCFE;background-color:#1E1E1E" p="3"><div class="token-line"><span class="token plain" style="display:inline-block"></span></div><div class="token-line"><span class="token plain">resultCollect </span><span class="token operator" style="color:rgb(212, 212, 212)">=</span><span class="token plain"> carDataFrame</span><span class="token punctuation" style="color:rgb(212, 212, 212)">.</span><span class="token method function property-access" style="color:rgb(220, 220, 170)">collect</span><span class="token punctuation" style="color:rgb(212, 212, 212)">(</span><span class="token punctuation" style="color:rgb(212, 212, 212)">)</span><span class="token plain"></span></div><div class="token-line"><span class="token plain" style="display:inline-block"></span></div><div class="token-line"><span class="token plain">    </span><span class="token function" style="color:rgb(220, 220, 170)">println</span><span class="token punctuation" style="color:rgb(212, 212, 212)">(</span><span class="token plain">resultCollect</span><span class="token punctuation" style="color:rgb(212, 212, 212)">.</span><span class="token method function property-access" style="color:rgb(220, 220, 170)">mkString</span><span class="token punctuation" style="color:rgb(212, 212, 212)">(</span><span class="token string" style="color:rgb(206, 145, 120)">&quot;,&quot;</span><span class="token punctuation" style="color:rgb(212, 212, 212)">)</span><span class="token punctuation" style="color:rgb(212, 212, 212)">)</span><span class="token plain"></span></div><div class="token-line"><span class="token plain" style="display:inline-block"></span></div></pre></pre></pre><p class="paragraph"><img src="https://github.com/rklick-solutions/spark-tutorial/wiki/images/collectdata.png" alt="alt text"/></p><h2 class="heading2" id="basicdataframefunctions:">Basic DataFrame functions:</h2><h2 class="heading2" id="printschema()">printSchema()</h2><blockquote><p class="paragraph">If you want to see the Structure (Schema) of the DataFrame, then use the following command.</p></blockquote><pre class="css-fkgcw9 eyprwjk0"><pre><pre class="prism-code language-javascript pre" style="color:#9CDCFE;background-color:#1E1E1E" p="3"><div class="token-line"><span class="token plain" style="display:inline-block"></span></div><div class="token-line"><span class="token plain">carDataFrame</span><span class="token punctuation" style="color:rgb(212, 212, 212)">.</span><span class="token method function property-access" style="color:rgb(220, 220, 170)">printSchema</span><span class="token punctuation" style="color:rgb(212, 212, 212)">(</span><span class="token punctuation" style="color:rgb(212, 212, 212)">)</span><span class="token plain"></span></div></pre></pre></pre><p class="paragraph"><img src="https://github.com/rklick-solutions/spark-tutorial/wiki/images/printschemadata.png" alt="alt text"/></p><h2 class="heading2" id="todf()">toDF()</h2><blockquote><p class="paragraph"> toDF() Returns a new DataFrame with columns renamed. It  can be quite convenient in conversion from a RDD of tuples into a DataFrame with meaningful names.</p></blockquote><pre class="css-fkgcw9 eyprwjk0"><pre><pre class="prism-code language-javascript pre" style="color:#9CDCFE;background-color:#1E1E1E" p="3"><div class="token-line"><span class="token plain" style="display:inline-block"></span></div><div class="token-line"><span class="token plain">car </span><span class="token operator" style="color:rgb(212, 212, 212)">=</span><span class="token plain"> sc</span><span class="token punctuation" style="color:rgb(212, 212, 212)">.</span><span class="token method function property-access" style="color:rgb(220, 220, 170)">textFile</span><span class="token punctuation" style="color:rgb(212, 212, 212)">(</span><span class="token string" style="color:rgb(206, 145, 120)">&quot;src/main/resources/fruits.txt&quot;</span><span class="token punctuation" style="color:rgb(212, 212, 212)">)</span><span class="token plain"></span></div><div class="token-line"><span class="token plain">      </span><span class="token punctuation" style="color:rgb(212, 212, 212)">.</span><span class="token method function property-access" style="color:rgb(220, 220, 170)">map</span><span class="token punctuation" style="color:rgb(212, 212, 212)">(</span><span class="token plain">_</span><span class="token punctuation" style="color:rgb(212, 212, 212)">.</span><span class="token method function property-access" style="color:rgb(220, 220, 170)">split</span><span class="token punctuation" style="color:rgb(212, 212, 212)">(</span><span class="token string" style="color:rgb(206, 145, 120)">&quot;,&quot;</span><span class="token punctuation" style="color:rgb(212, 212, 212)">)</span><span class="token punctuation" style="color:rgb(212, 212, 212)">)</span><span class="token plain"></span></div><div class="token-line"><span class="token plain">      </span><span class="token punctuation" style="color:rgb(212, 212, 212)">.</span><span class="token method function property-access" style="color:rgb(220, 220, 170)">map</span><span class="token punctuation" style="color:rgb(212, 212, 212)">(</span><span class="token parameter">f</span><span class="token plain"> </span><span class="token arrow operator" style="color:rgb(212, 212, 212)">=&gt;</span><span class="token plain"> </span><span class="token function maybe-class-name" style="color:rgb(220, 220, 170)">Fruit</span><span class="token punctuation" style="color:rgb(212, 212, 212)">(</span><span class="token function" style="color:rgb(220, 220, 170)">f</span><span class="token punctuation" style="color:rgb(212, 212, 212)">(</span><span class="token number" style="color:rgb(181, 206, 168)">0</span><span class="token punctuation" style="color:rgb(212, 212, 212)">)</span><span class="token punctuation" style="color:rgb(212, 212, 212)">.</span><span class="token property-access">trim</span><span class="token punctuation" style="color:rgb(212, 212, 212)">.</span><span class="token property-access">toInt</span><span class="token punctuation" style="color:rgb(212, 212, 212)">,</span><span class="token plain"> </span><span class="token function" style="color:rgb(220, 220, 170)">f</span><span class="token punctuation" style="color:rgb(212, 212, 212)">(</span><span class="token number" style="color:rgb(181, 206, 168)">1</span><span class="token punctuation" style="color:rgb(212, 212, 212)">)</span><span class="token punctuation" style="color:rgb(212, 212, 212)">,</span><span class="token plain"> </span><span class="token function" style="color:rgb(220, 220, 170)">f</span><span class="token punctuation" style="color:rgb(212, 212, 212)">(</span><span class="token number" style="color:rgb(181, 206, 168)">2</span><span class="token punctuation" style="color:rgb(212, 212, 212)">)</span><span class="token punctuation" style="color:rgb(212, 212, 212)">.</span><span class="token property-access">trim</span><span class="token punctuation" style="color:rgb(212, 212, 212)">.</span><span class="token property-access">toInt</span><span class="token punctuation" style="color:rgb(212, 212, 212)">)</span><span class="token punctuation" style="color:rgb(212, 212, 212)">)</span><span class="token plain"></span></div><div class="token-line"><span class="token plain">      </span><span class="token punctuation" style="color:rgb(212, 212, 212)">.</span><span class="token method function property-access" style="color:rgb(220, 220, 170)">toDF</span><span class="token punctuation" style="color:rgb(212, 212, 212)">(</span><span class="token punctuation" style="color:rgb(212, 212, 212)">)</span><span class="token punctuation" style="color:rgb(212, 212, 212)">.</span><span class="token method function property-access" style="color:rgb(220, 220, 170)">show</span><span class="token punctuation" style="color:rgb(212, 212, 212)">(</span><span class="token punctuation" style="color:rgb(212, 212, 212)">)</span><span class="token plain"></span></div><div class="token-line"><span class="token plain" style="display:inline-block"></span></div></pre></pre></pre><p class="paragraph"><img src="https://github.com/rklick-solutions/spark-tutorial/wiki/images/todfdata.png" alt="alt text"/></p><h2 class="heading2" id="dtypes()">dtypes()</h2><blockquote><p class="paragraph">Returns all column names and their data types as an array.</p></blockquote><pre class="css-fkgcw9 eyprwjk0"><pre><pre class="prism-code language-javascript pre" style="color:#9CDCFE;background-color:#1E1E1E" p="3"><div class="token-line"><span class="token plain" style="display:inline-block"></span></div><div class="token-line"><span class="token plain">carDataFrame</span><span class="token punctuation" style="color:rgb(212, 212, 212)">.</span><span class="token property-access">dtypes</span><span class="token punctuation" style="color:rgb(212, 212, 212)">.</span><span class="token method function property-access" style="color:rgb(220, 220, 170)">foreach</span><span class="token punctuation" style="color:rgb(212, 212, 212)">(</span><span class="token plain">println</span><span class="token punctuation" style="color:rgb(212, 212, 212)">)</span><span class="token plain"></span></div><div class="token-line"><span class="token plain" style="display:inline-block"></span></div></pre></pre></pre><p class="paragraph"><img src="https://github.com/rklick-solutions/spark-tutorial/wiki/images/dtypesdata.png" alt="alt text"/></p><h2 class="heading2" id="columns()">columns ()</h2><blockquote><p class="paragraph">Returns all column names as an array.</p></blockquote><pre class="css-fkgcw9 eyprwjk0"><pre><pre class="prism-code language-javascript pre" style="color:#9CDCFE;background-color:#1E1E1E" p="3"><div class="token-line"><span class="token plain" style="display:inline-block"></span></div><div class="token-line"><span class="token plain">carDataFrame</span><span class="token punctuation" style="color:rgb(212, 212, 212)">.</span><span class="token property-access">columns</span><span class="token punctuation" style="color:rgb(212, 212, 212)">.</span><span class="token method function property-access" style="color:rgb(220, 220, 170)">foreach</span><span class="token punctuation" style="color:rgb(212, 212, 212)">(</span><span class="token plain">println</span><span class="token punctuation" style="color:rgb(212, 212, 212)">)</span><span class="token plain"></span></div><div class="token-line"><span class="token plain" style="display:inline-block"></span></div></pre></pre></pre><p class="paragraph"><img src="https://github.com/rklick-solutions/spark-tutorial/wiki/images/columnsdata.png" alt="alt text"/></p><h2 class="heading2" id="cache()">cache()</h2><blockquote><p class="paragraph"> cache() explicitly to store the data into memory. Or data stored in a distributed way in the memory by default.</p></blockquote><pre class="css-fkgcw9 eyprwjk0"><pre><pre class="prism-code language-javascript pre" style="color:#9CDCFE;background-color:#1E1E1E" p="3"><div class="token-line"><span class="token plain">resultCache </span><span class="token operator" style="color:rgb(212, 212, 212)">=</span><span class="token plain"> carDataFrame</span><span class="token punctuation" style="color:rgb(212, 212, 212)">.</span><span class="token method function property-access" style="color:rgb(220, 220, 170)">filter</span><span class="token punctuation" style="color:rgb(212, 212, 212)">(</span><span class="token function" style="color:rgb(220, 220, 170)">carDataFrame</span><span class="token punctuation" style="color:rgb(212, 212, 212)">(</span><span class="token string" style="color:rgb(206, 145, 120)">&quot;speed&quot;</span><span class="token punctuation" style="color:rgb(212, 212, 212)">)</span><span class="token plain"> </span><span class="token operator" style="color:rgb(212, 212, 212)">&gt;</span><span class="token plain"> </span><span class="token number" style="color:rgb(181, 206, 168)">300</span><span class="token punctuation" style="color:rgb(212, 212, 212)">)</span><span class="token plain"></span></div><div class="token-line"><span class="token plain" style="display:inline-block"></span></div><div class="token-line"><span class="token plain">    resultCache</span><span class="token punctuation" style="color:rgb(212, 212, 212)">.</span><span class="token method function property-access" style="color:rgb(220, 220, 170)">cache</span><span class="token punctuation" style="color:rgb(212, 212, 212)">(</span><span class="token punctuation" style="color:rgb(212, 212, 212)">)</span><span class="token punctuation" style="color:rgb(212, 212, 212)">.</span><span class="token method function property-access" style="color:rgb(220, 220, 170)">show</span><span class="token punctuation" style="color:rgb(212, 212, 212)">(</span><span class="token punctuation" style="color:rgb(212, 212, 212)">)</span><span class="token plain"></span></div></pre></pre></pre><p class="paragraph"><img src="https://github.com/rklick-solutions/spark-tutorial/wiki/images/cachedata.png" alt="alt text"/></p><h2 class="heading2" id="dataframeoperations:">Data Frame operations:</h2><h2 class="heading2" id="sort()">sort()</h2><blockquote><p class="paragraph">Returns a new DataFrame sorted by the given expressions.</p></blockquote><pre class="css-fkgcw9 eyprwjk0"><pre><pre class="prism-code language-javascript pre" style="color:#9CDCFE;background-color:#1E1E1E" p="3"><div class="token-line"><span class="token plain" style="display:inline-block"></span></div><div class="token-line"><span class="token plain">carDataFrame</span><span class="token punctuation" style="color:rgb(212, 212, 212)">.</span><span class="token method function property-access" style="color:rgb(220, 220, 170)">sort</span><span class="token punctuation" style="color:rgb(212, 212, 212)">(</span><span class="token plain">$</span><span class="token string" style="color:rgb(206, 145, 120)">&quot;itemNo&quot;</span><span class="token punctuation" style="color:rgb(212, 212, 212)">.</span><span class="token property-access">desc</span><span class="token punctuation" style="color:rgb(212, 212, 212)">)</span><span class="token punctuation" style="color:rgb(212, 212, 212)">.</span><span class="token method function property-access" style="color:rgb(220, 220, 170)">show</span><span class="token punctuation" style="color:rgb(212, 212, 212)">(</span><span class="token punctuation" style="color:rgb(212, 212, 212)">)</span><span class="token plain"></span></div><div class="token-line"><span class="token plain" style="display:inline-block"></span></div></pre></pre></pre><p class="paragraph"><img src="https://github.com/rklick-solutions/spark-tutorial/wiki/images/shortdata.png" alt="alt text"/></p><h2 class="heading2" id="orderby()">orderBy()</h2><blockquote><p class="paragraph">Returns a new DataFrame sorted by the specified column(s).</p></blockquote><pre class="css-fkgcw9 eyprwjk0"><pre><pre class="prism-code language-javascript pre" style="color:#9CDCFE;background-color:#1E1E1E" p="3"><div class="token-line"><span class="token plain" style="display:inline-block"></span></div><div class="token-line"><span class="token plain">carDataFrame</span><span class="token punctuation" style="color:rgb(212, 212, 212)">.</span><span class="token method function property-access" style="color:rgb(220, 220, 170)">orderBy</span><span class="token punctuation" style="color:rgb(212, 212, 212)">(</span><span class="token function" style="color:rgb(220, 220, 170)">desc</span><span class="token punctuation" style="color:rgb(212, 212, 212)">(</span><span class="token string" style="color:rgb(206, 145, 120)">&quot;speed&quot;</span><span class="token punctuation" style="color:rgb(212, 212, 212)">)</span><span class="token punctuation" style="color:rgb(212, 212, 212)">)</span><span class="token punctuation" style="color:rgb(212, 212, 212)">.</span><span class="token method function property-access" style="color:rgb(220, 220, 170)">show</span><span class="token punctuation" style="color:rgb(212, 212, 212)">(</span><span class="token punctuation" style="color:rgb(212, 212, 212)">)</span><span class="token plain"></span></div><div class="token-line"><span class="token plain" style="display:inline-block"></span></div></pre></pre></pre><p class="paragraph"><img src="https://github.com/rklick-solutions/spark-tutorial/wiki/images/orderbydata.png" alt="alt text"/></p><h2 class="heading2" id="groupby()">groupBy()</h2><blockquote><p class="paragraph">counting the number of cars who are of the same speed .</p></blockquote><pre class="css-fkgcw9 eyprwjk0"><pre><pre class="prism-code language-javascript pre" style="color:#9CDCFE;background-color:#1E1E1E" p="3"><div class="token-line"><span class="token plain" style="display:inline-block"></span></div><div class="token-line"><span class="token plain">carDataFrame</span><span class="token punctuation" style="color:rgb(212, 212, 212)">.</span><span class="token method function property-access" style="color:rgb(220, 220, 170)">groupBy</span><span class="token punctuation" style="color:rgb(212, 212, 212)">(</span><span class="token string" style="color:rgb(206, 145, 120)">&quot;speed&quot;</span><span class="token punctuation" style="color:rgb(212, 212, 212)">)</span><span class="token punctuation" style="color:rgb(212, 212, 212)">.</span><span class="token method function property-access" style="color:rgb(220, 220, 170)">count</span><span class="token punctuation" style="color:rgb(212, 212, 212)">(</span><span class="token punctuation" style="color:rgb(212, 212, 212)">)</span><span class="token punctuation" style="color:rgb(212, 212, 212)">.</span><span class="token method function property-access" style="color:rgb(220, 220, 170)">show</span><span class="token punctuation" style="color:rgb(212, 212, 212)">(</span><span class="token punctuation" style="color:rgb(212, 212, 212)">)</span><span class="token plain"></span></div><div class="token-line"><span class="token plain" style="display:inline-block"></span></div></pre></pre></pre><p class="paragraph"><img src="https://github.com/rklick-solutions/spark-tutorial/wiki/images/groupbydata.png" alt="alt text"/></p><h2 class="heading2" id="na()">na()</h2><blockquote><p class="paragraph">Returns a DataFrameNaFunctions for working with missing data.</p></blockquote><pre class="css-fkgcw9 eyprwjk0"><pre><pre class="prism-code language-javascript pre" style="color:#9CDCFE;background-color:#1E1E1E" p="3"><div class="token-line"><span class="token plain" style="display:inline-block"></span></div><div class="token-line"><span class="token plain">carDataFrame</span><span class="token punctuation" style="color:rgb(212, 212, 212)">.</span><span class="token property-access">na</span><span class="token punctuation" style="color:rgb(212, 212, 212)">.</span><span class="token method function property-access" style="color:rgb(220, 220, 170)">drop</span><span class="token punctuation" style="color:rgb(212, 212, 212)">(</span><span class="token punctuation" style="color:rgb(212, 212, 212)">)</span><span class="token punctuation" style="color:rgb(212, 212, 212)">.</span><span class="token method function property-access" style="color:rgb(220, 220, 170)">show</span><span class="token punctuation" style="color:rgb(212, 212, 212)">(</span><span class="token punctuation" style="color:rgb(212, 212, 212)">)</span><span class="token plain"></span></div><div class="token-line"><span class="token plain" style="display:inline-block"></span></div></pre></pre></pre><p class="paragraph"><img src="https://github.com/rklick-solutions/spark-tutorial/wiki/images/nadata.png" alt="alt text"/></p><h2 class="heading2" id="as()">as()</h2><blockquote><p class="paragraph">Returns a new DataFrame with an alias set.</p></blockquote><pre class="css-fkgcw9 eyprwjk0"><pre><pre class="prism-code language-javascript pre" style="color:#9CDCFE;background-color:#1E1E1E" p="3"><div class="token-line"><span class="token plain">carDataFrame</span><span class="token punctuation" style="color:rgb(212, 212, 212)">.</span><span class="token method function property-access" style="color:rgb(220, 220, 170)">select</span><span class="token punctuation" style="color:rgb(212, 212, 212)">(</span><span class="token function" style="color:rgb(220, 220, 170)">avg</span><span class="token punctuation" style="color:rgb(212, 212, 212)">(</span><span class="token plain">$</span><span class="token string" style="color:rgb(206, 145, 120)">&quot;speed&quot;</span><span class="token punctuation" style="color:rgb(212, 212, 212)">)</span><span class="token punctuation" style="color:rgb(212, 212, 212)">.</span><span class="token keyword module" style="color:rgb(86, 156, 214)">as</span><span class="token punctuation" style="color:rgb(212, 212, 212)">(</span><span class="token string" style="color:rgb(206, 145, 120)">&quot;avg_speed&quot;</span><span class="token punctuation" style="color:rgb(212, 212, 212)">)</span><span class="token punctuation" style="color:rgb(212, 212, 212)">)</span><span class="token punctuation" style="color:rgb(212, 212, 212)">.</span><span class="token method function property-access" style="color:rgb(220, 220, 170)">show</span><span class="token punctuation" style="color:rgb(212, 212, 212)">(</span><span class="token punctuation" style="color:rgb(212, 212, 212)">)</span><span class="token plain"></span></div><div class="token-line"><span class="token plain" style="display:inline-block"></span></div></pre></pre></pre><p class="paragraph"><img src="https://github.com/rklick-solutions/spark-tutorial/wiki/images/asdata.png" alt="alt text"/></p><h2 class="heading2" id="alias()">alias()</h2><blockquote><p class="paragraph">Returns a new DataFrame with an alias set. Same as <code>as</code>.</p></blockquote><pre class="css-fkgcw9 eyprwjk0"><pre><pre class="prism-code language-javascript pre" style="color:#9CDCFE;background-color:#1E1E1E" p="3"><div class="token-line"><span class="token plain" style="display:inline-block"></span></div><div class="token-line"><span class="token plain">carDataFrame</span><span class="token punctuation" style="color:rgb(212, 212, 212)">.</span><span class="token method function property-access" style="color:rgb(220, 220, 170)">select</span><span class="token punctuation" style="color:rgb(212, 212, 212)">(</span><span class="token function" style="color:rgb(220, 220, 170)">avg</span><span class="token punctuation" style="color:rgb(212, 212, 212)">(</span><span class="token plain">$</span><span class="token string" style="color:rgb(206, 145, 120)">&quot;weight&quot;</span><span class="token punctuation" style="color:rgb(212, 212, 212)">)</span><span class="token punctuation" style="color:rgb(212, 212, 212)">.</span><span class="token method function property-access" style="color:rgb(220, 220, 170)">alias</span><span class="token punctuation" style="color:rgb(212, 212, 212)">(</span><span class="token string" style="color:rgb(206, 145, 120)">&quot;avg_weight&quot;</span><span class="token punctuation" style="color:rgb(212, 212, 212)">)</span><span class="token punctuation" style="color:rgb(212, 212, 212)">)</span><span class="token punctuation" style="color:rgb(212, 212, 212)">.</span><span class="token method function property-access" style="color:rgb(220, 220, 170)">show</span><span class="token punctuation" style="color:rgb(212, 212, 212)">(</span><span class="token punctuation" style="color:rgb(212, 212, 212)">)</span><span class="token plain"></span></div><div class="token-line"><span class="token plain" style="display:inline-block"></span></div></pre></pre></pre><p class="paragraph"><img src="https://github.com/rklick-solutions/spark-tutorial/wiki/images/aliasdata.png" alt="alt text"/></p><h2 class="heading2" id="select()">select()</h2><blockquote><p class="paragraph">To fetch speed-column among all columns from the DataFrame.</p></blockquote><pre class="css-fkgcw9 eyprwjk0"><pre><pre class="prism-code language-javascript pre" style="color:#9CDCFE;background-color:#1E1E1E" p="3"><div class="token-line"><span class="token plain" style="display:inline-block"></span></div><div class="token-line"><span class="token plain">carDataFrame</span><span class="token punctuation" style="color:rgb(212, 212, 212)">.</span><span class="token method function property-access" style="color:rgb(220, 220, 170)">select</span><span class="token punctuation" style="color:rgb(212, 212, 212)">(</span><span class="token string" style="color:rgb(206, 145, 120)">&quot;speed&quot;</span><span class="token punctuation" style="color:rgb(212, 212, 212)">)</span><span class="token punctuation" style="color:rgb(212, 212, 212)">.</span><span class="token method function property-access" style="color:rgb(220, 220, 170)">show</span><span class="token punctuation" style="color:rgb(212, 212, 212)">(</span><span class="token punctuation" style="color:rgb(212, 212, 212)">)</span><span class="token plain"></span></div><div class="token-line"><span class="token plain" style="display:inline-block"></span></div></pre></pre></pre><p class="paragraph"><img src="https://github.com/rklick-solutions/spark-tutorial/wiki/images/selectdata.png" alt="alt text"/></p><h2 class="heading2" id="filter()">filter()</h2><blockquote><p class="paragraph">filter the cars whose speed is greater than 300 (speed &gt; 300).</p></blockquote><pre class="css-fkgcw9 eyprwjk0"><pre><pre class="prism-code language-javascript pre" style="color:#9CDCFE;background-color:#1E1E1E" p="3"><div class="token-line"><span class="token plain" style="display:inline-block"></span></div><div class="token-line"><span class="token plain">carDataFrame</span><span class="token punctuation" style="color:rgb(212, 212, 212)">.</span><span class="token method function property-access" style="color:rgb(220, 220, 170)">filter</span><span class="token punctuation" style="color:rgb(212, 212, 212)">(</span><span class="token function" style="color:rgb(220, 220, 170)">carDataFrame</span><span class="token punctuation" style="color:rgb(212, 212, 212)">(</span><span class="token string" style="color:rgb(206, 145, 120)">&quot;speed&quot;</span><span class="token punctuation" style="color:rgb(212, 212, 212)">)</span><span class="token plain"> </span><span class="token operator" style="color:rgb(212, 212, 212)">&gt;</span><span class="token plain"> </span><span class="token number" style="color:rgb(181, 206, 168)">300</span><span class="token punctuation" style="color:rgb(212, 212, 212)">)</span><span class="token punctuation" style="color:rgb(212, 212, 212)">.</span><span class="token method function property-access" style="color:rgb(220, 220, 170)">show</span><span class="token punctuation" style="color:rgb(212, 212, 212)">(</span><span class="token punctuation" style="color:rgb(212, 212, 212)">)</span><span class="token plain"></span></div><div class="token-line"><span class="token plain" style="display:inline-block"></span></div></pre></pre></pre><p class="paragraph"><img src="https://github.com/rklick-solutions/spark-tutorial/wiki/images/filterdata.png" alt="alt text"/></p><h2 class="heading2" id="where()">where()</h2><blockquote><p class="paragraph">Filters age using the given SQL expression.</p></blockquote><pre class="css-fkgcw9 eyprwjk0"><pre><pre class="prism-code language-javascript pre" style="color:#9CDCFE;background-color:#1E1E1E" p="3"><div class="token-line"><span class="token plain">carDataFrame</span><span class="token punctuation" style="color:rgb(212, 212, 212)">.</span><span class="token method function property-access" style="color:rgb(220, 220, 170)">where</span><span class="token punctuation" style="color:rgb(212, 212, 212)">(</span><span class="token plain">$</span><span class="token string" style="color:rgb(206, 145, 120)">&quot;speed&quot;</span><span class="token plain"> </span><span class="token operator" style="color:rgb(212, 212, 212)">&gt;</span><span class="token plain"> </span><span class="token number" style="color:rgb(181, 206, 168)">300</span><span class="token punctuation" style="color:rgb(212, 212, 212)">)</span><span class="token punctuation" style="color:rgb(212, 212, 212)">.</span><span class="token method function property-access" style="color:rgb(220, 220, 170)">show</span><span class="token punctuation" style="color:rgb(212, 212, 212)">(</span><span class="token punctuation" style="color:rgb(212, 212, 212)">)</span><span class="token plain"></span></div><div class="token-line"><span class="token plain" style="display:inline-block"></span></div></pre></pre></pre><p class="paragraph"><img src="https://github.com/rklick-solutions/spark-tutorial/wiki/images/wheredata.png" alt="alt text"/></p><h2 class="heading2" id="agg()">agg()</h2><blockquote><p class="paragraph">Aggregates on the entire DataFrame without groups.</p></blockquote><pre class="css-fkgcw9 eyprwjk0"><pre><pre class="prism-code language-javascript pre" style="color:#9CDCFE;background-color:#1E1E1E" p="3"><div class="token-line"><span class="token plain" style="display:inline-block"></span></div><div class="token-line"><span class="token plain">carDataFrame</span><span class="token punctuation" style="color:rgb(212, 212, 212)">.</span><span class="token method function property-access" style="color:rgb(220, 220, 170)">agg</span><span class="token punctuation" style="color:rgb(212, 212, 212)">(</span><span class="token function" style="color:rgb(220, 220, 170)">max</span><span class="token punctuation" style="color:rgb(212, 212, 212)">(</span><span class="token plain">$</span><span class="token string" style="color:rgb(206, 145, 120)">&quot;speed&quot;</span><span class="token punctuation" style="color:rgb(212, 212, 212)">)</span><span class="token punctuation" style="color:rgb(212, 212, 212)">)</span><span class="token punctuation" style="color:rgb(212, 212, 212)">.</span><span class="token method function property-access" style="color:rgb(220, 220, 170)">show</span><span class="token punctuation" style="color:rgb(212, 212, 212)">(</span><span class="token punctuation" style="color:rgb(212, 212, 212)">)</span><span class="token plain"></span></div><div class="token-line"><span class="token plain" style="display:inline-block"></span></div></pre></pre></pre><p class="paragraph"><img src="https://github.com/rklick-solutions/spark-tutorial/wiki/images/aggdata.png" alt="alt text"/></p><h2 class="heading2" id="limit()">limit()</h2><blockquote><p class="paragraph">Returns a new DataFrame by taking the first n rows.The difference between this function and head is that head returns an array while limit returns a new DataFrame.</p></blockquote><pre class="css-fkgcw9 eyprwjk0"><pre><pre class="prism-code language-javascript pre" style="color:#9CDCFE;background-color:#1E1E1E" p="3"><div class="token-line"><span class="token plain" style="display:inline-block"></span></div><div class="token-line"><span class="token plain">carDataFrame1</span><span class="token punctuation" style="color:rgb(212, 212, 212)">.</span><span class="token method function property-access" style="color:rgb(220, 220, 170)">limit</span><span class="token punctuation" style="color:rgb(212, 212, 212)">(</span><span class="token number" style="color:rgb(181, 206, 168)">3</span><span class="token punctuation" style="color:rgb(212, 212, 212)">)</span><span class="token punctuation" style="color:rgb(212, 212, 212)">.</span><span class="token method function property-access" style="color:rgb(220, 220, 170)">show</span><span class="token punctuation" style="color:rgb(212, 212, 212)">(</span><span class="token punctuation" style="color:rgb(212, 212, 212)">)</span><span class="token plain"></span></div><div class="token-line"><span class="token plain" style="display:inline-block"></span></div></pre></pre></pre><p class="paragraph"><img src="https://github.com/rklick-solutions/spark-tutorial/wiki/images/limit.png" alt="alt text"/></p><h2 class="heading2" id="unionall()">unionAll()</h2><blockquote><p class="paragraph">Returns a new DataFrame containing union of rows in this frame and another frame.</p></blockquote><pre class="css-fkgcw9 eyprwjk0"><pre><pre class="prism-code language-javascript pre" style="color:#9CDCFE;background-color:#1E1E1E" p="3"><div class="token-line"><span class="token plain">carDataFrame</span><span class="token punctuation" style="color:rgb(212, 212, 212)">.</span><span class="token method function property-access" style="color:rgb(220, 220, 170)">unionAll</span><span class="token punctuation" style="color:rgb(212, 212, 212)">(</span><span class="token plain">empDataFrame2</span><span class="token punctuation" style="color:rgb(212, 212, 212)">)</span><span class="token punctuation" style="color:rgb(212, 212, 212)">.</span><span class="token method function property-access" style="color:rgb(220, 220, 170)">show</span><span class="token punctuation" style="color:rgb(212, 212, 212)">(</span><span class="token punctuation" style="color:rgb(212, 212, 212)">)</span><span class="token plain"></span></div><div class="token-line"><span class="token plain" style="display:inline-block"></span></div><div class="token-line"><span class="token plain" style="display:inline-block"></span></div></pre></pre></pre><p class="paragraph"><img src="https://github.com/rklick-solutions/spark-tutorial/wiki/images/unionalldata.png" alt="alt text"/></p><h2 class="heading2" id="intersect()">intersect()</h2><blockquote><p class="paragraph">Returns a new DataFrame containing rows only in both this frame and another frame.</p></blockquote><pre class="css-fkgcw9 eyprwjk0"><pre><pre class="prism-code language-javascript pre" style="color:#9CDCFE;background-color:#1E1E1E" p="3"><div class="token-line"><span class="token plain" style="display:inline-block"></span></div><div class="token-line"><span class="token plain">carDataFrame1</span><span class="token punctuation" style="color:rgb(212, 212, 212)">.</span><span class="token method function property-access" style="color:rgb(220, 220, 170)">intersect</span><span class="token punctuation" style="color:rgb(212, 212, 212)">(</span><span class="token plain">carDataFrame</span><span class="token punctuation" style="color:rgb(212, 212, 212)">)</span><span class="token punctuation" style="color:rgb(212, 212, 212)">.</span><span class="token method function property-access" style="color:rgb(220, 220, 170)">show</span><span class="token punctuation" style="color:rgb(212, 212, 212)">(</span><span class="token punctuation" style="color:rgb(212, 212, 212)">)</span><span class="token plain"></span></div></pre></pre></pre><p class="paragraph"><img src="https://github.com/rklick-solutions/spark-tutorial/wiki/images/intersectdata.png" alt="alt text"/></p><h2 class="heading2" id="except()">except()</h2><blockquote><p class="paragraph">Returns a new DataFrame containing rows in this frame but not in another frame.</p></blockquote><pre class="css-fkgcw9 eyprwjk0"><pre><pre class="prism-code language-javascript pre" style="color:#9CDCFE;background-color:#1E1E1E" p="3"><div class="token-line"><span class="token plain" style="display:inline-block"></span></div><div class="token-line"><span class="token plain">carDataFrame</span><span class="token punctuation" style="color:rgb(212, 212, 212)">.</span><span class="token method function property-access" style="color:rgb(220, 220, 170)">except</span><span class="token punctuation" style="color:rgb(212, 212, 212)">(</span><span class="token plain">carDataFrame1</span><span class="token punctuation" style="color:rgb(212, 212, 212)">)</span><span class="token punctuation" style="color:rgb(212, 212, 212)">.</span><span class="token method function property-access" style="color:rgb(220, 220, 170)">show</span><span class="token punctuation" style="color:rgb(212, 212, 212)">(</span><span class="token punctuation" style="color:rgb(212, 212, 212)">)</span><span class="token plain"></span></div><div class="token-line"><span class="token plain" style="display:inline-block"></span></div></pre></pre></pre><p class="paragraph"><img src="https://github.com/rklick-solutions/spark-tutorial/wiki/images/exceptdata.png" alt="alt text"/></p><h2 class="heading2" id="withcolumnrenamed()">withColumnRenamed()</h2><blockquote><p class="paragraph">Returns a new DataFrame with a column renamed.</p></blockquote><pre class="css-fkgcw9 eyprwjk0"><pre><pre class="prism-code language-javascript pre" style="color:#9CDCFE;background-color:#1E1E1E" p="3"><div class="token-line"><span class="token plain" style="display:inline-block"></span></div><div class="token-line"><span class="token plain">empDataFrame2</span><span class="token punctuation" style="color:rgb(212, 212, 212)">.</span><span class="token method function property-access" style="color:rgb(220, 220, 170)">withColumnRenamed</span><span class="token punctuation" style="color:rgb(212, 212, 212)">(</span><span class="token string" style="color:rgb(206, 145, 120)">&quot;id&quot;</span><span class="token punctuation" style="color:rgb(212, 212, 212)">,</span><span class="token plain"> </span><span class="token string" style="color:rgb(206, 145, 120)">&quot;employeeId&quot;</span><span class="token punctuation" style="color:rgb(212, 212, 212)">)</span><span class="token punctuation" style="color:rgb(212, 212, 212)">.</span><span class="token method function property-access" style="color:rgb(220, 220, 170)">show</span><span class="token punctuation" style="color:rgb(212, 212, 212)">(</span><span class="token punctuation" style="color:rgb(212, 212, 212)">)</span><span class="token plain"></span></div></pre></pre></pre><p class="paragraph"><img src="https://github.com/rklick-solutions/spark-tutorial/wiki/images/withcolumnrenameddata.png" alt="alt text"/></p><h2 class="heading2" id="drop()">drop()</h2><blockquote><p class="paragraph">Returns a new DataFrame with a column dropped.</p></blockquote><pre class="css-fkgcw9 eyprwjk0"><pre><pre class="prism-code language-javascript pre" style="color:#9CDCFE;background-color:#1E1E1E" p="3"><div class="token-line"><span class="token plain" style="display:inline-block"></span></div><div class="token-line"><span class="token plain">carDataFrame</span><span class="token punctuation" style="color:rgb(212, 212, 212)">.</span><span class="token method function property-access" style="color:rgb(220, 220, 170)">drop</span><span class="token punctuation" style="color:rgb(212, 212, 212)">(</span><span class="token string" style="color:rgb(206, 145, 120)">&quot;speed&quot;</span><span class="token punctuation" style="color:rgb(212, 212, 212)">)</span><span class="token punctuation" style="color:rgb(212, 212, 212)">.</span><span class="token method function property-access" style="color:rgb(220, 220, 170)">show</span><span class="token punctuation" style="color:rgb(212, 212, 212)">(</span><span class="token punctuation" style="color:rgb(212, 212, 212)">)</span><span class="token plain"></span></div><div class="token-line"><span class="token plain" style="display:inline-block"></span></div></pre></pre></pre><p class="paragraph"><img src="https://github.com/rklick-solutions/spark-tutorial/wiki/images/dropdata.png" alt="alt text"/></p><h2 class="heading2" id="dropduplicates()">dropDuplicates()</h2><blockquote><p class="paragraph">Returns a new DataFrame that contains only the unique rows from this DataFrame.
This is an alias for distinct.</p></blockquote><pre class="css-fkgcw9 eyprwjk0"><pre><pre class="prism-code language-javascript pre" style="color:#9CDCFE;background-color:#1E1E1E" p="3"><div class="token-line"><span class="token plain" style="display:inline-block"></span></div><div class="token-line"><span class="token plain">carDataFrame</span><span class="token punctuation" style="color:rgb(212, 212, 212)">.</span><span class="token method function property-access" style="color:rgb(220, 220, 170)">dropDuplicates</span><span class="token punctuation" style="color:rgb(212, 212, 212)">(</span><span class="token punctuation" style="color:rgb(212, 212, 212)">)</span><span class="token punctuation" style="color:rgb(212, 212, 212)">.</span><span class="token method function property-access" style="color:rgb(220, 220, 170)">show</span><span class="token punctuation" style="color:rgb(212, 212, 212)">(</span><span class="token punctuation" style="color:rgb(212, 212, 212)">)</span><span class="token plain"></span></div><div class="token-line"><span class="token plain" style="display:inline-block"></span></div></pre></pre></pre><p class="paragraph"><img src="https://github.com/rklick-solutions/spark-tutorial/wiki/images/dropduplicates.png" alt="alt text"/></p><h2 class="heading2" id="describe()">describe()</h2><blockquote><p class="paragraph">describe returns a DataFrame containing information such as number of non-null entries (count),mean, standard deviation, and minimum and maximum value for each numerical column.</p></blockquote><pre class="css-fkgcw9 eyprwjk0"><pre><pre class="prism-code language-javascript pre" style="color:#9CDCFE;background-color:#1E1E1E" p="3"><div class="token-line"><span class="token plain" style="display:inline-block"></span></div><div class="token-line"><span class="token plain">carDataFrame</span><span class="token punctuation" style="color:rgb(212, 212, 212)">.</span><span class="token method function property-access" style="color:rgb(220, 220, 170)">describe</span><span class="token punctuation" style="color:rgb(212, 212, 212)">(</span><span class="token string" style="color:rgb(206, 145, 120)">&quot;speed&quot;</span><span class="token punctuation" style="color:rgb(212, 212, 212)">)</span><span class="token punctuation" style="color:rgb(212, 212, 212)">.</span><span class="token method function property-access" style="color:rgb(220, 220, 170)">show</span><span class="token punctuation" style="color:rgb(212, 212, 212)">(</span><span class="token punctuation" style="color:rgb(212, 212, 212)">)</span><span class="token plain"></span></div><div class="token-line"><span class="token plain" style="display:inline-block"></span></div></pre></pre></pre><p class="paragraph"><img src="https://github.com/rklick-solutions/spark-tutorial/wiki/images/describe.png" alt="alt text"/></p><h2 class="heading2" id="showthedata">Show the Data</h2><blockquote><p class="paragraph">If you want to see the data in the DataFrame, then use the following command.</p></blockquote><pre class="css-fkgcw9 eyprwjk0"><pre><pre class="prism-code language-javascript pre" style="color:#9CDCFE;background-color:#1E1E1E" p="3"><div class="token-line"><span class="token plain" style="display:inline-block"></span></div><div class="token-line"><span class="token plain">carDataFrame</span><span class="token punctuation" style="color:rgb(212, 212, 212)">.</span><span class="token method function property-access" style="color:rgb(220, 220, 170)">show</span><span class="token punctuation" style="color:rgb(212, 212, 212)">(</span><span class="token punctuation" style="color:rgb(212, 212, 212)">)</span><span class="token plain"></span></div></pre></pre></pre><p class="paragraph"><img src="https://github.com/rklick-solutions/spark-tutorial/wiki/images/show.png" alt="alt text"/></p><h2 class="heading2" id="printschemamethod">printSchema Method</h2><blockquote><p class="paragraph">If you want to see the Structure (Schema) of the DataFrame, then use the following command</p></blockquote><pre class="css-fkgcw9 eyprwjk0"><pre><pre class="prism-code language-javascript pre" style="color:#9CDCFE;background-color:#1E1E1E" p="3"><div class="token-line"><span class="token plain"> carDataFrame</span><span class="token punctuation" style="color:rgb(212, 212, 212)">.</span><span class="token method function property-access" style="color:rgb(220, 220, 170)">printSchema</span><span class="token punctuation" style="color:rgb(212, 212, 212)">(</span><span class="token punctuation" style="color:rgb(212, 212, 212)">)</span><span class="token plain"></span></div><div class="token-line"><span class="token plain" style="display:inline-block"></span></div></pre></pre></pre><p class="paragraph"><img src="https://github.com/rklick-solutions/spark-tutorial/wiki/images/schema.png" alt="alt text"/></p><h2 class="heading2" id="selectmethod">Select Method</h2><blockquote><p class="paragraph">Use the following command to fetch name-column among three columns from the DataFrame</p></blockquote><pre class="css-fkgcw9 eyprwjk0"><pre><pre class="prism-code language-javascript pre" style="color:#9CDCFE;background-color:#1E1E1E" p="3"><div class="token-line"><span class="token plain" style="display:inline-block"></span></div><div class="token-line"><span class="token plain">carDataFrame</span><span class="token punctuation" style="color:rgb(212, 212, 212)">.</span><span class="token method function property-access" style="color:rgb(220, 220, 170)">select</span><span class="token punctuation" style="color:rgb(212, 212, 212)">(</span><span class="token string" style="color:rgb(206, 145, 120)">&quot;name&quot;</span><span class="token punctuation" style="color:rgb(212, 212, 212)">)</span><span class="token punctuation" style="color:rgb(212, 212, 212)">.</span><span class="token method function property-access" style="color:rgb(220, 220, 170)">show</span><span class="token punctuation" style="color:rgb(212, 212, 212)">(</span><span class="token punctuation" style="color:rgb(212, 212, 212)">)</span><span class="token plain"></span></div><div class="token-line"><span class="token plain" style="display:inline-block"></span></div></pre></pre></pre><p class="paragraph"><img src="https://github.com/rklick-solutions/spark-tutorial/wiki/images/select.png" alt="alt text"/></p><h2 class="heading2" id="filtermethod">Filter Method</h2><blockquote><p class="paragraph">Use the following command to filter whose speed is greater than 300 (speed &gt; 300)from the DataFrame</p></blockquote><pre class="css-fkgcw9 eyprwjk0"><pre><pre class="prism-code language-javascript pre" style="color:#9CDCFE;background-color:#1E1E1E" p="3"><div class="token-line"><span class="token plain" style="display:inline-block"></span></div><div class="token-line"><span class="token plain">carDataFrame</span><span class="token punctuation" style="color:rgb(212, 212, 212)">.</span><span class="token method function property-access" style="color:rgb(220, 220, 170)">filter</span><span class="token punctuation" style="color:rgb(212, 212, 212)">(</span><span class="token function" style="color:rgb(220, 220, 170)">carDataFrame</span><span class="token punctuation" style="color:rgb(212, 212, 212)">(</span><span class="token string" style="color:rgb(206, 145, 120)">&quot;speed&quot;</span><span class="token punctuation" style="color:rgb(212, 212, 212)">)</span><span class="token plain"> </span><span class="token operator" style="color:rgb(212, 212, 212)">&gt;</span><span class="token plain"> </span><span class="token number" style="color:rgb(181, 206, 168)">300</span><span class="token punctuation" style="color:rgb(212, 212, 212)">)</span><span class="token punctuation" style="color:rgb(212, 212, 212)">.</span><span class="token method function property-access" style="color:rgb(220, 220, 170)">show</span><span class="token punctuation" style="color:rgb(212, 212, 212)">(</span><span class="token punctuation" style="color:rgb(212, 212, 212)">)</span><span class="token plain"></span></div><div class="token-line"><span class="token plain" style="display:inline-block"></span></div></pre></pre></pre><p class="paragraph"><img src="https://github.com/rklick-solutions/spark-tutorial/wiki/images/filterage.png" alt="alt text"/></p><h1 class="heading1" id="workingwithdifferenttypesofdata">Working with Different Types of Data</h1><p class="paragraph"><strong>Objectives</strong></p><ul><li>Booleans</li><li>Numbers</li><li>Strings</li><li>Dates and Timestamps</li><li>Handling Null</li><li>Complex Types</li><li>User Defined Functions</li></ul><p class="paragraph"><strong>Where to look for APIs?</strong>
DataFrame (Dataset) Methods: DataFrame is just a Dataset of Row types, so you will look at the Dataset methods available at: <a href="http://spark.apache.org/docs/latest/api/scala/index.html#org.apache.spark.sql.Dataset" target="_blank" rel="noopener noreferrer">http://spark.apache.org/docs/latest/api/scala/index.html#org.apache.spark.sql.Dataset</a>
DataFrameStatFunctions: <a href="http://spark.apache.org/docs/latest/api/scala/index.html#org.apache.spark.sql.DataFrameStatFunctions" target="_blank" rel="noopener noreferrer">http://spark.apache.org/docs/latest/api/scala/index.html#org.apache.spark.sql.DataFrameStatFunctions</a>
DataFrameNaFunctions <a href="http://spark.apache.org/docs/latest/api/scala/index.html#org.apache.spark.sql.DataFrameNaFunctions" target="_blank" rel="noopener noreferrer">http://spark.apache.org/docs/latest/api/scala/index.html#org.apache.spark.sql.DataFrameNaFunctions</a>
Column methods: <a href="http://spark.apache.org/docs/latest/api/scala/index.html#org.apache.spark.sql.Column" target="_blank" rel="noopener noreferrer">http://spark.apache.org/docs/latest/api/scala/index.html#org.apache.spark.sql.Column</a>
Functions: <a href="http://spark.apache.org/docs/latest/api/scala/index.html#org.apache.spark.sql.functions$" target="_blank" rel="noopener noreferrer">http://spark.apache.org/docs/latest/api/scala/index.html#org.apache.spark.sql.functions$</a>
Dataset: <a href="http://spark.apache.org/docs/latest/api/scala/index.html#org.apache.spark.sql.Dataset" target="_blank" rel="noopener noreferrer">http://spark.apache.org/docs/latest/api/scala/index.html#org.apache.spark.sql.Dataset</a></p><h1 class="heading1" id="joins">Joins</h1><p class="paragraph">Joins bring together a large number of different datasets. It helps avoid OutOfMemory issues and solve problems.</p><p class="paragraph"><strong>Join Expressions</strong></p><ul><li>Join expressions determine whether two rows should join
A join brings together two sets of data, the left and the right, by comparing the value of one or more keys of the left and right and evaluating the result of a join expression that determines whether Spark should bring together the left set of data with the right set of data. </li></ul><p class="paragraph"><strong>Join types</strong></p><ul><li><p class="paragraph">The join type determines what should be in the result set. </p></li><li><p class="paragraph">Inner joins (keep rows with keys that exist in the left and right datasets)</p></li><li><p class="paragraph">Outer joins (keep rows with keys in either the left or right datasets)</p></li><li><p class="paragraph">Left outer joins (keep rows with keys in the left dataset)</p></li><li><p class="paragraph">Right outer joins (keep rows with keys in the right dataset)</p></li><li><p class="paragraph">Left semi joins (keep the rows in the left, and only the left, dataset where the key appears in the right dataset)</p></li><li><p class="paragraph">Left anti joins (keep the rows in the left, and only the left, dataset where they dos not appear in the right dataset)</p></li><li><p class="paragraph">Natural joins (perform a join by implicitly matching the columns between the two datasets with the same names)</p></li><li><p class="paragraph">Cross (or cartesian) joins (match every row in the left dataset with every row in the right dataset)</p></li></ul><p class="paragraph"><strong>Create a simple dataset:</strong></p><pre class="css-fkgcw9 eyprwjk0"><pre><pre class="prism-code language-javascript pre" style="color:#9CDCFE;background-color:#1E1E1E" p="3"><div class="token-line"><span class="token plain">person </span><span class="token operator" style="color:rgb(212, 212, 212)">=</span><span class="token plain"> spark</span><span class="token punctuation" style="color:rgb(212, 212, 212)">.</span><span class="token method function property-access" style="color:rgb(220, 220, 170)">createDataFrame</span><span class="token punctuation" style="color:rgb(212, 212, 212)">(</span><span class="token punctuation" style="color:rgb(212, 212, 212)">[</span><span class="token plain"></span></div><div class="token-line"><span class="token plain"></span><span class="token punctuation" style="color:rgb(212, 212, 212)">(</span><span class="token number" style="color:rgb(181, 206, 168)">0</span><span class="token punctuation" style="color:rgb(212, 212, 212)">,</span><span class="token plain"> </span><span class="token string" style="color:rgb(206, 145, 120)">&quot;Bill Chambers&quot;</span><span class="token punctuation" style="color:rgb(212, 212, 212)">,</span><span class="token plain"> </span><span class="token number" style="color:rgb(181, 206, 168)">0</span><span class="token punctuation" style="color:rgb(212, 212, 212)">,</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(212, 212, 212)">[</span><span class="token number" style="color:rgb(181, 206, 168)">100</span><span class="token punctuation" style="color:rgb(212, 212, 212)">]</span><span class="token punctuation" style="color:rgb(212, 212, 212)">)</span><span class="token punctuation" style="color:rgb(212, 212, 212)">,</span><span class="token plain"></span></div><div class="token-line"><span class="token plain"></span><span class="token punctuation" style="color:rgb(212, 212, 212)">(</span><span class="token number" style="color:rgb(181, 206, 168)">1</span><span class="token punctuation" style="color:rgb(212, 212, 212)">,</span><span class="token plain"> </span><span class="token string" style="color:rgb(206, 145, 120)">&quot;Matei Zaharia&quot;</span><span class="token punctuation" style="color:rgb(212, 212, 212)">,</span><span class="token plain"> </span><span class="token number" style="color:rgb(181, 206, 168)">1</span><span class="token punctuation" style="color:rgb(212, 212, 212)">,</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(212, 212, 212)">[</span><span class="token number" style="color:rgb(181, 206, 168)">500</span><span class="token punctuation" style="color:rgb(212, 212, 212)">,</span><span class="token plain"> </span><span class="token number" style="color:rgb(181, 206, 168)">250</span><span class="token punctuation" style="color:rgb(212, 212, 212)">,</span><span class="token plain"> </span><span class="token number" style="color:rgb(181, 206, 168)">100</span><span class="token punctuation" style="color:rgb(212, 212, 212)">]</span><span class="token punctuation" style="color:rgb(212, 212, 212)">)</span><span class="token punctuation" style="color:rgb(212, 212, 212)">,</span><span class="token plain"></span></div><div class="token-line"><span class="token plain"></span><span class="token punctuation" style="color:rgb(212, 212, 212)">(</span><span class="token number" style="color:rgb(181, 206, 168)">2</span><span class="token punctuation" style="color:rgb(212, 212, 212)">,</span><span class="token plain"> </span><span class="token string" style="color:rgb(206, 145, 120)">&quot;Michael Armbrust&quot;</span><span class="token punctuation" style="color:rgb(212, 212, 212)">,</span><span class="token plain"> </span><span class="token number" style="color:rgb(181, 206, 168)">1</span><span class="token punctuation" style="color:rgb(212, 212, 212)">,</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(212, 212, 212)">[</span><span class="token number" style="color:rgb(181, 206, 168)">250</span><span class="token punctuation" style="color:rgb(212, 212, 212)">,</span><span class="token plain"> </span><span class="token number" style="color:rgb(181, 206, 168)">100</span><span class="token punctuation" style="color:rgb(212, 212, 212)">]</span><span class="token punctuation" style="color:rgb(212, 212, 212)">)</span><span class="token punctuation" style="color:rgb(212, 212, 212)">]</span><span class="token punctuation" style="color:rgb(212, 212, 212)">)</span><span class="token plain">\</span></div><div class="token-line"><span class="token plain"></span><span class="token punctuation" style="color:rgb(212, 212, 212)">.</span><span class="token method function property-access" style="color:rgb(220, 220, 170)">toDF</span><span class="token punctuation" style="color:rgb(212, 212, 212)">(</span><span class="token string" style="color:rgb(206, 145, 120)">&quot;id&quot;</span><span class="token punctuation" style="color:rgb(212, 212, 212)">,</span><span class="token plain"> </span><span class="token string" style="color:rgb(206, 145, 120)">&quot;name&quot;</span><span class="token punctuation" style="color:rgb(212, 212, 212)">,</span><span class="token plain"> </span><span class="token string" style="color:rgb(206, 145, 120)">&quot;graduate_program&quot;</span><span class="token punctuation" style="color:rgb(212, 212, 212)">,</span><span class="token plain"> </span><span class="token string" style="color:rgb(206, 145, 120)">&quot;spark_status&quot;</span><span class="token punctuation" style="color:rgb(212, 212, 212)">)</span><span class="token plain"></span></div><div class="token-line"><span class="token plain">graduateProgram </span><span class="token operator" style="color:rgb(212, 212, 212)">=</span><span class="token plain"> spark</span><span class="token punctuation" style="color:rgb(212, 212, 212)">.</span><span class="token method function property-access" style="color:rgb(220, 220, 170)">createDataFrame</span><span class="token punctuation" style="color:rgb(212, 212, 212)">(</span><span class="token punctuation" style="color:rgb(212, 212, 212)">[</span><span class="token plain"></span></div><div class="token-line"><span class="token plain"></span><span class="token punctuation" style="color:rgb(212, 212, 212)">(</span><span class="token number" style="color:rgb(181, 206, 168)">0</span><span class="token punctuation" style="color:rgb(212, 212, 212)">,</span><span class="token plain"> </span><span class="token string" style="color:rgb(206, 145, 120)">&quot;Masters&quot;</span><span class="token punctuation" style="color:rgb(212, 212, 212)">,</span><span class="token plain"> </span><span class="token string" style="color:rgb(206, 145, 120)">&quot;School of Information&quot;</span><span class="token punctuation" style="color:rgb(212, 212, 212)">,</span><span class="token plain"> </span><span class="token string" style="color:rgb(206, 145, 120)">&quot;UC Berkeley&quot;</span><span class="token punctuation" style="color:rgb(212, 212, 212)">)</span><span class="token punctuation" style="color:rgb(212, 212, 212)">,</span><span class="token plain"></span></div><div class="token-line"><span class="token plain"></span><span class="token punctuation" style="color:rgb(212, 212, 212)">(</span><span class="token number" style="color:rgb(181, 206, 168)">2</span><span class="token punctuation" style="color:rgb(212, 212, 212)">,</span><span class="token plain"> </span><span class="token string" style="color:rgb(206, 145, 120)">&quot;Masters&quot;</span><span class="token punctuation" style="color:rgb(212, 212, 212)">,</span><span class="token plain"> </span><span class="token string" style="color:rgb(206, 145, 120)">&quot;EECS&quot;</span><span class="token punctuation" style="color:rgb(212, 212, 212)">,</span><span class="token plain"> </span><span class="token string" style="color:rgb(206, 145, 120)">&quot;UC Berkeley&quot;</span><span class="token punctuation" style="color:rgb(212, 212, 212)">)</span><span class="token punctuation" style="color:rgb(212, 212, 212)">,</span><span class="token plain"></span></div><div class="token-line"><span class="token plain"></span><span class="token punctuation" style="color:rgb(212, 212, 212)">(</span><span class="token number" style="color:rgb(181, 206, 168)">1</span><span class="token punctuation" style="color:rgb(212, 212, 212)">,</span><span class="token plain"> </span><span class="token string" style="color:rgb(206, 145, 120)">&quot;Ph.D.&quot;</span><span class="token punctuation" style="color:rgb(212, 212, 212)">,</span><span class="token plain"> </span><span class="token string" style="color:rgb(206, 145, 120)">&quot;EECS&quot;</span><span class="token punctuation" style="color:rgb(212, 212, 212)">,</span><span class="token plain"> </span><span class="token string" style="color:rgb(206, 145, 120)">&quot;UC Berkeley&quot;</span><span class="token punctuation" style="color:rgb(212, 212, 212)">)</span><span class="token punctuation" style="color:rgb(212, 212, 212)">]</span><span class="token punctuation" style="color:rgb(212, 212, 212)">)</span><span class="token plain">\</span></div><div class="token-line"><span class="token plain"></span><span class="token punctuation" style="color:rgb(212, 212, 212)">.</span><span class="token method function property-access" style="color:rgb(220, 220, 170)">toDF</span><span class="token punctuation" style="color:rgb(212, 212, 212)">(</span><span class="token string" style="color:rgb(206, 145, 120)">&quot;id&quot;</span><span class="token punctuation" style="color:rgb(212, 212, 212)">,</span><span class="token plain"> </span><span class="token string" style="color:rgb(206, 145, 120)">&quot;degree&quot;</span><span class="token punctuation" style="color:rgb(212, 212, 212)">,</span><span class="token plain"> </span><span class="token string" style="color:rgb(206, 145, 120)">&quot;department&quot;</span><span class="token punctuation" style="color:rgb(212, 212, 212)">,</span><span class="token plain"> </span><span class="token string" style="color:rgb(206, 145, 120)">&quot;school&quot;</span><span class="token punctuation" style="color:rgb(212, 212, 212)">)</span><span class="token plain"></span></div><div class="token-line"><span class="token plain">sparkStatus </span><span class="token operator" style="color:rgb(212, 212, 212)">=</span><span class="token plain"> spark</span><span class="token punctuation" style="color:rgb(212, 212, 212)">.</span><span class="token method function property-access" style="color:rgb(220, 220, 170)">createDataFrame</span><span class="token punctuation" style="color:rgb(212, 212, 212)">(</span><span class="token punctuation" style="color:rgb(212, 212, 212)">[</span><span class="token plain"></span></div><div class="token-line"><span class="token plain"></span><span class="token punctuation" style="color:rgb(212, 212, 212)">(</span><span class="token number" style="color:rgb(181, 206, 168)">500</span><span class="token punctuation" style="color:rgb(212, 212, 212)">,</span><span class="token plain"> </span><span class="token string" style="color:rgb(206, 145, 120)">&quot;Vice President&quot;</span><span class="token punctuation" style="color:rgb(212, 212, 212)">)</span><span class="token punctuation" style="color:rgb(212, 212, 212)">,</span><span class="token plain"></span></div><div class="token-line"><span class="token plain"></span><span class="token punctuation" style="color:rgb(212, 212, 212)">(</span><span class="token number" style="color:rgb(181, 206, 168)">250</span><span class="token punctuation" style="color:rgb(212, 212, 212)">,</span><span class="token plain"> </span><span class="token string" style="color:rgb(206, 145, 120)">&quot;PMC Member&quot;</span><span class="token punctuation" style="color:rgb(212, 212, 212)">)</span><span class="token punctuation" style="color:rgb(212, 212, 212)">,</span><span class="token plain"></span></div><div class="token-line"><span class="token plain"></span><span class="token punctuation" style="color:rgb(212, 212, 212)">(</span><span class="token number" style="color:rgb(181, 206, 168)">100</span><span class="token punctuation" style="color:rgb(212, 212, 212)">,</span><span class="token plain"> </span><span class="token string" style="color:rgb(206, 145, 120)">&quot;Contributor&quot;</span><span class="token punctuation" style="color:rgb(212, 212, 212)">)</span><span class="token punctuation" style="color:rgb(212, 212, 212)">]</span><span class="token punctuation" style="color:rgb(212, 212, 212)">)</span><span class="token plain">\</span></div><div class="token-line"><span class="token plain"></span><span class="token punctuation" style="color:rgb(212, 212, 212)">.</span><span class="token method function property-access" style="color:rgb(220, 220, 170)">toDF</span><span class="token punctuation" style="color:rgb(212, 212, 212)">(</span><span class="token string" style="color:rgb(206, 145, 120)">&quot;id&quot;</span><span class="token punctuation" style="color:rgb(212, 212, 212)">,</span><span class="token plain"> </span><span class="token string" style="color:rgb(206, 145, 120)">&quot;status&quot;</span><span class="token punctuation" style="color:rgb(212, 212, 212)">)</span><span class="token plain"></span></div></pre></pre></pre><p class="paragraph"><strong>Register these tables:</strong></p><pre class="css-fkgcw9 eyprwjk0"><pre><pre class="prism-code language-javascript pre" style="color:#9CDCFE;background-color:#1E1E1E" p="3"><div class="token-line"><span class="token plain">person</span><span class="token punctuation" style="color:rgb(212, 212, 212)">.</span><span class="token method function property-access" style="color:rgb(220, 220, 170)">createOrReplaceTempView</span><span class="token punctuation" style="color:rgb(212, 212, 212)">(</span><span class="token string" style="color:rgb(206, 145, 120)">&quot;person&quot;</span><span class="token punctuation" style="color:rgb(212, 212, 212)">)</span><span class="token plain"></span></div><div class="token-line"><span class="token plain">graduateProgram</span><span class="token punctuation" style="color:rgb(212, 212, 212)">.</span><span class="token method function property-access" style="color:rgb(220, 220, 170)">createOrReplaceTempView</span><span class="token punctuation" style="color:rgb(212, 212, 212)">(</span><span class="token string" style="color:rgb(206, 145, 120)">&quot;graduateProgram&quot;</span><span class="token punctuation" style="color:rgb(212, 212, 212)">)</span><span class="token plain"></span></div><div class="token-line"><span class="token plain">sparkStatus</span><span class="token punctuation" style="color:rgb(212, 212, 212)">.</span><span class="token method function property-access" style="color:rgb(220, 220, 170)">createOrReplaceTempView</span><span class="token punctuation" style="color:rgb(212, 212, 212)">(</span><span class="token string" style="color:rgb(206, 145, 120)">&quot;sparkStatus&quot;</span><span class="token punctuation" style="color:rgb(212, 212, 212)">)</span><span class="token plain"></span></div></pre></pre></pre><p class="paragraph"><strong>Inner Joins</strong></p><ul><li>Evaluate the keys in both of the DataFrames or tables and include only the rows that evaluate to true. Join graduateProgram DataFrame with the person DataFrame.</li></ul><pre class="css-fkgcw9 eyprwjk0"><pre><pre class="prism-code language-javascript pre" style="color:#9CDCFE;background-color:#1E1E1E" p="3"><div class="token-line"><span class="token plain">joinExpression </span><span class="token operator" style="color:rgb(212, 212, 212)">=</span><span class="token plain"> person</span><span class="token punctuation" style="color:rgb(212, 212, 212)">[</span><span class="token string" style="color:rgb(206, 145, 120)">&quot;graduate_program&quot;</span><span class="token punctuation" style="color:rgb(212, 212, 212)">]</span><span class="token plain"> </span><span class="token operator" style="color:rgb(212, 212, 212)">==</span><span class="token plain"> graduateProgram</span><span class="token punctuation" style="color:rgb(212, 212, 212)">[</span><span class="token string" style="color:rgb(206, 145, 120)">&#x27;id&#x27;</span><span class="token punctuation" style="color:rgb(212, 212, 212)">]</span><span class="token plain"></span></div><div class="token-line"><span class="token plain">#keys don&#x27;t exist </span><span class="token keyword" style="color:rgb(86, 156, 214)">in</span><span class="token plain"> both </span><span class="token maybe-class-name">DataFrames</span><span class="token plain"> so the following expression results </span><span class="token keyword" style="color:rgb(86, 156, 214)">in</span><span class="token plain"> zero values</span><span class="token punctuation" style="color:rgb(212, 212, 212)">.</span><span class="token plain"></span></div><div class="token-line"><span class="token plain"></span><span class="token property-access">wrongJoinExpression</span><span class="token plain"> </span><span class="token operator" style="color:rgb(212, 212, 212)">=</span><span class="token plain"> person</span><span class="token punctuation" style="color:rgb(212, 212, 212)">[</span><span class="token string" style="color:rgb(206, 145, 120)">&quot;name&quot;</span><span class="token punctuation" style="color:rgb(212, 212, 212)">]</span><span class="token plain"> </span><span class="token operator" style="color:rgb(212, 212, 212)">==</span><span class="token plain"> graduateProgram</span><span class="token punctuation" style="color:rgb(212, 212, 212)">[</span><span class="token string" style="color:rgb(206, 145, 120)">&quot;school&quot;</span><span class="token punctuation" style="color:rgb(212, 212, 212)">]</span><span class="token plain"></span></div><div class="token-line"><span class="token plain">person</span><span class="token punctuation" style="color:rgb(212, 212, 212)">.</span><span class="token method function property-access" style="color:rgb(220, 220, 170)">join</span><span class="token punctuation" style="color:rgb(212, 212, 212)">(</span><span class="token plain">graduateProgram</span><span class="token punctuation" style="color:rgb(212, 212, 212)">,</span><span class="token plain"> joinExpression</span><span class="token punctuation" style="color:rgb(212, 212, 212)">)</span><span class="token punctuation" style="color:rgb(212, 212, 212)">.</span><span class="token method function property-access" style="color:rgb(220, 220, 170)">show</span><span class="token punctuation" style="color:rgb(212, 212, 212)">(</span><span class="token punctuation" style="color:rgb(212, 212, 212)">)</span><span class="token plain"></span></div></pre></pre></pre><p class="paragraph"><em>We can also specify this explicitly by passing in a third parameter, the joinType.</em></p><pre class="css-fkgcw9 eyprwjk0"><pre><pre class="prism-code language-javascript pre" style="color:#9CDCFE;background-color:#1E1E1E" p="3"><div class="token-line"><span class="token plain">joinType </span><span class="token operator" style="color:rgb(212, 212, 212)">=</span><span class="token plain"> </span><span class="token string" style="color:rgb(206, 145, 120)">&quot;inner&quot;</span><span class="token plain"></span></div><div class="token-line"><span class="token plain">person</span><span class="token punctuation" style="color:rgb(212, 212, 212)">.</span><span class="token method function property-access" style="color:rgb(220, 220, 170)">join</span><span class="token punctuation" style="color:rgb(212, 212, 212)">(</span><span class="token plain">graduateProgram</span><span class="token punctuation" style="color:rgb(212, 212, 212)">,</span><span class="token plain"> joinExpression</span><span class="token punctuation" style="color:rgb(212, 212, 212)">,</span><span class="token plain"> joinType</span><span class="token punctuation" style="color:rgb(212, 212, 212)">)</span><span class="token punctuation" style="color:rgb(212, 212, 212)">.</span><span class="token method function property-access" style="color:rgb(220, 220, 170)">show</span><span class="token punctuation" style="color:rgb(212, 212, 212)">(</span><span class="token punctuation" style="color:rgb(212, 212, 212)">)</span><span class="token plain"></span></div></pre></pre></pre><p class="paragraph"><strong>Outer Joins</strong></p><ul><li>Evaluate the keys in both of the DataFrames or tables and includes (and joins together) the rows that evaluate to true or false. If there is no equivalent row in either the left or right DataFrame, Spark will insert null.</li></ul><pre class="css-fkgcw9 eyprwjk0"><pre><pre class="prism-code language-javascript pre" style="color:#9CDCFE;background-color:#1E1E1E" p="3"><div class="token-line"><span class="token plain">joinType </span><span class="token operator" style="color:rgb(212, 212, 212)">=</span><span class="token plain"> </span><span class="token string" style="color:rgb(206, 145, 120)">&quot;outer&quot;</span><span class="token plain"></span></div><div class="token-line"><span class="token plain">person</span><span class="token punctuation" style="color:rgb(212, 212, 212)">.</span><span class="token method function property-access" style="color:rgb(220, 220, 170)">join</span><span class="token punctuation" style="color:rgb(212, 212, 212)">(</span><span class="token plain">graduateProgram</span><span class="token punctuation" style="color:rgb(212, 212, 212)">,</span><span class="token plain"> joinExpression</span><span class="token punctuation" style="color:rgb(212, 212, 212)">,</span><span class="token plain"> joinType</span><span class="token punctuation" style="color:rgb(212, 212, 212)">)</span><span class="token punctuation" style="color:rgb(212, 212, 212)">.</span><span class="token method function property-access" style="color:rgb(220, 220, 170)">show</span><span class="token punctuation" style="color:rgb(212, 212, 212)">(</span><span class="token punctuation" style="color:rgb(212, 212, 212)">)</span><span class="token plain"></span></div></pre></pre></pre><p class="paragraph"><strong>Left Outer Joins</strong></p><ul><li>Left outer joins evaluate the keys in both of the DataFrames or tables and includes all rows from the left DataFrame as well as any rows in the right DataFrame that have a match in the left DataFrame. If there is no equivalent row in the right DataFrame, Spark will insert null.</li></ul><pre class="css-fkgcw9 eyprwjk0"><pre><pre class="prism-code language-javascript pre" style="color:#9CDCFE;background-color:#1E1E1E" p="3"><div class="token-line"><span class="token plain">joinType </span><span class="token operator" style="color:rgb(212, 212, 212)">=</span><span class="token plain"> </span><span class="token string" style="color:rgb(206, 145, 120)">&quot;left_outer&quot;</span><span class="token plain"></span></div><div class="token-line"><span class="token plain">graduateProgram</span><span class="token punctuation" style="color:rgb(212, 212, 212)">.</span><span class="token method function property-access" style="color:rgb(220, 220, 170)">join</span><span class="token punctuation" style="color:rgb(212, 212, 212)">(</span><span class="token plain">person</span><span class="token punctuation" style="color:rgb(212, 212, 212)">,</span><span class="token plain"> joinExpression</span><span class="token punctuation" style="color:rgb(212, 212, 212)">,</span><span class="token plain"> joinType</span><span class="token punctuation" style="color:rgb(212, 212, 212)">)</span><span class="token punctuation" style="color:rgb(212, 212, 212)">.</span><span class="token method function property-access" style="color:rgb(220, 220, 170)">show</span><span class="token punctuation" style="color:rgb(212, 212, 212)">(</span><span class="token punctuation" style="color:rgb(212, 212, 212)">)</span><span class="token plain"></span></div></pre></pre></pre><p class="paragraph"><strong>Right Outer Joins</strong></p><ul><li>Right outer joins evaluate the keys in both of the DataFrames or tables and includes all rows from the right DataFrame as well as any rows in the left DataFrame that have a match in the right DataFrame. If there is no equivalent row in the left DataFrame, Spark will insert null.</li></ul><pre class="css-fkgcw9 eyprwjk0"><pre><pre class="prism-code language-javascript pre" style="color:#9CDCFE;background-color:#1E1E1E" p="3"><div class="token-line"><span class="token plain">joinType </span><span class="token operator" style="color:rgb(212, 212, 212)">=</span><span class="token plain"> </span><span class="token string" style="color:rgb(206, 145, 120)">&quot;right_outer&quot;</span><span class="token plain"></span></div><div class="token-line"><span class="token plain">person</span><span class="token punctuation" style="color:rgb(212, 212, 212)">.</span><span class="token method function property-access" style="color:rgb(220, 220, 170)">join</span><span class="token punctuation" style="color:rgb(212, 212, 212)">(</span><span class="token plain">graduateProgram</span><span class="token punctuation" style="color:rgb(212, 212, 212)">,</span><span class="token plain"> joinExpression</span><span class="token punctuation" style="color:rgb(212, 212, 212)">,</span><span class="token plain"> joinType</span><span class="token punctuation" style="color:rgb(212, 212, 212)">)</span><span class="token punctuation" style="color:rgb(212, 212, 212)">.</span><span class="token method function property-access" style="color:rgb(220, 220, 170)">show</span><span class="token punctuation" style="color:rgb(212, 212, 212)">(</span><span class="token punctuation" style="color:rgb(212, 212, 212)">)</span><span class="token plain"></span></div></pre></pre></pre><p class="paragraph"><strong>Left Semi Joins</strong></p><ul><li>Semi joins do not actually include any values from the right DataFrame. They only compare values to see if the value exists in the second DataFrame. If the value does exist, those rows will be kept in the result, even if there are duplicate keys in the left DataFrame. Think of left semi joins as filters on a DataFrame, as opposed to the function of a conventional join.</li></ul><pre class="css-fkgcw9 eyprwjk0"><pre><pre class="prism-code language-javascript pre" style="color:#9CDCFE;background-color:#1E1E1E" p="3"><div class="token-line"><span class="token plain">joinType </span><span class="token operator" style="color:rgb(212, 212, 212)">=</span><span class="token plain"> </span><span class="token string" style="color:rgb(206, 145, 120)">&quot;left_semi&quot;</span><span class="token plain"></span></div><div class="token-line"><span class="token plain">graduateProgram</span><span class="token punctuation" style="color:rgb(212, 212, 212)">.</span><span class="token method function property-access" style="color:rgb(220, 220, 170)">join</span><span class="token punctuation" style="color:rgb(212, 212, 212)">(</span><span class="token plain">person</span><span class="token punctuation" style="color:rgb(212, 212, 212)">,</span><span class="token plain"> joinExpression</span><span class="token punctuation" style="color:rgb(212, 212, 212)">,</span><span class="token plain"> joinType</span><span class="token punctuation" style="color:rgb(212, 212, 212)">)</span><span class="token punctuation" style="color:rgb(212, 212, 212)">.</span><span class="token method function property-access" style="color:rgb(220, 220, 170)">show</span><span class="token punctuation" style="color:rgb(212, 212, 212)">(</span><span class="token punctuation" style="color:rgb(212, 212, 212)">)</span><span class="token plain"></span></div></pre></pre></pre><p class="paragraph"><strong>Left Anti Joins</strong></p><ul><li>Left anti joins are the opposite of left semi joins. Like left semi joins, they do not actually include any values from the right DataFrame. They only compare values to see if the value exists in the second DataFrame. However, rather than keeping the values that exist in the second DataFrame, they keep only the values that do not have a corresponding key in the second DataFrame. Like a NOT IN SQL style filter.</li></ul><pre class="css-fkgcw9 eyprwjk0"><pre><pre class="prism-code language-javascript pre" style="color:#9CDCFE;background-color:#1E1E1E" p="3"><div class="token-line"><span class="token plain">joinType </span><span class="token operator" style="color:rgb(212, 212, 212)">=</span><span class="token plain"> </span><span class="token string" style="color:rgb(206, 145, 120)">&quot;left_anti&quot;</span><span class="token plain"></span></div><div class="token-line"><span class="token plain">graduateProgram</span><span class="token punctuation" style="color:rgb(212, 212, 212)">.</span><span class="token method function property-access" style="color:rgb(220, 220, 170)">join</span><span class="token punctuation" style="color:rgb(212, 212, 212)">(</span><span class="token plain">person</span><span class="token punctuation" style="color:rgb(212, 212, 212)">,</span><span class="token plain"> joinExpression</span><span class="token punctuation" style="color:rgb(212, 212, 212)">,</span><span class="token plain"> joinType</span><span class="token punctuation" style="color:rgb(212, 212, 212)">)</span><span class="token punctuation" style="color:rgb(212, 212, 212)">.</span><span class="token method function property-access" style="color:rgb(220, 220, 170)">show</span><span class="token punctuation" style="color:rgb(212, 212, 212)">(</span><span class="token punctuation" style="color:rgb(212, 212, 212)">)</span><span class="token plain"></span></div></pre></pre></pre><p class="paragraph"><strong>Cross (Cartesian) Joins</strong></p><ul><li>Cross-joins are inner joins that do not specify a predicate. Cross joins will join every single row in the left DataFrame to ever single row in the right DataFrame. This will cause an absolute explosion in the number of rows contained in the resulting DataFrame. If you have 1,000 rows in each DataFrame, the cross join of these will result in 1,000,000 (1,000 x 1,000) rows. For this reason, you must very explicitly state that you want a cross-join by using the following special syntax:</li></ul><pre class="css-fkgcw9 eyprwjk0"><pre><pre class="prism-code language-javascript pre" style="color:#9CDCFE;background-color:#1E1E1E" p="3"><div class="token-line"><span class="token plain">joinType </span><span class="token operator" style="color:rgb(212, 212, 212)">=</span><span class="token plain"> </span><span class="token string" style="color:rgb(206, 145, 120)">&quot;cross&quot;</span><span class="token plain"></span></div><div class="token-line"><span class="token plain">graduateProgram</span><span class="token punctuation" style="color:rgb(212, 212, 212)">.</span><span class="token method function property-access" style="color:rgb(220, 220, 170)">join</span><span class="token punctuation" style="color:rgb(212, 212, 212)">(</span><span class="token plain">person</span><span class="token punctuation" style="color:rgb(212, 212, 212)">,</span><span class="token plain"> joinExpression</span><span class="token punctuation" style="color:rgb(212, 212, 212)">,</span><span class="token plain"> joinType</span><span class="token punctuation" style="color:rgb(212, 212, 212)">)</span><span class="token punctuation" style="color:rgb(212, 212, 212)">.</span><span class="token method function property-access" style="color:rgb(220, 220, 170)">show</span><span class="token punctuation" style="color:rgb(212, 212, 212)">(</span><span class="token punctuation" style="color:rgb(212, 212, 212)">)</span><span class="token plain"></span></div></pre></pre></pre><h1 class="heading1" id="challengeswhenusingjoins">Challenges When Using Joins</h1><p class="paragraph"><strong>Joins on Complex Types</strong></p><ul><li>Any expression is a valid join expression, assuming that it returns a Boolean.</li></ul><p class="paragraph"><strong>Handling Duplicate Column Names</strong>
In a DataFrame, each column has a unique ID within Spark’s SQL Engine, Catalyst. This unique ID is purely internal and not something that you can directly reference. This makes it quite difficult to refer to a specific column when you have a DataFrame with duplicate column names.
<em>This can occur in two distinct situations:</em></p><ul><li>The join expression that you specify does not remove one key from one of the input DataFrames and the keys have the same column name</li><li>Two columns on which you are not performing the join on have the same name</li></ul><p class="paragraph">Note: If you partition your data correctly prior to a join, you can end up with much more efficient execution because even if a shuffle is planned, if data from two different DataFrames is already located on the same machine, Spark can avoid the shuffle.</p><h1 class="heading1" id="datasources">Data Sources</h1><ul><li><strong>JSON:</strong> JSON objects have structure, and JavaScript (on which JSON is based) has at least basic types. This makes it easier to work with</li><li><strong>Parquet</strong>: Parquet is an open source column-oriented data store that provides a variety of storage optimizations, especially for analytics workloads. It provides columnar compression, which saves storage space and allows for reading individual columns instead of entire files. It is the default file format. Writing data out to Parquet for long-term storage because reading from a parquet file will always be more efficient than JSON or CSV. Another advantage of Parquet is that it supports complex types. </li><li><strong>ORC</strong>: ORC is a self-describing, type-aware columnar file format designed for Hadoop workloads. It is optimized for large streaming reads, but with integrated support for finding required rows quickly. ORC has no options for reading in data because Spark understands the file format well.</li><li><strong>JDBC/ODBC Connections</strong></li><li><strong>Plain Text Files</strong> Each line in the file becomes a record in the DataFrame. </li><li><strong>CSV:</strong> Commma-Separated Values. Each line represents a single record, and commas separate each field within a record. </li></ul><p class="paragraph"><strong>Community-created Data Sources</strong></p><ul><li>Cassandra</li><li>HBase</li><li>MongoDB</li><li>AWS Redshift</li><li>XML</li></ul><h1 class="heading1" id="thestructureofthedatasourcesapi">The Structure of the Data Sources API</h1><p class="paragraph"><strong>Reading data:</strong>
<code>DataFrameReader.format(...).option(&quot;key&quot;, &quot;value&quot;).schema(...).load()</code>
#<code>format</code> is optional because Spark will use the parquet format by default
#<code>.option</code> allows you to set key value configurations to parameterize how you will read data
#<code>schema</code> is optional if the data source provides a schema or if intend to use schema inference. </p><p class="paragraph">The foundation for reading data in Spark is the DataFrameReader. We access this through the SparkSession via the read attribute: <code>spark.read</code>
After we have a DataFrame reader, we specify several values: 
the format (1)
the schema (2)
the read mode (3)
a series of options (4)</p><p class="paragraph">Example: </p><pre class="css-fkgcw9 eyprwjk0"><pre><pre class="prism-code language-javascript pre" style="color:#9CDCFE;background-color:#1E1E1E" p="3"><div class="token-line"><span class="token plain">spark</span><span class="token punctuation" style="color:rgb(212, 212, 212)">.</span><span class="token property-access">read</span><span class="token punctuation" style="color:rgb(212, 212, 212)">.</span><span class="token method function property-access" style="color:rgb(220, 220, 170)">format</span><span class="token punctuation" style="color:rgb(212, 212, 212)">(</span><span class="token string" style="color:rgb(206, 145, 120)">&quot;csv&quot;</span><span class="token punctuation" style="color:rgb(212, 212, 212)">)</span><span class="token plain"></span></div><div class="token-line"><span class="token plain"></span><span class="token punctuation" style="color:rgb(212, 212, 212)">.</span><span class="token method function property-access" style="color:rgb(220, 220, 170)">option</span><span class="token punctuation" style="color:rgb(212, 212, 212)">(</span><span class="token string" style="color:rgb(206, 145, 120)">&quot;mode&quot;</span><span class="token punctuation" style="color:rgb(212, 212, 212)">,</span><span class="token plain"> </span><span class="token string" style="color:rgb(206, 145, 120)">&quot;FAILFAST&quot;</span><span class="token punctuation" style="color:rgb(212, 212, 212)">)</span><span class="token plain"></span></div><div class="token-line"><span class="token plain"></span><span class="token punctuation" style="color:rgb(212, 212, 212)">.</span><span class="token method function property-access" style="color:rgb(220, 220, 170)">option</span><span class="token punctuation" style="color:rgb(212, 212, 212)">(</span><span class="token string" style="color:rgb(206, 145, 120)">&quot;inferSchema&quot;</span><span class="token punctuation" style="color:rgb(212, 212, 212)">,</span><span class="token plain"> </span><span class="token string" style="color:rgb(206, 145, 120)">&quot;true&quot;</span><span class="token punctuation" style="color:rgb(212, 212, 212)">)</span><span class="token plain"></span></div><div class="token-line"><span class="token plain"></span><span class="token punctuation" style="color:rgb(212, 212, 212)">.</span><span class="token method function property-access" style="color:rgb(220, 220, 170)">option</span><span class="token punctuation" style="color:rgb(212, 212, 212)">(</span><span class="token string" style="color:rgb(206, 145, 120)">&quot;path&quot;</span><span class="token punctuation" style="color:rgb(212, 212, 212)">,</span><span class="token plain"> </span><span class="token string" style="color:rgb(206, 145, 120)">&quot;path/to/file(s)&quot;</span><span class="token punctuation" style="color:rgb(212, 212, 212)">)</span><span class="token plain"></span></div><div class="token-line"><span class="token plain"></span><span class="token punctuation" style="color:rgb(212, 212, 212)">.</span><span class="token method function property-access" style="color:rgb(220, 220, 170)">schema</span><span class="token punctuation" style="color:rgb(212, 212, 212)">(</span><span class="token plain">someSchema</span><span class="token punctuation" style="color:rgb(212, 212, 212)">)</span><span class="token plain"></span></div><div class="token-line"><span class="token plain"></span><span class="token punctuation" style="color:rgb(212, 212, 212)">.</span><span class="token method function property-access" style="color:rgb(220, 220, 170)">load</span><span class="token punctuation" style="color:rgb(212, 212, 212)">(</span><span class="token punctuation" style="color:rgb(212, 212, 212)">)</span><span class="token plain"></span></div></pre></pre></pre><p class="paragraph"><strong>Read Mode</strong>
Reading data from an external source naturally entails encountering malformed data, especially when working with only semi-structured data sources. Read modes specify what will happen when Spark does come across malformed records.</p><h1 class="heading1" id="basicsofwritingdata">Basics of Writing Data</h1><p class="paragraph">The foundation for writing data is quite similar to that of reading data. Instead of the <code>DataFrameReader</code>, we have the <code>DataFrameWriter</code>. Because we always need to write out some given data source, we access the <code>DataFrameWriter</code> on a per DataFrame basis via the write attribute: dataFrame.write</p><p class="paragraph"> 
<em>Specify three values:</em> the format, a series of options, and the save mode. At a minimum, you must supply a path. 
Example:</p><pre class="css-fkgcw9 eyprwjk0"><pre><pre class="prism-code language-javascript pre" style="color:#9CDCFE;background-color:#1E1E1E" p="3"><div class="token-line"><span class="token plain">dataframe</span><span class="token punctuation" style="color:rgb(212, 212, 212)">.</span><span class="token property-access">write</span><span class="token punctuation" style="color:rgb(212, 212, 212)">.</span><span class="token method function property-access" style="color:rgb(220, 220, 170)">format</span><span class="token punctuation" style="color:rgb(212, 212, 212)">(</span><span class="token string" style="color:rgb(206, 145, 120)">&quot;csv&quot;</span><span class="token punctuation" style="color:rgb(212, 212, 212)">)</span><span class="token plain"></span></div><div class="token-line"><span class="token plain"></span><span class="token punctuation" style="color:rgb(212, 212, 212)">.</span><span class="token method function property-access" style="color:rgb(220, 220, 170)">option</span><span class="token punctuation" style="color:rgb(212, 212, 212)">(</span><span class="token string" style="color:rgb(206, 145, 120)">&quot;mode&quot;</span><span class="token punctuation" style="color:rgb(212, 212, 212)">,</span><span class="token plain"> </span><span class="token string" style="color:rgb(206, 145, 120)">&quot;OVERWRITE&quot;</span><span class="token punctuation" style="color:rgb(212, 212, 212)">)</span><span class="token plain"></span></div><div class="token-line"><span class="token plain"></span><span class="token punctuation" style="color:rgb(212, 212, 212)">.</span><span class="token method function property-access" style="color:rgb(220, 220, 170)">option</span><span class="token punctuation" style="color:rgb(212, 212, 212)">(</span><span class="token string" style="color:rgb(206, 145, 120)">&quot;dateFormat&quot;</span><span class="token punctuation" style="color:rgb(212, 212, 212)">,</span><span class="token plain"> </span><span class="token string" style="color:rgb(206, 145, 120)">&quot;yyyy-MM-dd&quot;</span><span class="token punctuation" style="color:rgb(212, 212, 212)">)</span><span class="token plain"></span></div><div class="token-line"><span class="token plain"></span><span class="token punctuation" style="color:rgb(212, 212, 212)">.</span><span class="token method function property-access" style="color:rgb(220, 220, 170)">option</span><span class="token punctuation" style="color:rgb(212, 212, 212)">(</span><span class="token string" style="color:rgb(206, 145, 120)">&quot;path&quot;</span><span class="token punctuation" style="color:rgb(212, 212, 212)">,</span><span class="token plain"> </span><span class="token string" style="color:rgb(206, 145, 120)">&quot;path/to/file(s)&quot;</span><span class="token punctuation" style="color:rgb(212, 212, 212)">)</span><span class="token plain"></span></div><div class="token-line"><span class="token plain"></span><span class="token punctuation" style="color:rgb(212, 212, 212)">.</span><span class="token method function property-access" style="color:rgb(220, 220, 170)">save</span><span class="token punctuation" style="color:rgb(212, 212, 212)">(</span><span class="token punctuation" style="color:rgb(212, 212, 212)">)</span><span class="token plain"></span></div></pre></pre></pre><h1 class="heading1" id="savemode">Save Mode</h1><ul><li>Save modes specify what will happen if Spark finds data at the specified location. The default is errorIfExists. This means that if Spark finds data at the location to which you’re writing, it will fail the write immediately.</li></ul><h1 class="heading1" id="sparksql">SparkSQL</h1><p class="paragraph">With SparkSQL you can:</p><ul><li>Run SQL queries against views or tables organized into databases</li><li>Use system functions of define user functions and analyze query plans in order to optimize their workloads<ul><li>You can choose to express some of your data manipulations in SQL and others in DataFrames and they will compile to the same underlying code</li></ul></li></ul><h1 class="heading1" id="whatissql?">What is SQL?</h1><ul><li>Structured Query Language</li><li>Domain-specific language (A domain-specific language is created specifically to solve problems in a particular domain and is not intended to be able to solve problems outside it (although that may be technically possible). <ul><li>In contrast, general-purpose languages are created to solve problems in many domains.)</li></ul></li><li>For expressing relational operations over data, it is used in all relational databases.</li></ul><h1 class="heading1" id="sparksql">Spark SQL</h1><p class="paragraph"><em>The power of Spark SQL derives from:</em></p><ul><li><p class="paragraph">SQL analysts can take advantage of Spark’s computation abilities by plugging into the Thrift Server or Spark’s SQL interface</p></li><li><p class="paragraph">Data engineers and scientists can use Spark SQL where appropriate in any data flow. </p><ul><li>This unifying API allows for data to be extracted with SQL, manipulated as a DataFrame, passed into one of Spark MLlibs large scale machine learning algorithms, written out to another data source and everything in between.</li></ul></li><li><p class="paragraph">Spark SQL is intended to operate as a online analytic processing (OLAP) database. This means that it is not intended to perform very extremely-low-latency queries. </p></li></ul><table><thead><tr><th align="left">OLAP (Online Analytic Processing)</th><th align="center">OLTP (Online Transaction Processing)</th></tr></thead><tbody><tr><td align="left">Deals with Historical Data or Archival Data. OLAP is characterized by relatively low volume of transactions. Queries are often very complex and involve aggregations. For OLAP systems a response time is an effectiveness measure. OLAP applications are widely used by Data Mining techniques. In OLAP database there is aggregated, historical data, stored in multi-dimensional schemas (usually star schema). Sometime query need to access large amount of data in Management records like what was the profit of your company in last year.</td><td align="center">Is involved in the operation of a particular system. OLTP is characterized by a large number of short on-line transactions (INSERT, UPDATE, DELETE). The main emphasis for OLTP systems is put on very fast query processing, maintaining data integrity in multi-access environments and an effectiveness measured by number of transactions per second. In OLTP database there is detailed and current data, and schema used to store transactional databases is the entity model (usually 3NF). It involves Queries accessing individual record like Update your Email in Company database.</td></tr></tbody></table><h1 class="heading1" id="sparksqlcli">Spark SQL CLI</h1><ul><li>You can make Spark SQL queries in local mode from the command line. It cannot communicate with the Thrift JDBC server. To start Spark SQL CLI, run the following in the spark directory: 
<code>./bin/spark-sql</code></li><li>It is also possible to execute sql in an ad hoc manner via any of Spark&#x27;s language by calling the method &quot;sql&quot; on the SparkSession object.
<code>spark.sql(&quot;SELECT 1 + 1&quot;).show()</code></li></ul><p class="paragraph">Note: <strong>You can completely interoperate between SQL and DataFrames e.g you can create a DataFrame, manipulate it with SQL, and then manipulate it again as a DataFrame.</strong></p><p class="paragraph"><strong>Convert DataFrame to SQL:</strong></p><pre class="css-fkgcw9 eyprwjk0"><pre><pre class="prism-code language-javascript pre" style="color:#9CDCFE;background-color:#1E1E1E" p="3"><div class="token-line"><span class="token plain">spark</span><span class="token punctuation" style="color:rgb(212, 212, 212)">.</span><span class="token property-access">read</span><span class="token punctuation" style="color:rgb(212, 212, 212)">.</span><span class="token method function property-access" style="color:rgb(220, 220, 170)">json</span><span class="token punctuation" style="color:rgb(212, 212, 212)">(</span><span class="token string" style="color:rgb(206, 145, 120)">&quot;/data.json&quot;</span><span class="token punctuation" style="color:rgb(212, 212, 212)">)</span><span class="token plain">\</span></div><div class="token-line"><span class="token plain"></span><span class="token punctuation" style="color:rgb(212, 212, 212)">.</span><span class="token method function property-access" style="color:rgb(220, 220, 170)">createOrReplaceTempView</span><span class="token punctuation" style="color:rgb(212, 212, 212)">(</span><span class="token string" style="color:rgb(206, 145, 120)">&quot;some_sql_view&quot;</span><span class="token punctuation" style="color:rgb(212, 212, 212)">)</span><span class="token plain"> </span></div></pre></pre></pre><h1 class="heading1" id="catalog">Catalog</h1><p class="paragraph">The highest level abstraction in Spark SQL is the Catalog. The Catalog is an abstraction for the storage of metadata about the data stored in your tables as well as other helpful things like databases, tables, functions, and views. The catalog is available in the org.apache.spark.sql.catalog.Catalog package and contains a number of helpful functions for doing things like listing tables, databases, and functions. We will talk about all of these things shortly It’s very self explanatory to users, so we will omit the code samples here but it’s really just another programmatic interface to Spark SQL. This chapter shows only the SQL being executed; thus, keep in mind if you’re using the programmatic interface that you need to wrap everything in a spark.sql function call to execute the relevant code.</p><h1 class="heading1" id="tables">Tables</h1><p class="paragraph">To do anything useful with Spark SQL you first need to define tables. Tables are a structure of data against which you run commands. We can join tables, filter them, aggregate them, and perform different manipulations.
The core difference between tables and DataFrames is that you define DataFrames in a scope of a programming language, whereas you define tables within a database. This means that when you create a table (assuming you never changed the database), it will belong to the default database. </p><p class="paragraph"><strong>In Spark 2.X, tables always contain data. There is no notion of a temporary table: these are just views that do not contain data.  This is important because if you go to drop a table, you can risk losing the data when doing so.</strong></p><h1 class="heading1" id="spark-managedtables">Spark-Managed Tables</h1><ul><li>There are managed tables and unmanaged tables. </li><li>When you define a table from files on disk, you are defining an unmanaged table. </li><li>When you use saveAsTable on a DataFrame you are creating a managed table for which Spark will keep track of all the relevant information for you. </li><li>This will read your table and write it out to a new location in Spark format. </li><li>You can see this reflected in the new explain plan. <ul><li>In the explain plan you will also notice that this writes to the default Hive warehouse location. You can set this by setting the spark.sql.warehouse.dir configuration to the directory of your choosing when you create your SparkSession.</li></ul></li></ul><p class="paragraph"><strong>Tables store two important information:</strong></p><ul><li>data within the tables</li><li>data about the tables, that is, metadata</li></ul><h1 class="heading1" id="views">Views</h1><p class="paragraph">Now that you created a table, another thing that you can define is a view. 
A view specifies a set of transformations on top of an existing table—basically just saved query plans, which can be convenient for organizing or reusing your query logic. Spark has several different notions of views. Views can be global, set to a database, or per session.</p><h1 class="heading1" id="creatingviews">Creating Views</h1><p class="paragraph">To an end user, views are displayed as tables, except rather than rewriting all of the data to a new location, they simply perform a transformation on the source data at query time. This might be a filter, select, or potentially an even larger GROUP BY or ROLLUP.</p><p class="paragraph"><strong>Views</strong>
A view specifies a set of transformations on top of an existing table—basically just saved query plans, which can be convenient for organizing or reusing your query logic. Spark has several different notions of views. Views can be global, set to a database, or per session.</p><p class="paragraph"><strong>Creating Views</strong>
To an end user, views are displayed as tables, except rather than rewriting all of the data to a new location, they simply perform a transformation on the source data at query time. This might be a filter, select, or potentially an even larger GROUP BY or ROLLUP.</p><hr/><h1 class="heading1" id="sourcers/credits:">Sourcers/Credits:</h1><p class="paragraph">To be completed</p></div><div class="addPaddTopBottom"><style data-emotion-css="1594l43">.css-1594l43{margin:0px;padding:0px;width:auto;display:grid;grid-template-rows:auto;-webkit-column-gap:24px;column-gap:24px;grid-template-columns:calc(50% - 8px) calc(50% - 8px);}.css-1594l43 .previousBtn{cursor:pointer;-moz-box-align:center;-moz-box-direction:normal;-moz-box-orient:horizontal;margin:0px;padding:0px;position:relative;display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-flex-direction:row;-ms-flex-direction:row;flex-direction:row;-webkit-align-items:center;-webkit-box-align:center;-ms-flex-align:center;align-items:center;place-self:stretch;border-radius:3px;border:1px solid rgb(230,236,241);-webkit-transition:border 200ms ease 0s;transition:border 200ms ease 0s;box-shadow:rgba(116,129,141,0.1) 0px 3px 8px 0px;-webkit-text-decoration:none;text-decoration:none;background-color:#fff;color:#3B454E;}.css-1594l43 .nextBtn{cursor:pointer;-moz-box-align:center;-moz-box-direction:normal;-moz-box-orient:horizontal;margin:0px;padding:0px;position:relative;display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-flex-direction:row;-ms-flex-direction:row;flex-direction:row;-webkit-align-items:center;-webkit-box-align:center;-ms-flex-align:center;align-items:center;place-self:stretch;border-radius:3px;border:1px solid rgb(230,236,241);-webkit-transition:border 200ms ease 0s;transition:border 200ms ease 0s;box-shadow:rgba(116,129,141,0.1) 0px 3px 8px 0px;-webkit-text-decoration:none;text-decoration:none;background-color:#fff;color:#3B454E;}.css-1594l43 .nextBtn:hover,.css-1594l43 .previousBtn:hover{-webkit-text-decoration:none;text-decoration:none;border:1px solid #125fb3;}.css-1594l43 .nextBtn:hover .rightArrow,.css-1594l43 .previousBtn:hover .leftArrow{color:#125fb3;}.css-1594l43 .leftArrow{display:block;margin:0px;color:rgb(157,170,182);-webkit-flex:0 0 auto;-ms-flex:0 0 auto;flex:0 0 auto;font-size:24px;-webkit-transition:color 200ms ease 0s;transition:color 200ms ease 0s;padding:16px;padding-right:16px;}.css-1594l43 .rightArrow{-webkit-flex:0 0 auto;-ms-flex:0 0 auto;flex:0 0 auto;font-size:24px;-webkit-transition:color 200ms ease 0s;transition:color 200ms ease 0s;padding:16px;padding-left:16px;display:block;margin:0px;color:rgb(157,170,182);}.css-1594l43 .nextPreviousTitle{display:block;margin:0px;padding:0px;-webkit-transition:color 200ms ease 0s;transition:color 200ms ease 0s;}.css-1594l43 .nextPreviousTitle span{font-size:16px;line-height:1.5;font-weight:500;}@media (max-width:767px){.css-1594l43{display:block;padding:0 15px;}.css-1594l43 .previousBtn{margin-bottom:20px;}}</style><div class="css-1594l43 eg6ngbo0"><a class="previousBtn" href="/courseware/sparkinternals/3-sparkinternals"><div class="leftArrow"><svg preserveAspectRatio="xMidYMid meet" height="1em" width="1em" fill="none" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" stroke="currentColor" class="_13gjrqj"><g><line x1="19" y1="12" x2="5" y2="12"></line><polyline points="12 19 5 12 12 5"></polyline></g></svg></div><div class="preRightWrapper"><div class="smallContent"><span>Previous</span></div><div class="nextPreviousTitle"><span>Homework</span></div></div></a><a class="nextBtn" href="/courseware/sparkAPI/1-sparkAPI"><div class="nextRightWrapper"><div class="smallContent"><span>Next</span></div><div class="nextPreviousTitle"><span>Class Resources</span></div></div><div class="rightArrow"><svg preserveAspectRatio="xMidYMid meet" height="1em" width="1em" fill="none" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" stroke="currentColor" class="_13gjrqj"><g><line x1="5" y1="12" x2="19" y2="12"></line><polyline points="12 5 19 12 12 19"></polyline></g></svg></div></a></div></div></div></main><style data-emotion-css="gqp3x7">.css-gqp3x7{width:224px;}</style><div class="hiddenMobile css-gqp3x7 eso2aao4"><style data-emotion-css="1dq6tsi">.css-1dq6tsi{width:100%;border-right:1px solid #ede7f3;height:100vh;overflow:auto;position:fixed;padding-left:24px;position:-webkit-sticky;position:-moz-sticky;position:-webkit-sticky;position:sticky;top:0;background:#fff;}.css-1dq6tsi .rightSideTitle{font-size:10px;line-height:1;font-weight:700;text-transform:uppercase;-webkit-letter-spacing:1.2px;-moz-letter-spacing:1.2px;-ms-letter-spacing:1.2px;letter-spacing:1.2px;padding:7px 24px 7px 16px;border-left:1px solid #e6ecf1;border-left-color:rgb(230,236,241);color:#3B454E;}.css-1dq6tsi .rightSideBarUL{margin-top:32px;}.css-1dq6tsi .rightSideBarUL li{list-style-type:none;border-left:1px solid #e6ecf1;border-left-color:rgb(230,236,241);}.css-1dq6tsi .rightSideBarUL li a{font-size:12px;font-weight:500;line-height:1.5;padding:7px 24px 7px 16px;color:#3B454E;}@media only screen and (max-width:50rem){.css-1dq6tsi{width:100%;position:relative;}}</style><aside class="css-1dq6tsi e1djfo3h0"><ul></ul></aside></div></div></div></div><div id="gatsby-announcer" style="position:absolute;top:0;width:1px;height:1px;padding:0;overflow:hidden;clip:rect(0, 0, 0, 0);white-space:nowrap;border:0" aria-live="assertive" aria-atomic="true"></div></div><script id="gatsby-script-loader">/*<![CDATA[*/window.pagePath="/sparkAPI";/*]]>*/</script><script id="gatsby-chunk-mapping">/*<![CDATA[*/window.___chunkMapping={"polyfill":["/polyfill-50eea0acba5bd0bbefbf.js"],"app":["/app-0f03f9d6df3e68604912.js"],"component---src-templates-docs-js":[]};/*]]>*/</script><script src="/courseware/polyfill-50eea0acba5bd0bbefbf.js" nomodule=""></script><script src="/courseware/app-0f03f9d6df3e68604912.js" async=""></script><script src="/courseware/commons-2ef445fb87a62dd81c1d.js" async=""></script><script src="/courseware/framework-c90682c3d94fb45fdc20.js" async=""></script><script src="/courseware/webpack-runtime-d9051b0ba854d717e0f5.js" async=""></script><script defer="">
            function navBarClose() {
              document.getElementById("navbar").classList.toggle("responsive");
            }
            document.addEventListener('click',function(e){
              if(e.target && e.target.tagName.toLowerCase() === 'a'){
                navBarClose();
              }
           });
            </script></body></html>