{"componentChunkName":"component---src-templates-docs-js","path":"/spark-continued","result":{"data":{"site":{"siteMetadata":{"title":"Data Engineering at Central European University","docsLocation":"https://github.com/zoltanctoth/ceu-cloud-bigdata-course/tree/master"}},"mdx":{"fields":{"id":"8e4a2f8d-345e-5f58-9a89-e8c0fd4991f0","title":"Week 7 - Apacke Spark Hands-on","slug":"/spark-continued"},"body":"function _extends() { _extends = Object.assign || function (target) { for (var i = 1; i < arguments.length; i++) { var source = arguments[i]; for (var key in source) { if (Object.prototype.hasOwnProperty.call(source, key)) { target[key] = source[key]; } } } return target; }; return _extends.apply(this, arguments); }\n\nfunction _objectWithoutProperties(source, excluded) { if (source == null) return {}; var target = _objectWithoutPropertiesLoose(source, excluded); var key, i; if (Object.getOwnPropertySymbols) { var sourceSymbolKeys = Object.getOwnPropertySymbols(source); for (i = 0; i < sourceSymbolKeys.length; i++) { key = sourceSymbolKeys[i]; if (excluded.indexOf(key) >= 0) continue; if (!Object.prototype.propertyIsEnumerable.call(source, key)) continue; target[key] = source[key]; } } return target; }\n\nfunction _objectWithoutPropertiesLoose(source, excluded) { if (source == null) return {}; var target = {}; var sourceKeys = Object.keys(source); var key, i; for (i = 0; i < sourceKeys.length; i++) { key = sourceKeys[i]; if (excluded.indexOf(key) >= 0) continue; target[key] = source[key]; } return target; }\n\n/* @jsxRuntime classic */\n\n/* @jsx mdx */\nvar _frontmatter = {\n  \"title\": \"Week 7 - Apacke Spark Hands-on\",\n  \"metaTitle\": \"Week 7 - Apacke Spark Hands-on\",\n  \"metaDescription\": \"Week 7 - Apacke Spark Hands-on\"\n};\nvar layoutProps = {\n  _frontmatter: _frontmatter\n};\nvar MDXLayout = \"wrapper\";\nreturn function MDXContent(_ref) {\n  var components = _ref.components,\n      props = _objectWithoutProperties(_ref, [\"components\"]);\n\n  return mdx(MDXLayout, _extends({}, layoutProps, props, {\n    components: components,\n    mdxType: \"MDXLayout\"\n  }), mdx(\"h1\", null, \"Apache Spark DataFrame API, SQL and Internals - Summary & Resources\"), mdx(\"h1\", null, \"Recap video (Job, Stage, Task, Shuffle):\"), mdx(\"p\", null, mdx(\"a\", _extends({\n    parentName: \"p\"\n  }, {\n    \"href\": \"https://www.youtube.com/watch?v=a-yrOubLFn0&feature=youtu.be\"\n  }), \"https://www.youtube.com/watch?v=a-yrOubLFn0&feature=youtu.be\")), mdx(\"h1\", null, \"Deep Dive into Spark SQL\\u2019s Catalyst Optimizer:\"), mdx(\"p\", null, mdx(\"a\", _extends({\n    parentName: \"p\"\n  }, {\n    \"href\": \"https://databricks.com/blog/2015/04/13/deep-dive-into-spark-sqls-catalyst-optimizer.html\"\n  }), \"https://databricks.com/blog/2015/04/13/deep-dive-into-spark-sqls-catalyst-optimizer.html\")), mdx(\"h1\", null, \"Spark SQL, Built-in Functions:\"), mdx(\"p\", null, mdx(\"a\", _extends({\n    parentName: \"p\"\n  }, {\n    \"href\": \"https://spark.apache.org/docs/2.3.0/api/sql/index.html#dayofyear\"\n  }), \"https://spark.apache.org/docs/2.3.0/api/sql/index.html#dayofyear\")), mdx(\"h1\", null, \"PySpark SQL module\"), mdx(\"p\", null, mdx(\"a\", _extends({\n    parentName: \"p\"\n  }, {\n    \"href\": \"https://spark.apache.org/docs/latest/api/python/pyspark.sql.html#module-pyspark.sql.functions\"\n  }), \"https://spark.apache.org/docs/latest/api/python/pyspark.sql.html#module-pyspark.sql.functions\")), mdx(\"h1\", null, \"Pyspark SQL Column Class\"), mdx(\"p\", null, mdx(\"a\", _extends({\n    parentName: \"p\"\n  }, {\n    \"href\": \"https://spark.apache.org/docs/latest/api/python/pyspark.sql.html#pyspark.sql.Column\"\n  }), \"https://spark.apache.org/docs/latest/api/python/pyspark.sql.html#pyspark.sql.Column\")), mdx(\"h1\", null, \"Databricks Notebooks covered:\"), mdx(\"ul\", null, mdx(\"li\", {\n    parentName: \"ul\"\n  }, \"Spark Overview\"), mdx(\"li\", {\n    parentName: \"ul\"\n  }, \"DataFrame Chapter 1\"), mdx(\"li\", {\n    parentName: \"ul\"\n  }, \"DataFrame Chapter 2\"), mdx(\"li\", {\n    parentName: \"ul\"\n  }, \"DataFrame Chapter 2 Lab 2\"), mdx(\"li\", {\n    parentName: \"ul\"\n  }, \"Reading Data - \", mdx(\"a\", _extends({\n    parentName: \"li\"\n  }, {\n    \"href\": \"https://parquet.apache.org/\"\n  }), \"Parquet Video\"), \" + Databricks notebook\"), mdx(\"li\", {\n    parentName: \"ul\"\n  }, \"DataFrame Chapter 4 (SQL and Visualization)\"), mdx(\"li\", {\n    parentName: \"ul\"\n  }, \"Databricks - Internals - Catalyst Notebook\")), mdx(\"hr\", null), mdx(\"details\", null, mdx(\"summary\", null, \"Notes - under development - (click to see)\"), \"- Spark is effectively a programming language of its own.\\xA0Spark uses an engine called Catalyst - Catalyst maintains its own type information through the planning and processing of work - This opens up execution optimizations - Even if we use Spark's Structured APIs from Python or R, the majority of our manipulations will operate strictly on Spark types not Python types\", mdx(\"p\", null, mdx(\"span\", _extends({\n    parentName: \"p\"\n  }, {\n    \"className\": \"gatsby-resp-image-wrapper\",\n    \"style\": {\n      \"position\": \"relative\",\n      \"display\": \"block\",\n      \"marginLeft\": \"auto\",\n      \"marginRight\": \"auto\",\n      \"maxWidth\": \"1014px\"\n    }\n  }), \"\\n      \", mdx(\"a\", _extends({\n    parentName: \"span\"\n  }, {\n    \"className\": \"gatsby-resp-image-link\",\n    \"href\": \"/static/e090dd1b60e0668e260fd3dcc839307c/d7ab4/catalyst.png\",\n    \"style\": {\n      \"display\": \"block\"\n    },\n    \"target\": \"_blank\",\n    \"rel\": \"noopener\"\n  }), \"\\n    \", mdx(\"span\", _extends({\n    parentName: \"a\"\n  }, {\n    \"className\": \"gatsby-resp-image-background-image\",\n    \"style\": {\n      \"paddingBottom\": \"51.73745173745174%\",\n      \"position\": \"relative\",\n      \"bottom\": \"0\",\n      \"left\": \"0\",\n      \"backgroundImage\": \"url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAKCAIAAAA7N+mxAAAACXBIWXMAAC4jAAAuIwF4pT92AAAB3ElEQVQoz2VQ227aUBD0R/Un+5qHllatmpIWcNw4gEMSG0wgxNj4bp8DGDAnwVeloFKJCgLE0BPSol7mYbUa7ezODrH9D5vf+IfEdTz+2u3AMAzR0A2DgOjfetZgBFEAh77eRUF8vx+NR57X7iAbfJtMnlc4tz51bcOOw2puXQEEVTcpa/yqpKSFwZEc5HkhDvw4jr0obNK0VzwDGbKjac9iuzt4X6wpmp67bNRli6B5KXNlHrEtsmZQgtOye+vlA8aPxaJTqQ7oPDz+4hgGViZJ8rheJ6ul67rZ05LVdghRs9iGzEvGlWyVRb2PRr/e3m6RIIIsCXLHA9veZ4GbyWTygVPPb3QiU5ZTZfCGM9/x4OBMLVTF0B9FUTwKAilfQAWmTZ2ojUaIKfyL581mM6w/v7jo9fvEKd9Ms9JnTiKraq5mKbC/Xi0x5sslLPMOdWLnyK6mJ9sNpufzOT4+nU4PObXUUHe2BY2XzJoCONHoDe+eHCYJrqgpmpksICnUbv9p+2GxKHI1A3YJ+gZ+FFDqUn/LmYcCYuqtne3IjyK5ULwrMPj4EMB9ELvkNqmSaKKYoCtCmm19YsVMRXmyDXrb5HG1WuM5ja/CIgOYku+6fwX2ffbi5fXrOvoJrlH/gJvzRv0AAAAASUVORK5CYII=')\",\n      \"backgroundSize\": \"cover\",\n      \"display\": \"block\"\n    }\n  })), \"\\n  \", mdx(\"img\", _extends({\n    parentName: \"a\"\n  }, {\n    \"className\": \"gatsby-resp-image-image\",\n    \"alt\": \"catalyst\",\n    \"title\": \"catalyst\",\n    \"src\": \"/static/e090dd1b60e0668e260fd3dcc839307c/d7ab4/catalyst.png\",\n    \"srcSet\": [\"/static/e090dd1b60e0668e260fd3dcc839307c/a2ead/catalyst.png 259w\", \"/static/e090dd1b60e0668e260fd3dcc839307c/6b9fd/catalyst.png 518w\", \"/static/e090dd1b60e0668e260fd3dcc839307c/d7ab4/catalyst.png 1014w\"],\n    \"sizes\": \"(max-width: 1014px) 100vw, 1014px\",\n    \"style\": {\n      \"width\": \"100%\",\n      \"height\": \"100%\",\n      \"margin\": \"0\",\n      \"verticalAlign\": \"middle\",\n      \"position\": \"absolute\",\n      \"top\": \"0\",\n      \"left\": \"0\"\n    },\n    \"loading\": \"lazy\"\n  })), \"\\n  \"), \"\\n    \")), mdx(\"p\", null, \"The code we write gets submitted to Spark either through console or via a submitted job\"), mdx(\"ul\", null, mdx(\"li\", {\n    parentName: \"ul\"\n  }, \"This code passes through the Catalyst Optimizer, which decides how the code should be executed and lays out a plan for doing so before, finally, the code is run and the result is returned to the user\")), mdx(\"h1\", null, \"Logical Planning\"), mdx(\"p\", null, \"The first phase takes user code and converts it into a logical plan (optimized version of the user's set of expressions)\\nIt does this by converting user code into an unresolved logical plan. The plan is unresolved because although your code might be valid, the tables and columns that it refers to might or might not exist. Spark uses the catalog, a repository of all table and DataFrame information to resolve columns and tables in the analyzer. The analyzer might reject the unresolved logical plan if the required column name does not exist in the catalog. If the analyzer can resolve it, the result is passed through the Catalyst Optimizer, a collection of rules that attempt to optimize the logical plan by pushing down predicates or selections. Packages can extend the Catalyst to include their own rules for domain-specific optimizations.\\n\", mdx(\"span\", _extends({\n    parentName: \"p\"\n  }, {\n    \"className\": \"gatsby-resp-image-wrapper\",\n    \"style\": {\n      \"position\": \"relative\",\n      \"display\": \"block\",\n      \"marginLeft\": \"auto\",\n      \"marginRight\": \"auto\",\n      \"maxWidth\": \"1035px\"\n    }\n  }), \"\\n      \", mdx(\"a\", _extends({\n    parentName: \"span\"\n  }, {\n    \"className\": \"gatsby-resp-image-link\",\n    \"href\": \"/static/0cfd6ed9c463912038ce8667ea899723/f09ab/logical.png\",\n    \"style\": {\n      \"display\": \"block\"\n    },\n    \"target\": \"_blank\",\n    \"rel\": \"noopener\"\n  }), \"\\n    \", mdx(\"span\", _extends({\n    parentName: \"a\"\n  }, {\n    \"className\": \"gatsby-resp-image-background-image\",\n    \"style\": {\n      \"paddingBottom\": \"27.413127413127413%\",\n      \"position\": \"relative\",\n      \"bottom\": \"0\",\n      \"left\": \"0\",\n      \"backgroundImage\": \"url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAFCAIAAADKYVtkAAAACXBIWXMAAC4jAAAuIwF4pT92AAABAklEQVQY01WMSU+DQACF+fdGGy/Gi+nFxGhia7GGGGsXkVplqeloaKGEzcKABIIELqDDzFgupr680/cWJsuyOI7LsjRcX3eh7sAkSbewKHIYJSvb0xx/E0RhGAIAwjBooOVptm9vIKOq6lrXXiSldflwxMl754MnaW4Ya9sy29fjw97soCuc9keOZXo+dG2zzY72O3yr+3h8wTEQBl9pCoOwN5xygnI7e/2MkgDCIs+nylt/It6J70CzMEKormuEBBmwE3Eoq8+LJYMxJoTQrXFNCf75rvildAN4dj42PkxKG9akfyKYYtSYEIb+V1VWHeX+bDE4Ea6AtWrKZHe6c0LpL6ldBgXnT8QRAAAAAElFTkSuQmCC')\",\n      \"backgroundSize\": \"cover\",\n      \"display\": \"block\"\n    }\n  })), \"\\n  \", mdx(\"img\", _extends({\n    parentName: \"a\"\n  }, {\n    \"className\": \"gatsby-resp-image-image\",\n    \"alt\": \"logical-plan\",\n    \"title\": \"logical-plan\",\n    \"src\": \"/static/0cfd6ed9c463912038ce8667ea899723/e3189/logical.png\",\n    \"srcSet\": [\"/static/0cfd6ed9c463912038ce8667ea899723/a2ead/logical.png 259w\", \"/static/0cfd6ed9c463912038ce8667ea899723/6b9fd/logical.png 518w\", \"/static/0cfd6ed9c463912038ce8667ea899723/e3189/logical.png 1035w\", \"/static/0cfd6ed9c463912038ce8667ea899723/f09ab/logical.png 1250w\"],\n    \"sizes\": \"(max-width: 1035px) 100vw, 1035px\",\n    \"style\": {\n      \"width\": \"100%\",\n      \"height\": \"100%\",\n      \"margin\": \"0\",\n      \"verticalAlign\": \"middle\",\n      \"position\": \"absolute\",\n      \"top\": \"0\",\n      \"left\": \"0\"\n    },\n    \"loading\": \"lazy\"\n  })), \"\\n  \"), \"\\n    \")), mdx(\"h1\", null, \"Physical Planning\"), mdx(\"p\", null, \"After creating the optimized logical plan, Spark begins the physical planning process. The physical plan - often called Spark plan - specifies how the logical plan will execute on the cluster by generating different physical execution strategies and comparing them through a cost model. Upon selecting a physical plan Spark runs all of this code over RDDs.\\n\", mdx(\"span\", _extends({\n    parentName: \"p\"\n  }, {\n    \"className\": \"gatsby-resp-image-wrapper\",\n    \"style\": {\n      \"position\": \"relative\",\n      \"display\": \"block\",\n      \"marginLeft\": \"auto\",\n      \"marginRight\": \"auto\",\n      \"maxWidth\": \"1035px\"\n    }\n  }), \"\\n      \", mdx(\"a\", _extends({\n    parentName: \"span\"\n  }, {\n    \"className\": \"gatsby-resp-image-link\",\n    \"href\": \"/static/abb6c12f8d9da196a56ddae36e4ce616/f0811/physical.png\",\n    \"style\": {\n      \"display\": \"block\"\n    },\n    \"target\": \"_blank\",\n    \"rel\": \"noopener\"\n  }), \"\\n    \", mdx(\"span\", _extends({\n    parentName: \"a\"\n  }, {\n    \"className\": \"gatsby-resp-image-background-image\",\n    \"style\": {\n      \"paddingBottom\": \"32.818532818532816%\",\n      \"position\": \"relative\",\n      \"bottom\": \"0\",\n      \"left\": \"0\",\n      \"backgroundImage\": \"url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAHCAIAAACHqfpvAAAACXBIWXMAAC4jAAAuIwF4pT92AAABV0lEQVQY021Qy07CUBTsF/hPLv0U/8C4cGHiJxgXBhcQFyAq4iMxBpVKG0KtpaUPWh69ldK0oQ+QtrS3DyySsJHJyVmcmUzODBIEQZIkrjtn2pRh6MsV0uU2pOnq7jgOAEAdjWxzggg8D4Ds+osmDySgZpoYRnEUJXGc7f8WnudZpjUEyic/QAhGcGybYoWjElZ8wQ1dAyxHlsrZyCyXqcMIwjhawCCE4cZCHIAqxiD1JvmBovgXv3vydnbf6gmdiWlx1SpWuDRNU9HVK6Z2/louEE8P5Ls7mzLDcYMSulK/RvWQFtfHMBylqJ3Dg+Oba5GmfRhayrfM8SGEotzPobcXjUoOvyvWH39suy0pdaIjiBJK95COak9nPsGRe/n90+f8ZGwkaTJ3Xc/3s/ey4FqWxNDHumba1qa27gBUMBZZZ7CmTo3EaYFb/nFrxdbC15TnL4Yj7Rc6dXQNK5J/HQAAAABJRU5ErkJggg==')\",\n      \"backgroundSize\": \"cover\",\n      \"display\": \"block\"\n    }\n  })), \"\\n  \", mdx(\"img\", _extends({\n    parentName: \"a\"\n  }, {\n    \"className\": \"gatsby-resp-image-image\",\n    \"alt\": \"physical-plan\",\n    \"title\": \"physical-plan\",\n    \"src\": \"/static/abb6c12f8d9da196a56ddae36e4ce616/e3189/physical.png\",\n    \"srcSet\": [\"/static/abb6c12f8d9da196a56ddae36e4ce616/a2ead/physical.png 259w\", \"/static/abb6c12f8d9da196a56ddae36e4ce616/6b9fd/physical.png 518w\", \"/static/abb6c12f8d9da196a56ddae36e4ce616/e3189/physical.png 1035w\", \"/static/abb6c12f8d9da196a56ddae36e4ce616/f0811/physical.png 1367w\"],\n    \"sizes\": \"(max-width: 1035px) 100vw, 1035px\",\n    \"style\": {\n      \"width\": \"100%\",\n      \"height\": \"100%\",\n      \"margin\": \"0\",\n      \"verticalAlign\": \"middle\",\n      \"position\": \"absolute\",\n      \"top\": \"0\",\n      \"left\": \"0\"\n    },\n    \"loading\": \"lazy\"\n  })), \"\\n  \"), \"\\n    \"))), mdx(\"hr\", null), mdx(\"h1\", null, \"Sourcers/Credits:\"));\n}\n;\nMDXContent.isMDXComponent = true;","tableOfContents":{"items":[{"url":"#apache-spark-dataframe-api-sql-and-internals---summary--resources","title":"Apache Spark DataFrame API, SQL and Internals - Summary & Resources"},{"url":"#recap-video-job-stage-task-shuffle","title":"Recap video (Job, Stage, Task, Shuffle):"},{"url":"#deep-dive-into-spark-sqls-catalyst-optimizer","title":"Deep Dive into Spark SQLâ€™s Catalyst Optimizer:"},{"url":"#spark-sql-built-in-functions","title":"Spark SQL, Built-in Functions:"},{"url":"#pyspark-sql-module","title":"PySpark SQL module"},{"url":"#pyspark-sql-column-class","title":"Pyspark SQL Column Class"},{"url":"#databricks-notebooks-covered","title":"Databricks Notebooks covered:"},{"url":"#logical-planning","title":"Logical Planning"},{"url":"#physical-planning","title":"Physical Planning"},{"url":"#sourcerscredits","title":"Sourcers/Credits:"}]},"parent":{"__typename":"File","relativePath":"spark-continued.md"},"frontmatter":{"metaTitle":"Week 7 - Apacke Spark Hands-on","metaDescription":"Week 7 - Apacke Spark Hands-on"}},"allMdx":{"edges":[{"node":{"fields":{"slug":"/internet","title":"Week 1- Internet"}}},{"node":{"fields":{"slug":"/bigdatahistory","title":"Big Data History [Optional Reading]"}}},{"node":{"fields":{"slug":"/syllabus","title":"Welcome - Syllabus"}}},{"node":{"fields":{"slug":"/resources","title":"Resources/Help"}}},{"node":{"fields":{"slug":"/apachespark","title":"Week 4 - Apache Spark"}}},{"node":{"fields":{"slug":"/spark-continued","title":"Week 7 - Apacke Spark Hands-on"}}},{"node":{"fields":{"slug":"/serverless","title":"Week 3 - Serverless"}}},{"node":{"fields":{"slug":"/sparkinternals","title":"Week 5 - Spark Internals"}}},{"node":{"fields":{"slug":"/sparkAPI","title":"Week 6 - Apache Spark APIs"}}},{"node":{"fields":{"slug":"/sparkinternals/1-sparkinternals","title":"Class Resources"}}},{"node":{"fields":{"slug":"/sparkinternals/3-sparkinternals","title":"Homework"}}},{"node":{"fields":{"slug":"/sparkinternals/2-sparkinternals","title":"Lecture Video"}}},{"node":{"fields":{"slug":"/sparkAPI/2-sparkAPI","title":"Lecture Video"}}},{"node":{"fields":{"slug":"/sparkAPI/3-sparkAPI","title":"Homework"}}},{"node":{"fields":{"slug":"/sparkAPI/1-sparkAPI","title":"Class Resources"}}},{"node":{"fields":{"slug":"/spark-continued/3-spark-continued","title":"Homework"}}},{"node":{"fields":{"slug":"/spark-continued/2-spark-continued","title":"Lecture Video"}}},{"node":{"fields":{"slug":"/spark-continued/1-spark-continued","title":"Class Resources"}}},{"node":{"fields":{"slug":"/serverless/1-serverless","title":"Class Resources"}}},{"node":{"fields":{"slug":"/serverless/2-serverless","title":"Lecture Video"}}},{"node":{"fields":{"slug":"/internet/1-internet","title":"Class Resources"}}},{"node":{"fields":{"slug":"/serverless/3-serverless","title":"Homework"}}},{"node":{"fields":{"slug":"/internet/3-internet","title":"Homework"}}},{"node":{"fields":{"slug":"/internet/2-internet","title":"Lecture Video"}}},{"node":{"fields":{"slug":"/aws/1-aws","title":"Class Resources"}}},{"node":{"fields":{"slug":"/aws/2-aws","title":"Lecture Video"}}},{"node":{"fields":{"slug":"/aws/3-homework","title":"Homework"}}},{"node":{"fields":{"slug":"/apachespark/1-apachespark","title":"Class Resources"}}},{"node":{"fields":{"slug":"/apachespark/2-apachespark","title":"Lecture Video"}}},{"node":{"fields":{"slug":"/apachespark/3-apachespark","title":"Homework"}}},{"node":{"fields":{"slug":"/aws","title":"Week 2 - AWS"}}},{"node":{"fields":{"slug":"/","title":"Data Engineering 3 - Big Data and Cloud Computing"}}}]}},"pageContext":{"id":"8e4a2f8d-345e-5f58-9a89-e8c0fd4991f0"}},"staticQueryHashes":["2619113677","2619113677","3706406642","3706406642","417421954","417421954"]}