{"componentChunkName":"component---src-templates-docs-js","path":"/sparkinternals","result":{"data":{"site":{"siteMetadata":{"title":"Data Engineering at Central European University","docsLocation":"https://github.com/zoltanctoth/ceu-cloud-bigdata-course/tree/master"}},"mdx":{"fields":{"id":"9d0679ce-c646-50aa-baa7-eef4a456304b","title":"Week 5 - Spark Internals","slug":"/sparkinternals"},"body":"function _extends() { _extends = Object.assign || function (target) { for (var i = 1; i < arguments.length; i++) { var source = arguments[i]; for (var key in source) { if (Object.prototype.hasOwnProperty.call(source, key)) { target[key] = source[key]; } } } return target; }; return _extends.apply(this, arguments); }\n\nfunction _objectWithoutProperties(source, excluded) { if (source == null) return {}; var target = _objectWithoutPropertiesLoose(source, excluded); var key, i; if (Object.getOwnPropertySymbols) { var sourceSymbolKeys = Object.getOwnPropertySymbols(source); for (i = 0; i < sourceSymbolKeys.length; i++) { key = sourceSymbolKeys[i]; if (excluded.indexOf(key) >= 0) continue; if (!Object.prototype.propertyIsEnumerable.call(source, key)) continue; target[key] = source[key]; } } return target; }\n\nfunction _objectWithoutPropertiesLoose(source, excluded) { if (source == null) return {}; var target = {}; var sourceKeys = Object.keys(source); var key, i; for (i = 0; i < sourceKeys.length; i++) { key = sourceKeys[i]; if (excluded.indexOf(key) >= 0) continue; target[key] = source[key]; } return target; }\n\n/* @jsxRuntime classic */\n\n/* @jsx mdx */\nvar _frontmatter = {\n  \"title\": \"Week 5 - Spark Internals\",\n  \"metaTitle\": \"Week 5 - Spark Internals\",\n  \"metaDescription\": \"Week 5 - Spark Internals\"\n};\nvar layoutProps = {\n  _frontmatter: _frontmatter\n};\nvar MDXLayout = \"wrapper\";\nreturn function MDXContent(_ref) {\n  var components = _ref.components,\n      props = _objectWithoutProperties(_ref, [\"components\"]);\n\n  return mdx(MDXLayout, _extends({}, layoutProps, props, {\n    components: components,\n    mdxType: \"MDXLayout\"\n  }), mdx(\"h1\", null, \"Spark Internals\"), mdx(\"h1\", null, \"Introduction\"), mdx(\"p\", null, \"Spark is a generalized framework for distributed data processing providing functional API for manipulating data at scale, in-memory data caching and reuse across computations. It applies set of coarse-grained transformations over partitioned data and relies on dataset's lineage to recompute tasks in case of failures. Worth mentioning is that Spark supports majority of data formats, has integrations with various storage systems and can be executed on Mesos or YARN. \"), mdx(\"p\", null, mdx(\"em\", {\n    parentName: \"p\"\n  }, \"Powerful and concise API in conjunction with rich library makes it easier to perform data operations at scale. E.g. performing backup and restore of Cassandra column families in Parquet format:\")), mdx(\"pre\", null, mdx(\"code\", _extends({\n    parentName: \"pre\"\n  }, {}), \"def backup(path: String, config: Config) {  \\n  sc.cassandraTable(config.keyspace, config.table)\\n    .map(_.toEvent).toDF()\\n    .write.parquet(path)\\n}\\n\\ndef restore(path: String, config: Config) {  \\n  sqlContext.read.parquet(path)\\n  .map(_.toEvent)\\n  .saveToCassandra(config.keyspace, config.table)\\n}\\n\")), mdx(\"p\", null, mdx(\"em\", {\n    parentName: \"p\"\n  }, \"Or run discrepancies analysis comparing the data in different data stores:\")), mdx(\"pre\", null, mdx(\"code\", _extends({\n    parentName: \"pre\"\n  }, {}), \"sqlContext.sql {  \\n  \\\"\\\"\\\"\\n     SELECT count()\\n     FROM cassandra_event_rollups\\n     JOIN mongo_event_rollups\\n     ON cassandra_event_rollups.uuid = cassandra_event_rollups.uuid\\n     WHERE cassandra_event_rollups.value != cassandra_event_rollups.value\\n  \\\"\\\"\\\".stripMargin\\n}\\n\")), mdx(\"p\", null, \"Spark is built around the concepts of Resilient Distributed Datasets and Direct Acyclic Graph representing transformations and dependencies between them.\"), mdx(\"p\", null, mdx(\"span\", _extends({\n    parentName: \"p\"\n  }, {\n    \"className\": \"gatsby-resp-image-wrapper\",\n    \"style\": {\n      \"position\": \"relative\",\n      \"display\": \"block\",\n      \"marginLeft\": \"auto\",\n      \"marginRight\": \"auto\",\n      \"maxWidth\": \"1035px\"\n    }\n  }), \"\\n      \", mdx(\"a\", _extends({\n    parentName: \"span\"\n  }, {\n    \"className\": \"gatsby-resp-image-link\",\n    \"href\": \"/courseware/static/58a42182058c5bf608ca01f93f2701ef/cd536/internal1.png\",\n    \"style\": {\n      \"display\": \"block\"\n    },\n    \"target\": \"_blank\",\n    \"rel\": \"noopener\"\n  }), \"\\n    \", mdx(\"span\", _extends({\n    parentName: \"a\"\n  }, {\n    \"className\": \"gatsby-resp-image-background-image\",\n    \"style\": {\n      \"paddingBottom\": \"30.888030888030887%\",\n      \"position\": \"relative\",\n      \"bottom\": \"0\",\n      \"left\": \"0\",\n      \"backgroundImage\": \"url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAGCAYAAADDl76dAAAACXBIWXMAAAsSAAALEgHS3X78AAABwklEQVQY04WQz2vTcBjGv4KCrsIET/4DPXpeQVA8lXnw4mEUdQcdgj8ognrwKghDexEvHhWZuykMnA7XbuvWrWlqQtY0SZN03/a7tE1/xKY1sbbOx1T0vBee93kPDx8eXhKLxSai0ejJSCQyeWl6OhS//+A4IeRooBOBQuSQAfD/PPJ3h8PhMeBYoMl/Tr58tc5yZv/uulSf21Ta9z4kxccfM6VHK9m9258z5p2c5t58syxPvc/1Z8b5tIEp0cIN3vxxjSQSidOe54UopRPbvHhqHFgttuKaDxTqvyC0AeoCRrOFYs2D0TmAzLqD18vK/KsltcVp9nle1n2NtaE2DkAYY5+63W4jAJq23ew1G1Y8b/pXSwEorTuD3ao/2hDoiFNKo5UMN8yqCorVsv1icWP++YJo5FJPb/XFGTj8lZ+qqQyJ67rF4A8IgGPDwP/+JKv1ZhtDgGM+yh1Ab/6GXKliLS9B3KOQqdl7u1p+trDe3l+T8tfVmoQCE6HUPRCe58/Ztn1REIQLllWLKuLWmW25NStUPCelO5WgIZP3Byyvm0woO0yq9OoS/ba7mKIP36U7yWRBubxjFOiOIbOMVnv5B+3HNV7H/7uNAAAAAElFTkSuQmCC')\",\n      \"backgroundSize\": \"cover\",\n      \"display\": \"block\"\n    }\n  })), \"\\n  \", mdx(\"img\", _extends({\n    parentName: \"a\"\n  }, {\n    \"className\": \"gatsby-resp-image-image\",\n    \"alt\": \"internals2\",\n    \"title\": \"internals2\",\n    \"src\": \"/courseware/static/58a42182058c5bf608ca01f93f2701ef/e3189/internal1.png\",\n    \"srcSet\": [\"/courseware/static/58a42182058c5bf608ca01f93f2701ef/a2ead/internal1.png 259w\", \"/courseware/static/58a42182058c5bf608ca01f93f2701ef/6b9fd/internal1.png 518w\", \"/courseware/static/58a42182058c5bf608ca01f93f2701ef/e3189/internal1.png 1035w\", \"/courseware/static/58a42182058c5bf608ca01f93f2701ef/cd536/internal1.png 1114w\"],\n    \"sizes\": \"(max-width: 1035px) 100vw, 1035px\",\n    \"style\": {\n      \"width\": \"100%\",\n      \"height\": \"100%\",\n      \"margin\": \"0\",\n      \"verticalAlign\": \"middle\",\n      \"position\": \"absolute\",\n      \"top\": \"0\",\n      \"left\": \"0\"\n    },\n    \"loading\": \"lazy\"\n  })), \"\\n  \"), \"\\n    \")), mdx(\"p\", null, \"Spark Application (often referred to as Driver Program or Application Master) at high level consists of SparkContext and user code which interacts with it creating RDDs and performing series of transformations to achieve final result. These transformations of RDDs are then translated into DAG and submitted to Scheduler to be executed on set of worker nodes.\"), mdx(\"h1\", null, \"RDD: Resilient Distributed Dataset\"), mdx(\"p\", null, \"RDD could be thought as an immutable parallel data structure with failure recovery possibilities. It provides API for various transformations and materializations of data as well as for control over caching and partitioning of elements to optimize data placement. RDD can be created either from external storage or from another RDD and stores information about its parents to optimize execution (via pipelining of operations) and recompute partition in case of failure.\"), mdx(\"p\", null, \"From a developer's point of view RDD represents distributed immutable data (partitioned data + iterator) and lazily evaluated operations (transformations). As an interface RDD defines five main properties:\"), mdx(\"pre\", null, mdx(\"code\", _extends({\n    parentName: \"pre\"\n  }, {}), \"//a list of partitions (e.g. splits in Hadoop)\\ndef getPartitions: Array[Partition]\\n\\n//a list of dependencies on other RDDs\\ndef getDependencies: Seq[Dependency[_]]\\n\\n//a function for computing each split\\ndef compute(split: Partition, context: TaskContext): Iterator[T]\\n\\n//(optional) a list of preferred locations to compute each split on\\ndef getPreferredLocations(split: Partition): Seq[String] = Nil\\n\\n//(optional) a partitioner for key-value RDDs\\nval partitioner: Option[Partitioner] = None  \\n\")), mdx(\"p\", null, \"Here's an example of RDDs created during a call of method sparkContext.textFile(\\\"hdfs://...\\\") which first loads HDFS blocks in memory and then applies map() function to filter out keys creating two RDDs:\"), mdx(\"p\", null, mdx(\"span\", _extends({\n    parentName: \"p\"\n  }, {\n    \"className\": \"gatsby-resp-image-wrapper\",\n    \"style\": {\n      \"position\": \"relative\",\n      \"display\": \"block\",\n      \"marginLeft\": \"auto\",\n      \"marginRight\": \"auto\",\n      \"maxWidth\": \"380px\"\n    }\n  }), \"\\n      \", mdx(\"a\", _extends({\n    parentName: \"span\"\n  }, {\n    \"className\": \"gatsby-resp-image-link\",\n    \"href\": \"/courseware/static/50deb78b82b57093a9d70422443f0cb4/3f520/internal2.png\",\n    \"style\": {\n      \"display\": \"block\"\n    },\n    \"target\": \"_blank\",\n    \"rel\": \"noopener\"\n  }), \"\\n    \", mdx(\"span\", _extends({\n    parentName: \"a\"\n  }, {\n    \"className\": \"gatsby-resp-image-background-image\",\n    \"style\": {\n      \"paddingBottom\": \"57.14285714285714%\",\n      \"position\": \"relative\",\n      \"bottom\": \"0\",\n      \"left\": \"0\",\n      \"backgroundImage\": \"url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAALCAYAAAB/Ca1DAAAACXBIWXMAAAsSAAALEgHS3X78AAAC6klEQVQoz2WSa0iTURjHp5Zt2racps6ZUwsqIyVcTojESyqZBeEHI2QomBJ+KMEVkX4wK/2SH1IJTZNk0ru85CXFzDQkdblbm8b03Zw43XydUu7W0hVP550LRh348xx+B/7nuVEoFAodKQYpCslPsw0UrxOCxEYKRzoaQGdSPXy/j6/fMRS5nrcwpJNIwZS7FbeP1z8UXnpQWXH+THL6AW+3RD6fkVNyPyXjRnUmP/vqib88TSB0f5Z1vTQuu6wuI7NQmOS/zyfSnZxGt9o5rLTB9JzRUCLIS0QwiUqlpaDIS8q5liPXL5ptLgJ6JMoaxHwC6fR0BpNxinTEPk69tP5cA9mylmgGCHT/JlXrxI8xHERDis1qYfFpMu2g4BAOiozEXEG6RDnhhF0NiEbHmhDzj+RGcTicMLLMgNaergFwfAElrrDffAfBbsNlgwnDtwCWjBZiTTMV5l1yq8QYJzNt2My/7TC8YKyj/HNGtesiYtcCn/QrlqqhNZYbTitwrKJFDU3i6c1bxXk8ssF0JpNsdgiXl5E183nIAa55aHvT+wwxJjuCzQ0NZZEDZDW0twzCDxnMa2XW4gnYM1xZNWEGC8AKYSMInTTUO4NO1bc46fqW3eRywAhO/JfhB/2maG3HBpNLBkvNyOqe4axahz3CtNDxVmGuLC+MR+gQK+QwuSr0+Kz8VIli3AG/cOgYHmlEjBodG8PmcMLJHgY2i1/1g1MNKp3SWjrmyVCjM2Bjc3aYVhk2XjTUxCLkm8DjuydWUtt2VqJdsFtcZuiWqJ6Q7MLlK4H8c/wA8t4zIxd/dxphRodb7r237Rl+xQ1Yv8wOk8rVjb6O+miSJaek0chYUNXIk2rnHbtAQJ9U7TbMLyqiXczNdi/468mZLqfLADL9orV8xOkpWYVjtZgGOgZmzXfKChLIZqO1iSAHwMsVpE7Jx+0u+xy0Dw49RYx2JJobwWaHki05+Ly7q3fHIgfZgmy7bAKCSL8/kuReOHgS7dcAAAAASUVORK5CYII=')\",\n      \"backgroundSize\": \"cover\",\n      \"display\": \"block\"\n    }\n  })), \"\\n  \", mdx(\"img\", _extends({\n    parentName: \"a\"\n  }, {\n    \"className\": \"gatsby-resp-image-image\",\n    \"alt\": \"internals2\",\n    \"title\": \"internals2\",\n    \"src\": \"/courseware/static/50deb78b82b57093a9d70422443f0cb4/3f520/internal2.png\",\n    \"srcSet\": [\"/courseware/static/50deb78b82b57093a9d70422443f0cb4/a2ead/internal2.png 259w\", \"/courseware/static/50deb78b82b57093a9d70422443f0cb4/3f520/internal2.png 380w\"],\n    \"sizes\": \"(max-width: 380px) 100vw, 380px\",\n    \"style\": {\n      \"width\": \"100%\",\n      \"height\": \"100%\",\n      \"margin\": \"0\",\n      \"verticalAlign\": \"middle\",\n      \"position\": \"absolute\",\n      \"top\": \"0\",\n      \"left\": \"0\"\n    },\n    \"loading\": \"lazy\"\n  })), \"\\n  \"), \"\\n    \")), mdx(\"ul\", null, mdx(\"li\", {\n    parentName: \"ul\"\n  }, \"HadoopRDD:\", mdx(\"ul\", {\n    parentName: \"li\"\n  }, mdx(\"li\", {\n    parentName: \"ul\"\n  }, \"getPartitions = HDFS blocks\"), mdx(\"li\", {\n    parentName: \"ul\"\n  }, \"getDependencies = None\"), mdx(\"li\", {\n    parentName: \"ul\"\n  }, \"compute = load block in memory\"), mdx(\"li\", {\n    parentName: \"ul\"\n  }, \"getPrefferedLocations = HDFS block locations\"), mdx(\"li\", {\n    parentName: \"ul\"\n  }, \"partitioner = None\"))), mdx(\"li\", {\n    parentName: \"ul\"\n  }, \"MapPartitionsRDD\", mdx(\"ul\", {\n    parentName: \"li\"\n  }, mdx(\"li\", {\n    parentName: \"ul\"\n  }, \"getPartitions = same as parent\"), mdx(\"li\", {\n    parentName: \"ul\"\n  }, \"getDependencies = parent RDD\"), mdx(\"li\", {\n    parentName: \"ul\"\n  }, \"compute = compute parent and apply map()\"), mdx(\"li\", {\n    parentName: \"ul\"\n  }, \"getPrefferedLocations = same as parent\"), mdx(\"li\", {\n    parentName: \"ul\"\n  }, \"partitioner = None\", \"  RDD Operations\\nOperations on RDDs are divided into several groups:\")))), mdx(\"h1\", null, \"Transformations\"), mdx(\"ul\", null, mdx(\"li\", {\n    parentName: \"ul\"\n  }, \"apply user function to every element in a partition (or to the whole partition) \"), mdx(\"li\", {\n    parentName: \"ul\"\n  }, \"apply aggregation function to the whole dataset (groupBy, sortBy)\"), mdx(\"li\", {\n    parentName: \"ul\"\n  }, \"introduce dependencies between RDDs to form DAG\"), mdx(\"li\", {\n    parentName: \"ul\"\n  }, \"provide functionality for repartitioning (repartition, partitionBy)\")), mdx(\"h1\", null, \"Actions\"), mdx(\"ul\", null, mdx(\"li\", {\n    parentName: \"ul\"\n  }, \"trigger job execution\"), mdx(\"li\", {\n    parentName: \"ul\"\n  }, \"used to materialize computation results\")), mdx(\"h1\", null, \"Extra: persistence\"), mdx(\"ul\", null, mdx(\"li\", {\n    parentName: \"ul\"\n  }, \"explicitly store RDDs in memory, on disk or off-heap (cache, persist)\"), mdx(\"li\", {\n    parentName: \"ul\"\n  }, \"checkpointing for truncating RDD lineage\"), mdx(\"li\", {\n    parentName: \"ul\"\n  }, \"Here's a code sample of some job which aggregates data from Cassandra in lambda style combining previously rolled-up data with the data from raw storage and demonstrates some of the transformations and actions available on RDDs:\")), mdx(\"pre\", null, mdx(\"code\", _extends({\n    parentName: \"pre\"\n  }, {}), \"//aggregate events after specific date for given campaign\\nval events =  \\n    sc.cassandraTable(\\\"demo\\\", \\\"event\\\")\\n      .map(_.toEvent)                                \\n      .filter { e =>\\n        e.campaignId == campaignId && e.time.isAfter(watermark)\\n      }\\n      .keyBy(_.eventType)\\n      .reduceByKey(_ + _)                                        \\n      .cache()                                            \\n\")), mdx(\"pre\", null, mdx(\"code\", _extends({\n    parentName: \"pre\"\n  }, {}), \"//aggregate campaigns by type\\nval campaigns =  \\n    sc.cassandraTable(\\\"demo\\\", \\\"campaign\\\")\\n      .map(_.toCampaign)\\n      .filter { c => \\n         c.id == campaignId && c.time.isBefore(watermark)\\n      }\\n      .keyBy(_.eventType)\\n      .reduceByKey(_ + _)\\n      .cache()\\n\")), mdx(\"pre\", null, mdx(\"code\", _extends({\n    parentName: \"pre\"\n  }, {}), \"//joined rollups and raw events\\nval joinedTotals = campaigns.join(events)  \\n           .map { case (key, (campaign, event)) => \\n             CampaignTotals(campaign, event) \\n            }\\n           .collect()\\n\")), mdx(\"pre\", null, mdx(\"code\", _extends({\n    parentName: \"pre\"\n  }, {}), \"//count totals separately\\nval eventTotals =  \\n    events.map{ case (t, e) => s\\\"$t -> ${e.value}\\\" }\\n    .collect()\\n\")), mdx(\"pre\", null, mdx(\"code\", _extends({\n    parentName: \"pre\"\n  }, {}), \"val campaignTotals =  \\n    campaigns.map{ case (t, e) => s\\\"$t -> ${e.value}\\\" }\\n    .collect()\\n\")), mdx(\"p\", null, mdx(\"span\", _extends({\n    parentName: \"p\"\n  }, {\n    \"className\": \"gatsby-resp-image-wrapper\",\n    \"style\": {\n      \"position\": \"relative\",\n      \"display\": \"block\",\n      \"marginLeft\": \"auto\",\n      \"marginRight\": \"auto\",\n      \"maxWidth\": \"899px\"\n    }\n  }), \"\\n      \", mdx(\"a\", _extends({\n    parentName: \"span\"\n  }, {\n    \"className\": \"gatsby-resp-image-link\",\n    \"href\": \"/courseware/static/d97e91a3d9a1bc8aaf423e4038ee27cc/681f1/internal3.png\",\n    \"style\": {\n      \"display\": \"block\"\n    },\n    \"target\": \"_blank\",\n    \"rel\": \"noopener\"\n  }), \"\\n    \", mdx(\"span\", _extends({\n    parentName: \"a\"\n  }, {\n    \"className\": \"gatsby-resp-image-background-image\",\n    \"style\": {\n      \"paddingBottom\": \"27.7992277992278%\",\n      \"position\": \"relative\",\n      \"bottom\": \"0\",\n      \"left\": \"0\",\n      \"backgroundImage\": \"url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAGCAYAAADDl76dAAAACXBIWXMAAAsSAAALEgHS3X78AAABsUlEQVQY02PgFRDkZWPnEGPAAKyCQEIEiIXQJHiBWBQkzsTEzIokzg/EXAwbr72o2XDlmfu6i4+v7bj73hAkc/bO5e07ThyxWn78qsiyAyck1x0/p/jv/38mkNy6U5/Y52y9KTF/x11BmEnrD98X3nX2udyuM89lGKZvO2bVtXyr/srTd71aZi8R8q9eKHD94ZVfvTOnJhw6c/DEnosXF155eP3BxMUrNEGa522/FTJxxcn/U9acOwAz8NqDdysePH37/8bdp98YNl1/2bD5+quDMGdLKGlpXLh1ttw/IsJ+95EdN/ZeurTw2uMb9zPLqqyB8mJN07dmLd3/9P/EFaeuAvkgV0peu/dq8+evP/4/ffHmP8PKM3dNV5y+47v4yFV2kIkNO57y3Xh87VnLhN7Yfcd2Xd19/tyKy/cvvdpz6boiSH7FoRch609//r/yyJv9MBdevvNq/skzl76fv3zzOcPW228bd9z9sHPyxgOgwGZo2fOS5+Ldi+c37t/puv/iOc3t5y5oHrt+2XLh9r0cIPk1x9/yLD/0UmPF4VeyMAPXHXspvPHUO7nVR57LAAAHw9l3UHM+NgAAAABJRU5ErkJggg==')\",\n      \"backgroundSize\": \"cover\",\n      \"display\": \"block\"\n    }\n  })), \"\\n  \", mdx(\"img\", _extends({\n    parentName: \"a\"\n  }, {\n    \"className\": \"gatsby-resp-image-image\",\n    \"alt\": \"internals3\",\n    \"title\": \"internals3\",\n    \"src\": \"/courseware/static/d97e91a3d9a1bc8aaf423e4038ee27cc/681f1/internal3.png\",\n    \"srcSet\": [\"/courseware/static/d97e91a3d9a1bc8aaf423e4038ee27cc/a2ead/internal3.png 259w\", \"/courseware/static/d97e91a3d9a1bc8aaf423e4038ee27cc/6b9fd/internal3.png 518w\", \"/courseware/static/d97e91a3d9a1bc8aaf423e4038ee27cc/681f1/internal3.png 899w\"],\n    \"sizes\": \"(max-width: 899px) 100vw, 899px\",\n    \"style\": {\n      \"width\": \"100%\",\n      \"height\": \"100%\",\n      \"margin\": \"0\",\n      \"verticalAlign\": \"middle\",\n      \"position\": \"absolute\",\n      \"top\": \"0\",\n      \"left\": \"0\"\n    },\n    \"loading\": \"lazy\"\n  })), \"\\n  \"), \"\\n    \")), mdx(\"p\", null, \"Here's a quick recap on the execution workflow before digging deeper into details: user code containing RDD transformations forms Direct Acyclic Graph which is then split into stages of tasks by DAGScheduler. Stages combine tasks which don\\u2019t require shuffling/repartitioning if the data. Tasks run on workers and results then return to client.\"), mdx(\"p\", null, mdx(\"span\", _extends({\n    parentName: \"p\"\n  }, {\n    \"className\": \"gatsby-resp-image-wrapper\",\n    \"style\": {\n      \"position\": \"relative\",\n      \"display\": \"block\",\n      \"marginLeft\": \"auto\",\n      \"marginRight\": \"auto\",\n      \"maxWidth\": \"1024px\"\n    }\n  }), \"\\n      \", mdx(\"a\", _extends({\n    parentName: \"span\"\n  }, {\n    \"className\": \"gatsby-resp-image-link\",\n    \"href\": \"/courseware/static/57227902ccfb1ab66de27f4446c632f2/2bef9/internal4.png\",\n    \"style\": {\n      \"display\": \"block\"\n    },\n    \"target\": \"_blank\",\n    \"rel\": \"noopener\"\n  }), \"\\n    \", mdx(\"span\", _extends({\n    parentName: \"a\"\n  }, {\n    \"className\": \"gatsby-resp-image-background-image\",\n    \"style\": {\n      \"paddingBottom\": \"42.857142857142854%\",\n      \"position\": \"relative\",\n      \"bottom\": \"0\",\n      \"left\": \"0\",\n      \"backgroundImage\": \"url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAJCAYAAAAywQxIAAAACXBIWXMAAAsSAAALEgHS3X78AAACe0lEQVQoz2PIyqtQmrpssdbMFctsGICgbcoUrfnrVjuA2DMXNLku3zhFHsT+//8/kGRkCEvNZOicPpXROzyGoaynn7GyfxJImqGibyKYZpi0YJ/PobP7Gk5dPbkBxN9+eFfZqctHjgCZLEf21V44daI7FWSShCADHwMOUN7SzRARHsbQ0NDAwDB31TH3I5eOVp26dnYVSHL/2WN5h88dOgxkSuzf03z2yNEJySDxkKRkKSDFpGNmy+IemSysbmjB5OAfLubgH8EG8wEQMzL0z9kWvOfEnq6jF0/sAUls3r+j7sj5w5eATPZ9uxsfnjzRk1TQulTu2MWjh9mFZIVTi0q0gL7ZG5aYqrj5wrkd68+cdoI6lAVMzlq4WX7Dob2GG/bvcQPx1x3Yp71h/y5/EHvj9kkhLW0JKj2zZlsBffCQV1ZXoKKjS+vcrQt347MLVHbfvHFtwf4Dnnt2bU84f/Pc1VsPbi5gqGycYrl254agbYf3FIC8NGfFYv99pw5WgMNze2vz2jUV5u3T5pqevHrqOZ+srmBpS5vO2ZvnHgENVN11/dqtJYcO++zcttn74u0Lq27cu97IMHvlcd+jFw+3nb5+dhfIkL2nDlUdv3gE5GX+g3sbHpw+2Z2UWLlE8vil46t4lKzYW6fPkjl9/cyS/Npmse1XLs/ddP6cJUoMAQ10P3b5aBXQQHCkHDh3LO8IJFJEDuxpOHfsWF8yAwFw9c5lpoef7zF9+/+FiaFn9g6fA6d21R+/dGwdSHLrgW0lpy4dPgBiH95bc+b82b5EEPvyqV4WQRl1BhkxboaPx5sZ1NRUGdZv72fYuH8R2ND9B/YybNmyhQEAiCgpwhiwAzcAAAAASUVORK5CYII=')\",\n      \"backgroundSize\": \"cover\",\n      \"display\": \"block\"\n    }\n  })), \"\\n  \", mdx(\"img\", _extends({\n    parentName: \"a\"\n  }, {\n    \"className\": \"gatsby-resp-image-image\",\n    \"alt\": \"internals4\",\n    \"title\": \"internals4\",\n    \"src\": \"/courseware/static/57227902ccfb1ab66de27f4446c632f2/2bef9/internal4.png\",\n    \"srcSet\": [\"/courseware/static/57227902ccfb1ab66de27f4446c632f2/a2ead/internal4.png 259w\", \"/courseware/static/57227902ccfb1ab66de27f4446c632f2/6b9fd/internal4.png 518w\", \"/courseware/static/57227902ccfb1ab66de27f4446c632f2/2bef9/internal4.png 1024w\"],\n    \"sizes\": \"(max-width: 1024px) 100vw, 1024px\",\n    \"style\": {\n      \"width\": \"100%\",\n      \"height\": \"100%\",\n      \"margin\": \"0\",\n      \"verticalAlign\": \"middle\",\n      \"position\": \"absolute\",\n      \"top\": \"0\",\n      \"left\": \"0\"\n    },\n    \"loading\": \"lazy\"\n  })), \"\\n  \"), \"\\n    \")), mdx(\"p\", null, \"Here's a DAG for the code sample above. So basically any data processing workflow could be defined as reading the data source, applying set of transformations and materializing the result in different ways. Transformations create dependencies between RDDs and here we can see different types of them.\"), mdx(\"p\", null, \"The dependencies are usually classified as \\\"narrow\\\" and \\\"wide\\\":\\n\", mdx(\"span\", _extends({\n    parentName: \"p\"\n  }, {\n    \"className\": \"gatsby-resp-image-wrapper\",\n    \"style\": {\n      \"position\": \"relative\",\n      \"display\": \"block\",\n      \"marginLeft\": \"auto\",\n      \"marginRight\": \"auto\",\n      \"maxWidth\": \"430px\"\n    }\n  }), \"\\n      \", mdx(\"a\", _extends({\n    parentName: \"span\"\n  }, {\n    \"className\": \"gatsby-resp-image-link\",\n    \"href\": \"/courseware/static/19e50b90739321db1ddea3402f865545/05ed2/internal6.png\",\n    \"style\": {\n      \"display\": \"block\"\n    },\n    \"target\": \"_blank\",\n    \"rel\": \"noopener\"\n  }), \"\\n    \", mdx(\"span\", _extends({\n    parentName: \"a\"\n  }, {\n    \"className\": \"gatsby-resp-image-background-image\",\n    \"style\": {\n      \"paddingBottom\": \"154.05405405405406%\",\n      \"position\": \"relative\",\n      \"bottom\": \"0\",\n      \"left\": \"0\",\n      \"backgroundImage\": \"url('data:image/png;base64,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')\",\n      \"backgroundSize\": \"cover\",\n      \"display\": \"block\"\n    }\n  })), \"\\n  \", mdx(\"img\", _extends({\n    parentName: \"a\"\n  }, {\n    \"className\": \"gatsby-resp-image-image\",\n    \"alt\": \"internals6\",\n    \"title\": \"internals6\",\n    \"src\": \"/courseware/static/19e50b90739321db1ddea3402f865545/05ed2/internal6.png\",\n    \"srcSet\": [\"/courseware/static/19e50b90739321db1ddea3402f865545/a2ead/internal6.png 259w\", \"/courseware/static/19e50b90739321db1ddea3402f865545/05ed2/internal6.png 430w\"],\n    \"sizes\": \"(max-width: 430px) 100vw, 430px\",\n    \"style\": {\n      \"width\": \"100%\",\n      \"height\": \"100%\",\n      \"margin\": \"0\",\n      \"verticalAlign\": \"middle\",\n      \"position\": \"absolute\",\n      \"top\": \"0\",\n      \"left\": \"0\"\n    },\n    \"loading\": \"lazy\"\n  })), \"\\n  \"), \"\\n    \")), mdx(\"ul\", null, mdx(\"li\", {\n    parentName: \"ul\"\n  }, \"Narrow (pipelineable)\", mdx(\"ul\", {\n    parentName: \"li\"\n  }, mdx(\"li\", {\n    parentName: \"ul\"\n  }, \"each partition of the parent RDD is used by at most one partition of the child RDD\"), mdx(\"li\", {\n    parentName: \"ul\"\n  }, \"allow for pipelined execution on one cluster node\"), mdx(\"li\", {\n    parentName: \"ul\"\n  }, \"failure recovery is more efficient as only lost parent partitions need to be recomputed\"))), mdx(\"li\", {\n    parentName: \"ul\"\n  }, \"Wide (shuffle)\"), mdx(\"li\", {\n    parentName: \"ul\"\n  }, \"multiple child partitions may depend on one parent partition\"), mdx(\"li\", {\n    parentName: \"ul\"\n  }, \"require data from all parent partitions to be available and to be shuffled across the nodes\"), mdx(\"li\", {\n    parentName: \"ul\"\n  }, \"if some partition is lost from all the ancestors a complete recomputation is needed\")), mdx(\"h1\", null, \"Splitting DAG into Stages\"), mdx(\"p\", null, \"Spark stages are created by breaking the RDD graph at shuffle boundaries\\n\", mdx(\"span\", _extends({\n    parentName: \"p\"\n  }, {\n    \"className\": \"gatsby-resp-image-wrapper\",\n    \"style\": {\n      \"position\": \"relative\",\n      \"display\": \"block\",\n      \"marginLeft\": \"auto\",\n      \"marginRight\": \"auto\",\n      \"maxWidth\": \"865px\"\n    }\n  }), \"\\n      \", mdx(\"a\", _extends({\n    parentName: \"span\"\n  }, {\n    \"className\": \"gatsby-resp-image-link\",\n    \"href\": \"/courseware/static/d456a0f56faf8e4acd4c81afdb395ccd/79e48/internal7.png\",\n    \"style\": {\n      \"display\": \"block\"\n    },\n    \"target\": \"_blank\",\n    \"rel\": \"noopener\"\n  }), \"\\n    \", mdx(\"span\", _extends({\n    parentName: \"a\"\n  }, {\n    \"className\": \"gatsby-resp-image-background-image\",\n    \"style\": {\n      \"paddingBottom\": \"59.84555984555985%\",\n      \"position\": \"relative\",\n      \"bottom\": \"0\",\n      \"left\": \"0\",\n      \"backgroundImage\": \"url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAMCAYAAABiDJ37AAAACXBIWXMAAAsSAAALEgHS3X78AAADF0lEQVQoz41Ta0iTYRR+t2lqRVOzKU7NRM28pliMcAnZBQTpRyXhpX6ZKQpaFLpSQXTalve8tmIO0XRq0y01r7vknNu+uU/n/HQXVyli/QrDH4G8fa8Q/SnrwOE873nPe96H83AAAMCVdC9wsKH7wzR6AI2MTgc4DYjHdNzaYVuGV+XWSeWy6dXFRkfog6ENtsI4304WOHd0FJ6fUdY1B2TZnMkzxSfsHGpK/Ys7gSEFYRNOOuoiK5SBa9sOmNVFxDZPr6QuWBYgWeBXz0u/p9bU7Lnx4WlEVbwOqQ4IKQhrIQQbEFIhGeVkDqK8VLmiE48ZStnhwAO34t/K+LyQnkHRZYzAvpBvIouLU/NMWJWV8WQ7DJRBJviXSeRme/eokZ9wNYKxtrkKOQ2C8K7hgRTDqh4x9OdVZeYYtZW719L5dHDLwiySbST2aYkowIKHkrt/nBjGlpOCXkB6vepTjAw3RYP+Uc1T0aDiuncw02Nar25Iyy9iVjQ1Ro3PK2vRTFraHsYqVA3czEtxR9AMO1RW/YxpSQLAlusdkSVZZ1mGCdXmWKHeKlE5rJJfRF3+xB7C3ziIo/MEIXNB5Ecy3IIJUa7pdUf0og3fqS/NZciM+jaFw94PeqQfHj97Y7hxvGTVdwo3VrP5S6cKxGvxE7rZCqScUJAf8U7eXk7nwgjURK6dGTGsGXsR5ovE8Yv2xb0Sbi1Tii8IlR/tUjAkN1vaRtcbg8rmz5g37fBmu5nFHSEy9AS2rzK/OjNbq6neZRdOeqImExrFS/WipgFhTk1TDFlnzsrJ8xXPqXkzNmsrkKlW9G/HDaWJfsDdaMV3uDXc4N6B10l6wvAVqczh3M7Dsdp11t2XHmimnM5pt7yWkf0RXU27Ty0QTB0F7gwKp3XIpVw05YoY2kiVeawr0QziMwGL6gXhnZL+FIzYVzmwqjIj16jlfmc/0tHB/5j4PdbYJZ1Pj2H5H5sz6cQFFc+Zgr7uWNXCbA9aJYGg8IJaVSU8mz2NVpQSGh3n5ON/Em0LzfmQCy0wNNyJQqHSvJkBNE+Gj/NPuW1v2bvbY9QAAAAASUVORK5CYII=')\",\n      \"backgroundSize\": \"cover\",\n      \"display\": \"block\"\n    }\n  })), \"\\n  \", mdx(\"img\", _extends({\n    parentName: \"a\"\n  }, {\n    \"className\": \"gatsby-resp-image-image\",\n    \"alt\": \"internals7\",\n    \"title\": \"internals7\",\n    \"src\": \"/courseware/static/d456a0f56faf8e4acd4c81afdb395ccd/79e48/internal7.png\",\n    \"srcSet\": [\"/courseware/static/d456a0f56faf8e4acd4c81afdb395ccd/a2ead/internal7.png 259w\", \"/courseware/static/d456a0f56faf8e4acd4c81afdb395ccd/6b9fd/internal7.png 518w\", \"/courseware/static/d456a0f56faf8e4acd4c81afdb395ccd/79e48/internal7.png 865w\"],\n    \"sizes\": \"(max-width: 865px) 100vw, 865px\",\n    \"style\": {\n      \"width\": \"100%\",\n      \"height\": \"100%\",\n      \"margin\": \"0\",\n      \"verticalAlign\": \"middle\",\n      \"position\": \"absolute\",\n      \"top\": \"0\",\n      \"left\": \"0\"\n    },\n    \"loading\": \"lazy\"\n  })), \"\\n  \"), \"\\n    \")), mdx(\"ul\", null, mdx(\"li\", {\n    parentName: \"ul\"\n  }, \"RDD operations with \\\"narrow\\\" dependencies, like map() and filter(), are pipelined together into one set of tasks in each stage operations with shuffle dependencies require multiple stages (one to write a set of map output files, and another to read those files after a barrier).\"), mdx(\"li\", {\n    parentName: \"ul\"\n  }, \"In the end, every stage will have only shuffle dependencies on other stages, and may compute multiple operations inside it.    - The actual pipelining of these operations happens in the RDD.compute() functions of various RDDs\")), mdx(\"p\", null, \"There are two types of tasks in Spark: \", mdx(\"inlineCode\", {\n    parentName: \"p\"\n  }, \"ShuffleMapTask\"), \" which partitions its input for shuffle and \", mdx(\"inlineCode\", {\n    parentName: \"p\"\n  }, \"ResultTask\"), \" which sends its output to the driver. The same applies to types of stages: \", mdx(\"inlineCode\", {\n    parentName: \"p\"\n  }, \"ShuffleMapStage\"), \" and \", mdx(\"inlineCode\", {\n    parentName: \"p\"\n  }, \"ResultStage\"), \" correspondingly.\"), mdx(\"h1\", null, \"Shuffle\"), mdx(\"ul\", null, mdx(\"li\", {\n    parentName: \"ul\"\n  }, mdx(\"p\", {\n    parentName: \"li\"\n  }, \"During the shuffle ShuffleMapTask writes blocks to local drive, and then the task in the next stages fetches these blocks over the network.\")), mdx(\"li\", {\n    parentName: \"ul\"\n  }, mdx(\"p\", {\n    parentName: \"li\"\n  }, \"Shuffle Write\"), mdx(\"ul\", {\n    parentName: \"li\"\n  }, mdx(\"li\", {\n    parentName: \"ul\"\n  }, \"redistributes data among partitions and writes files to disk\"), mdx(\"li\", {\n    parentName: \"ul\"\n  }, \"each hash shuffle task creates one file per \\u201Creduce\\u201D task (total = MxR)\"), mdx(\"li\", {\n    parentName: \"ul\"\n  }, \"sort shuffle task creates one file with regions assigned to reducer\"), mdx(\"li\", {\n    parentName: \"ul\"\n  }, \"sort shuffle uses in-memory sorting with spillover to disk to get final result\"))), mdx(\"li\", {\n    parentName: \"ul\"\n  }, mdx(\"p\", {\n    parentName: \"li\"\n  }, \"Shuffle Read\"), mdx(\"ul\", {\n    parentName: \"li\"\n  }, mdx(\"li\", {\n    parentName: \"ul\"\n  }, \"fetches the files and applies reduce() logic\"), mdx(\"li\", {\n    parentName: \"ul\"\n  }, \"if data ordering is needed then it is sorted on \\u201Creducer\\u201D side for any type of shuffle\")))), mdx(\"p\", null, \"In Spark \", mdx(\"strong\", {\n    parentName: \"p\"\n  }, \"Sort Shuffle\"), \" is the default one.\\nSort Shuffle:\\n\", mdx(\"span\", _extends({\n    parentName: \"p\"\n  }, {\n    \"className\": \"gatsby-resp-image-wrapper\",\n    \"style\": {\n      \"position\": \"relative\",\n      \"display\": \"block\",\n      \"marginLeft\": \"auto\",\n      \"marginRight\": \"auto\",\n      \"maxWidth\": \"706px\"\n    }\n  }), \"\\n      \", mdx(\"a\", _extends({\n    parentName: \"span\"\n  }, {\n    \"className\": \"gatsby-resp-image-link\",\n    \"href\": \"/courseware/static/46a7536b3299b59c3063ffb37bd48daf/9f21b/internal8.png\",\n    \"style\": {\n      \"display\": \"block\"\n    },\n    \"target\": \"_blank\",\n    \"rel\": \"noopener\"\n  }), \"\\n    \", mdx(\"span\", _extends({\n    parentName: \"a\"\n  }, {\n    \"className\": \"gatsby-resp-image-background-image\",\n    \"style\": {\n      \"paddingBottom\": \"62.934362934362944%\",\n      \"position\": \"relative\",\n      \"bottom\": \"0\",\n      \"left\": \"0\",\n      \"backgroundImage\": \"url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAANCAYAAACpUE5eAAAACXBIWXMAAAsSAAALEgHS3X78AAADm0lEQVQ4y2NgAAJpKUkhAX4+BR4ebilubm5JT09PlqCgIOb///8z7tq1i/HatWuMMTExzO7u7iyeHh4sBSUVTGHh0ZyyUlIqKsoKMgoK8opa2lriP/5/Z2TgFxBRZGBkV2Bh5ZK3sbUXdXdz4/fw8OCxt7fnk5GRUZQFAikpKXkjIyPBqKgoTh9fPy4PN1cZoDtYgZgJSrOAHKajqSPA0F6XKnDt+Fyeo9u6udatnAGSRAZMxsbGPEAsYmlpye/h6cnrYG3KGZucoXL+6hPbL5fOelw+uib49u2LgVefXvecPHOiBsPXFweuPbu19cH3V4fuHN890xNoiKKOtqaWkpKSJhCo2tjYiPLy8gowMjLqs7NzqIMsCU3I8rpy89n//w/v/P//6SIwZP79f/337f9dh3fmM7y4vdnsxa1Npt+e7zHZsqpXVFBUjtvK0pzPxMSET09PjxMYnvz6+vryQAtUNTQ0lDVU5EUSMvINzlx+lPHs6MHMW2c25z94cD3v9M0zWXMWzTJkePdwp8fLO1s8vr/c775rwyRpNi5RHnNzUwFDQ0MBXV1dHjc3NwE7OztRoIGKmlpa8hYG6jyxKTkmQAMLX5863njr5Prehw+udF+4d7Fz1eaVzgxfnu2/8PTmlpvfXh68emz3THegl+R1dDQ1gQYAHaShYmVlJcbDwyPOxMRkyMHBqQmKhOjUfO8L1x5/+Hfz2v//r04Dvfz1/5u/7/7vOba7CiUGbJwjmNEihcHBwYHTxcWFD+hSHqD3eS3NTLhjE1IUdx25KvPqzEn5vRvmah46uEPt+tOb8uXVZTIMj66ulfnydIf0z5e7JLevm8ajqGbM7OnhAkpzzIGBgYze3t5cPj4+PECX8jo4OvGZ66txJKbnaZ669NDn1anj4af3LEm9dvVUEtDL0XOWzDZk+Pby0OMXd7a/+fn68IvT++d6Ax2lZKCvq6+mpqYHjGUNa2trCWA6lObg4LDg4+c3BMpzRCXn+p+/9uTT/7u3/v9/dx7o5Z//P/z/9H/v8d3VDFtWdettXN6uu3fTRJ3SgmQpM3NrYScnRxGgV0WBkSHs5eUlBUyDKsAY1wLGvLqFqbFMXEq2zq6DZ5NObVhbefHQ6vJLF4+Xbzu4vXbmghlW6EHG0NxQyZiXX8hYUVHBWFRUxJiQkIAif+vtf3Qt7EDMBecB3QvHxILE4jaQesa82Bh2AT4eEwEBfiMzK3M+kBwA7WFknVMMNiIAAAAASUVORK5CYII=')\",\n      \"backgroundSize\": \"cover\",\n      \"display\": \"block\"\n    }\n  })), \"\\n  \", mdx(\"img\", _extends({\n    parentName: \"a\"\n  }, {\n    \"className\": \"gatsby-resp-image-image\",\n    \"alt\": \"internals8\",\n    \"title\": \"internals8\",\n    \"src\": \"/courseware/static/46a7536b3299b59c3063ffb37bd48daf/9f21b/internal8.png\",\n    \"srcSet\": [\"/courseware/static/46a7536b3299b59c3063ffb37bd48daf/a2ead/internal8.png 259w\", \"/courseware/static/46a7536b3299b59c3063ffb37bd48daf/6b9fd/internal8.png 518w\", \"/courseware/static/46a7536b3299b59c3063ffb37bd48daf/9f21b/internal8.png 706w\"],\n    \"sizes\": \"(max-width: 706px) 100vw, 706px\",\n    \"style\": {\n      \"width\": \"100%\",\n      \"height\": \"100%\",\n      \"margin\": \"0\",\n      \"verticalAlign\": \"middle\",\n      \"position\": \"absolute\",\n      \"top\": \"0\",\n      \"left\": \"0\"\n    },\n    \"loading\": \"lazy\"\n  })), \"\\n  \"), \"\\n    \")), mdx(\"ul\", null, mdx(\"li\", {\n    parentName: \"ul\"\n  }, \"Incoming records accumulated and sorted in memory according their target partition ids\"), mdx(\"li\", {\n    parentName: \"ul\"\n  }, \"Sorted records are written to file or multiple files if spilled and then merged\"), mdx(\"li\", {\n    parentName: \"ul\"\n  }, \"index file stores offsets of the data blocks in the data file\")), mdx(\"h1\", null, \"Spark Components\"), mdx(\"ul\", null, mdx(\"li\", {\n    parentName: \"ul\"\n  }, mdx(\"p\", {\n    parentName: \"li\"\n  }, \"At 10K foot view there are three major components:\\n\", mdx(\"span\", _extends({\n    parentName: \"p\"\n  }, {\n    \"className\": \"gatsby-resp-image-wrapper\",\n    \"style\": {\n      \"position\": \"relative\",\n      \"display\": \"block\",\n      \"marginLeft\": \"auto\",\n      \"marginRight\": \"auto\",\n      \"maxWidth\": \"543px\"\n    }\n  }), \"\\n      \", mdx(\"a\", _extends({\n    parentName: \"span\"\n  }, {\n    \"className\": \"gatsby-resp-image-link\",\n    \"href\": \"/courseware/static/1bd78677654f383d1ccaf58ff5041ca3/29579/internal9.png\",\n    \"style\": {\n      \"display\": \"block\"\n    },\n    \"target\": \"_blank\",\n    \"rel\": \"noopener\"\n  }), \"\\n    \", mdx(\"span\", _extends({\n    parentName: \"a\"\n  }, {\n    \"className\": \"gatsby-resp-image-background-image\",\n    \"style\": {\n      \"paddingBottom\": \"80.6949806949807%\",\n      \"position\": \"relative\",\n      \"bottom\": \"0\",\n      \"left\": \"0\",\n      \"backgroundImage\": \"url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAQCAYAAAAWGF8bAAAACXBIWXMAAAsSAAALEgHS3X78AAADtElEQVQ4y5VTe0xTZxS/jCkmtBbUbW66+CIqwh6A/iGLE+emE1mMe2jcQ+f+UIxb9siCJpsbYcZtYckmCiKSWWtGb215GPugleLaQntv308upbalDyhtxU6UbB0JZ993Y83YMMtO8ss5Oef8fjnnexDEP6z2opGgmfFsHMuo6AdyfQDk+uAtaZ//dtcNJi0zhHozvSpLnPhPq+ObiPBYghU0uCOHk+MxCAY96Zt+91QkzIDLN0xlenWe1MOFRLok64XaODEy4nsUxw7v0McAIUiFe+BuTAeQtkI45GJwDYAgFJZxQtSXnMF/YGRf4oG/4Yg9gmMFHSyxeTxfUhbqmOJ69zeOAcdxrdW7H8kRI345Ie6PZ5H9iRn8WUX/r83Ka5V52XMjdfGjpC4RQKvYL6sj7nOd9oHmLifTIDLeRLHnZ/mQB9UcqMeLILsgHZyLeV3myZmCAJCFfYdxYrdYf1vcTv3Gb9PEBGcl1kuNEpvgB4FO/GOb4dKFa4ygnb7DRz1CiSFVj3js8XzV0PmvIedweQt4yGfPstUchLyHbMzN5fJYThjf1BNLVmZZ/Hez1xY9u7Bsw0be+vItvGfWb+YUPl/O2VixM3/Hrn15BWuKl2/etitvWUERd1VhCae4bBNbL99SxVtTWLxoU8UrHDzp1so32C0fR8DnsBZhIcK8+by8eTk5OfPv559CWHF/Sk5mrFwOl/e3egFCDrvF3Nz8xzTMveoura9FRoXPkj3MIdyPyUrbeBX6Gefbe5lmGT16ouyF7U+ifBbg1VD9Gh2rkNPRc50ab6PcOHryrYOfrSIaBKo9/cwEaBxx8N4CkFERI+6urqlfrbbGk/2eFFiH/wSNO5Xeubd6RWbCwtIXF6tMMS89dA+MvkmgfL/DJ7WNGwi+kHwvaq6Zdsr3/jHm/h6k1IgKEw5/fbUoZD016lG+C8P6o9OUyxstf/PbZZlLW/0auTRgqWe86vchqD04ZXbZJg58cbWUaBSI3jZb+dMU1ZR2DnSA1BBhP/+h4xfX0ea2qMnUAmZzK/xq949VvlO3HK+M66XbTi3RG0mPxdoKJlPTlNbOTH5YKy4jmoSKA3TIB4bAIDgTMSQY7cGET0+0FKld9jvmaAAw1M7R5EtVR57OCG7d8dFSlcMWssVCQIcGodcZnTpy7PxzRM3JMy+TKqWIVCpIYbfqSt0ZSSUmvb7/85W/KLpbUP4KqezubBarq/FFfHf6J/Yhryt5dfFlqeI0qklQT0drR28NSuf/BRRa+ZhhGoctAAAAAElFTkSuQmCC')\",\n      \"backgroundSize\": \"cover\",\n      \"display\": \"block\"\n    }\n  })), \"\\n  \", mdx(\"img\", _extends({\n    parentName: \"a\"\n  }, {\n    \"className\": \"gatsby-resp-image-image\",\n    \"alt\": \"internals9\",\n    \"title\": \"internals9\",\n    \"src\": \"/courseware/static/1bd78677654f383d1ccaf58ff5041ca3/29579/internal9.png\",\n    \"srcSet\": [\"/courseware/static/1bd78677654f383d1ccaf58ff5041ca3/a2ead/internal9.png 259w\", \"/courseware/static/1bd78677654f383d1ccaf58ff5041ca3/6b9fd/internal9.png 518w\", \"/courseware/static/1bd78677654f383d1ccaf58ff5041ca3/29579/internal9.png 543w\"],\n    \"sizes\": \"(max-width: 543px) 100vw, 543px\",\n    \"style\": {\n      \"width\": \"100%\",\n      \"height\": \"100%\",\n      \"margin\": \"0\",\n      \"verticalAlign\": \"middle\",\n      \"position\": \"absolute\",\n      \"top\": \"0\",\n      \"left\": \"0\"\n    },\n    \"loading\": \"lazy\"\n  })), \"\\n  \"), \"\\n    \"))), mdx(\"li\", {\n    parentName: \"ul\"\n  }, mdx(\"p\", {\n    parentName: \"li\"\n  }, \"Spark Driver\"), mdx(\"ul\", {\n    parentName: \"li\"\n  }, mdx(\"li\", {\n    parentName: \"ul\"\n  }, \"separate process to execute user applications\"), mdx(\"li\", {\n    parentName: \"ul\"\n  }, \"creates SparkContext to schedule jobs execution and negotiate with cluster manager\"))), mdx(\"li\", {\n    parentName: \"ul\"\n  }, mdx(\"p\", {\n    parentName: \"li\"\n  }, \"Executors\"), mdx(\"ul\", {\n    parentName: \"li\"\n  }, mdx(\"li\", {\n    parentName: \"ul\"\n  }, \"run tasks scheduled by driver\"), mdx(\"li\", {\n    parentName: \"ul\"\n  }, \"store computation results in memory, on disk or off-heap\"), mdx(\"li\", {\n    parentName: \"ul\"\n  }, \"interact with storage systems\"))), mdx(\"li\", {\n    parentName: \"ul\"\n  }, mdx(\"p\", {\n    parentName: \"li\"\n  }, \"Cluster Manager\"), mdx(\"ul\", {\n    parentName: \"li\"\n  }, mdx(\"li\", {\n    parentName: \"ul\"\n  }, \"Mesos\"), mdx(\"li\", {\n    parentName: \"ul\"\n  }, \"YARN\"), mdx(\"li\", {\n    parentName: \"ul\"\n  }, \"Spark Standalone\")), mdx(\"p\", {\n    parentName: \"li\"\n  }, \"Spark Driver contains more components responsible for translation of user code into actual jobs executed on cluster:\\n\", mdx(\"span\", _extends({\n    parentName: \"p\"\n  }, {\n    \"className\": \"gatsby-resp-image-wrapper\",\n    \"style\": {\n      \"position\": \"relative\",\n      \"display\": \"block\",\n      \"marginLeft\": \"auto\",\n      \"marginRight\": \"auto\",\n      \"maxWidth\": \"845px\"\n    }\n  }), \"\\n      \", mdx(\"a\", _extends({\n    parentName: \"span\"\n  }, {\n    \"className\": \"gatsby-resp-image-link\",\n    \"href\": \"/courseware/static/9af5b27e41a3371bc78642287582c4af/8bd7c/internal10.png\",\n    \"style\": {\n      \"display\": \"block\"\n    },\n    \"target\": \"_blank\",\n    \"rel\": \"noopener\"\n  }), \"\\n    \", mdx(\"span\", _extends({\n    parentName: \"a\"\n  }, {\n    \"className\": \"gatsby-resp-image-background-image\",\n    \"style\": {\n      \"paddingBottom\": \"33.59073359073359%\",\n      \"position\": \"relative\",\n      \"bottom\": \"0\",\n      \"left\": \"0\",\n      \"backgroundImage\": \"url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAHCAYAAAAIy204AAAACXBIWXMAAAsSAAALEgHS3X78AAAB5ElEQVQoz4WRS2sTURTHb1oJDd3URyroQrRFitiFSuoiC3HVD+DOD+DeJyjoQhB0pRCEVkptKbRdNNAWLVofhXbEiUYbx7bzSCY388jMbeI8GpJOMqQ9nRsXii76h8M5HA6/c/gfFIlEDobD4aNBdMfj8TYAQAB30B8dOozQkY5WeWEMvVwQQs+TmQPDc2vtx84OIjrfd6a/+8TJnuMPHj0No38VDLTRnJHIXdW0fwiyvlQolhmFVJZml+XTaD8lEokQwzChANSK+YX3rS0b+NdEM2gIWQXUYgmIvQ2LqUL/TAa6hma5+yOvhWv0OoYzz6d5496qSK5/l8o3keM4nwzDYBRFWdE0jTVN8w0F8oo9VLKrsCFhT8qrO7JW9r/wpZ7HYyuXxt8V4NkU60YvP+z8mbdu+7sAxqYNxKlTvwBc1wXLsmgJnlevU6CkV4bd2g6si7iRxUXAht0MgL23nkwOJlkXAg9thHq7skb1hlPZBkGSoeT+Bvq6rjdEUfRqtdqu7/smBa7lyy+sLQ94CTeCCyGnbDY/ppW+V+twauazk06m3OloE0IZ2bmSWhXZ5RS3yBesD4gQMsBxXIxl2RjG+KKm6TEK/Mbro8SqgpBTfTGnAi8bjbdf9XN/+381+v9P9gAv1T/8gDgJ8wAAAABJRU5ErkJggg==')\",\n      \"backgroundSize\": \"cover\",\n      \"display\": \"block\"\n    }\n  })), \"\\n  \", mdx(\"img\", _extends({\n    parentName: \"a\"\n  }, {\n    \"className\": \"gatsby-resp-image-image\",\n    \"alt\": \"internals10\",\n    \"title\": \"internals10\",\n    \"src\": \"/courseware/static/9af5b27e41a3371bc78642287582c4af/8bd7c/internal10.png\",\n    \"srcSet\": [\"/courseware/static/9af5b27e41a3371bc78642287582c4af/a2ead/internal10.png 259w\", \"/courseware/static/9af5b27e41a3371bc78642287582c4af/6b9fd/internal10.png 518w\", \"/courseware/static/9af5b27e41a3371bc78642287582c4af/8bd7c/internal10.png 845w\"],\n    \"sizes\": \"(max-width: 845px) 100vw, 845px\",\n    \"style\": {\n      \"width\": \"100%\",\n      \"height\": \"100%\",\n      \"margin\": \"0\",\n      \"verticalAlign\": \"middle\",\n      \"position\": \"absolute\",\n      \"top\": \"0\",\n      \"left\": \"0\"\n    },\n    \"loading\": \"lazy\"\n  })), \"\\n  \"), \"\\n    \"))), mdx(\"li\", {\n    parentName: \"ul\"\n  }, mdx(\"p\", {\n    parentName: \"li\"\n  }, \"SparkContext\"), mdx(\"ul\", {\n    parentName: \"li\"\n  }, mdx(\"li\", {\n    parentName: \"ul\"\n  }, \"represents the connection to a Spark cluster, and can be used to create RDDs, accumulators and broadcast variables on that cluster\"))), mdx(\"li\", {\n    parentName: \"ul\"\n  }, mdx(\"p\", {\n    parentName: \"li\"\n  }, \"DAGScheduler\"), mdx(\"ul\", {\n    parentName: \"li\"\n  }, mdx(\"li\", {\n    parentName: \"ul\"\n  }, \"computes a DAG of stages for each job and submits them to TaskScheduler\"), mdx(\"li\", {\n    parentName: \"ul\"\n  }, \"determines preferred locations for tasks (based on cache status or shuffle files locations) and finds minimum schedule to run the jobs\"))), mdx(\"li\", {\n    parentName: \"ul\"\n  }, mdx(\"p\", {\n    parentName: \"li\"\n  }, \"TaskScheduler\"), mdx(\"ul\", {\n    parentName: \"li\"\n  }, mdx(\"li\", {\n    parentName: \"ul\"\n  }, \"responsible for sending tasks to the cluster, running them, retrying if there are failures, and mitigating stragglers\"))), mdx(\"li\", {\n    parentName: \"ul\"\n  }, mdx(\"p\", {\n    parentName: \"li\"\n  }, \"SchedulerBackend\"), mdx(\"ul\", {\n    parentName: \"li\"\n  }, mdx(\"li\", {\n    parentName: \"ul\"\n  }, \"backend interface for scheduling systems that allows plugging in different implementations(Mesos, YARN, Standalone, local)\"))), mdx(\"li\", {\n    parentName: \"ul\"\n  }, mdx(\"p\", {\n    parentName: \"li\"\n  }, \"BlockManager\"), mdx(\"ul\", {\n    parentName: \"li\"\n  }, mdx(\"li\", {\n    parentName: \"ul\"\n  }, \"provides interfaces for putting and retrieving blocks both locally and remotely into various stores (memory, disk, and off-heap)\")))), mdx(\"h1\", null, \"Memory Management in Spark\"), mdx(\"p\", null, \"Executors run as Java processes, so the available memory is equal to the heap size. Internally available memory is split into several regions with specific functions.\"), mdx(\"p\", null, mdx(\"span\", _extends({\n    parentName: \"p\"\n  }, {\n    \"className\": \"gatsby-resp-image-wrapper\",\n    \"style\": {\n      \"position\": \"relative\",\n      \"display\": \"block\",\n      \"marginLeft\": \"auto\",\n      \"marginRight\": \"auto\",\n      \"maxWidth\": \"264px\"\n    }\n  }), \"\\n      \", mdx(\"a\", _extends({\n    parentName: \"span\"\n  }, {\n    \"className\": \"gatsby-resp-image-link\",\n    \"href\": \"/courseware/static/f123e793debaf54ed7be45d8952aafa4/e61aa/internal11.png\",\n    \"style\": {\n      \"display\": \"block\"\n    },\n    \"target\": \"_blank\",\n    \"rel\": \"noopener\"\n  }), \"\\n    \", mdx(\"span\", _extends({\n    parentName: \"a\"\n  }, {\n    \"className\": \"gatsby-resp-image-background-image\",\n    \"style\": {\n      \"paddingBottom\": \"169.88416988416986%\",\n      \"position\": \"relative\",\n      \"bottom\": \"0\",\n      \"left\": \"0\",\n      \"backgroundImage\": \"url('data:image/png;base64,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')\",\n      \"backgroundSize\": \"cover\",\n      \"display\": \"block\"\n    }\n  })), \"\\n  \", mdx(\"img\", _extends({\n    parentName: \"a\"\n  }, {\n    \"className\": \"gatsby-resp-image-image\",\n    \"alt\": \"internals11\",\n    \"title\": \"internals11\",\n    \"src\": \"/courseware/static/f123e793debaf54ed7be45d8952aafa4/e61aa/internal11.png\",\n    \"srcSet\": [\"/courseware/static/f123e793debaf54ed7be45d8952aafa4/a2ead/internal11.png 259w\", \"/courseware/static/f123e793debaf54ed7be45d8952aafa4/e61aa/internal11.png 264w\"],\n    \"sizes\": \"(max-width: 264px) 100vw, 264px\",\n    \"style\": {\n      \"width\": \"100%\",\n      \"height\": \"100%\",\n      \"margin\": \"0\",\n      \"verticalAlign\": \"middle\",\n      \"position\": \"absolute\",\n      \"top\": \"0\",\n      \"left\": \"0\"\n    },\n    \"loading\": \"lazy\"\n  })), \"\\n  \"), \"\\n    \")), mdx(\"ul\", null, mdx(\"li\", {\n    parentName: \"ul\"\n  }, \"Execution Memory\", mdx(\"ul\", {\n    parentName: \"li\"\n  }, mdx(\"li\", {\n    parentName: \"ul\"\n  }, \"storage for data needed during tasks execution\"), mdx(\"li\", {\n    parentName: \"ul\"\n  }, \"shuffle-related data\"))), mdx(\"li\", {\n    parentName: \"ul\"\n  }, \"Storage Memory\", mdx(\"ul\", {\n    parentName: \"li\"\n  }, mdx(\"li\", {\n    parentName: \"ul\"\n  }, \"storage of cached RDDs and broadcast variables\"), mdx(\"li\", {\n    parentName: \"ul\"\n  }, \"possible to borrow from execution memory (spill otherwise)\"), mdx(\"li\", {\n    parentName: \"ul\"\n  }, \"safeguard value is 50% of Spark Memory when cached blocks are immune to eviction\"))), mdx(\"li\", {\n    parentName: \"ul\"\n  }, \"User Memory\", mdx(\"ul\", {\n    parentName: \"li\"\n  }, mdx(\"li\", {\n    parentName: \"ul\"\n  }, \"user data structures and internal metadata in Spark\"), mdx(\"li\", {\n    parentName: \"ul\"\n  }, \"safeguarding against OOM\"))), mdx(\"li\", {\n    parentName: \"ul\"\n  }, \"Reserved memory\", mdx(\"ul\", {\n    parentName: \"li\"\n  }, mdx(\"li\", {\n    parentName: \"ul\"\n  }, \"memory needed for running executor itself and not strictly related to Spark\")))), mdx(\"hr\", null), mdx(\"h1\", null, \"Sourcers/Credits:\"), mdx(\"p\", null, \"To be completed\"));\n}\n;\nMDXContent.isMDXComponent = true;","tableOfContents":{"items":[{"url":"#spark-internals","title":"Spark Internals"},{"url":"#introduction","title":"Introduction"},{"url":"#rdd-resilient-distributed-dataset","title":"RDD: Resilient Distributed Dataset"},{"url":"#transformations","title":"Transformations"},{"url":"#actions","title":"Actions"},{"url":"#extra-persistence","title":"Extra: persistence"},{"url":"#splitting-dag-into-stages","title":"Splitting DAG into Stages"},{"url":"#shuffle","title":"Shuffle"},{"url":"#spark-components","title":"Spark Components"},{"url":"#memory-management-in-spark","title":"Memory Management in Spark"},{"url":"#sourcerscredits","title":"Sourcers/Credits:"}]},"parent":{"__typename":"File","relativePath":"sparkinternals.md"},"frontmatter":{"metaTitle":"Week 5 - Spark Internals","metaDescription":"Week 5 - Spark Internals"}},"allMdx":{"edges":[{"node":{"fields":{"slug":"/","title":"Data Engineering II"}}},{"node":{"fields":{"slug":"/bigdatahistory","title":"Big Data History [Optional Reading]"}}},{"node":{"fields":{"slug":"/resources","title":"Resources/Help"}}},{"node":{"fields":{"slug":"/apachespark","title":"Week 4 - Apache Spark"}}},{"node":{"fields":{"slug":"/internet","title":"Week 1- Internet"}}},{"node":{"fields":{"slug":"/spark-continued","title":"Week 7 - Apacke Spark Hands-on"}}},{"node":{"fields":{"slug":"/serverless","title":"Week 3 - Serverless"}}},{"node":{"fields":{"slug":"/sparkinternals","title":"Week 5 - Spark Internals"}}},{"node":{"fields":{"slug":"/syllabus","title":"Welcome - Syllabus"}}},{"node":{"fields":{"slug":"/sparkAPI","title":"Week 6 - Apache Spark APIs"}}},{"node":{"fields":{"slug":"/sparkinternals/1-sparkinternals","title":"Class Resources"}}},{"node":{"fields":{"slug":"/sparkinternals/3-sparkinternals","title":"Homework"}}},{"node":{"fields":{"slug":"/sparkinternals/2-sparkinternals","title":"Lecture Video"}}},{"node":{"fields":{"slug":"/sparkAPI/2-sparkAPI","title":"Lecture Video"}}},{"node":{"fields":{"slug":"/sparkAPI/3-sparkAPI","title":"Homework"}}},{"node":{"fields":{"slug":"/sparkAPI/1-sparkAPI","title":"Class Resources"}}},{"node":{"fields":{"slug":"/spark-continued/3-spark-continued","title":"Homework"}}},{"node":{"fields":{"slug":"/spark-continued/2-spark-continued","title":"Lecture Video"}}},{"node":{"fields":{"slug":"/spark-continued/1-spark-continued","title":"Class Resources"}}},{"node":{"fields":{"slug":"/serverless/1-serverless","title":"Class Resources"}}},{"node":{"fields":{"slug":"/serverless/2-serverless","title":"Lecture Video"}}},{"node":{"fields":{"slug":"/internet/1-internet","title":"Class Resources"}}},{"node":{"fields":{"slug":"/serverless/3-serverless","title":"Homework"}}},{"node":{"fields":{"slug":"/internet/3-internet","title":"Homework"}}},{"node":{"fields":{"slug":"/internet/2-internet","title":"Lecture Video"}}},{"node":{"fields":{"slug":"/aws/1-aws","title":"Class Resources"}}},{"node":{"fields":{"slug":"/aws/2-aws","title":"Lecture Video"}}},{"node":{"fields":{"slug":"/aws/3-homework","title":"Homework"}}},{"node":{"fields":{"slug":"/apachespark/1-apachespark","title":"Class Resources"}}},{"node":{"fields":{"slug":"/apachespark/2-apachespark","title":"Lecture Video"}}},{"node":{"fields":{"slug":"/apachespark/3-apachespark","title":"Homework"}}},{"node":{"fields":{"slug":"/aws","title":"Week 2 - AWS"}}}]}},"pageContext":{"id":"9d0679ce-c646-50aa-baa7-eef4a456304b"}},"staticQueryHashes":["2619113677","2619113677","3706406642","3706406642","417421954","417421954"]}