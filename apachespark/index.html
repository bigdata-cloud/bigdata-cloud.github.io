<!DOCTYPE html><html lang="en"><head><meta charSet="utf-8"/><meta http-equiv="x-ua-compatible" content="ie=edge"/><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"/><meta property="twitter:card" content="summary_large_image"/><link rel="shortcut icon" type="image/svg" href="https://media.glassdoor.com/sqll/591152/central-european-university-squarelogo-1430146462267.png"/><noscript></noscript><meta name="generator" content="Gatsby 2.24.85"/><link rel="sitemap" type="application/xml" href="/sitemap.xml"/><title data-react-helmet="true">Week 4 - Apache Spark</title><link data-react-helmet="true" rel="canonical" href="https://bigdata-cloud.github.io//apachespark"/><meta data-react-helmet="true" name="title" content="Week 4 - Apache Spark"/><meta data-react-helmet="true" name="description" content="Week 4 - Apache Spark"/><meta data-react-helmet="true" property="og:title" content="Week 4 - Apache Spark"/><meta data-react-helmet="true" property="og:description" content="Week 4 - Apache Spark"/><meta data-react-helmet="true" property="twitter:title" content="Week 4 - Apache Spark"/><meta data-react-helmet="true" property="twitter:description" content="Week 4 - Apache Spark"/><link as="script" rel="preload" href="/webpack-runtime-22c4b15bc7d72b664a75.js"/><link as="script" rel="preload" href="/framework-c90682c3d94fb45fdc20.js"/><link as="script" rel="preload" href="/commons-2ef445fb87a62dd81c1d.js"/><link as="script" rel="preload" href="/app-a00f8caa95f00bf7280b.js"/><link as="fetch" rel="preload" href="/page-data/apachespark/page-data.json" crossorigin="anonymous"/><link as="fetch" rel="preload" href="/page-data/sq/d/2619113677.json" crossorigin="anonymous"/><link as="fetch" rel="preload" href="/page-data/sq/d/2619113677.json" crossorigin="anonymous"/><link as="fetch" rel="preload" href="/page-data/sq/d/3706406642.json" crossorigin="anonymous"/><link as="fetch" rel="preload" href="/page-data/sq/d/3706406642.json" crossorigin="anonymous"/><link as="fetch" rel="preload" href="/page-data/sq/d/417421954.json" crossorigin="anonymous"/><link as="fetch" rel="preload" href="/page-data/sq/d/417421954.json" crossorigin="anonymous"/><link as="fetch" rel="preload" href="/page-data/app-data.json" crossorigin="anonymous"/></head><body><div id="___gatsby"><div style="outline:none" tabindex="-1" id="gatsby-focus-wrapper"><div><style data-emotion-css="0"></style><div class="navBarWrapper"><nav class="navBarDefault"><div class="navBarHeader"><a href="https://ceu.edu/" class="navBarBrand"><img class="img-responsive displayInline" src="https://alumni.ceu.edu/sites/all/themes/ceupoly/logo.png" alt="logo"/></a><div class="headerTitle displayInline">ECBS 5147: Data Engineering 3 Big Data and Cloud Computing</div></div><ul class="socialWrapper visibleMobileView">
			<li>
		    <a href="https://ceu-bizanalytics.slack.com/#/" target="_blank" rel="noopener">
		      <div class="discordBtn">
		        <img src='https://cdn-5dc591f7f911c91c58a5564e.closte.com/wp-content/uploads/2020/03/slack-icon.png' alt={'Slack'}/>
		      </div>
		    </a>
		  </li></ul><div id="navbar" class="topnav"><div class="visibleMobile"><style data-emotion-css="8uxxw2">.css-8uxxw2{width:100%;height:100vh;overflow:auto;position:fixed;padding-left:0px;position:-webkit-sticky;position:-moz-sticky;position:-webkit-sticky;position:sticky;top:0;padding-right:0;-webkit-box-shadow:-1px 0px 4px 1px rgba(175,158,232,0.4);}@media only screen and (max-width:1023px){.css-8uxxw2{width:100%;height:100vh;}}@media (min-width:767px) and (max-width:1023px){.css-8uxxw2{padding-left:0;}}@media only screen and (max-width:767px){.css-8uxxw2{padding-left:0px;height:auto;}}</style><aside class="css-8uxxw2 eer5zio1"><div class="sidebarTitle hiddenMobile"><a href='#'>CEU </a><div class='greenCircle'></div><a href='#'>Courseware</a></div><ul class="sideBarUL"><li class="hideFrontLine firstLevel item "><ul><li class=" item "><a href="/syllabus">Welcome - Syllabus</a></li><li class=" item "><a href="/internet">Week 1- Internet<button aria-label="collapse" class="collapser"><svg xmlns="http://www.w3.org/2000/svg" width="12" height="12" viewBox="0 0 24 24"><path d="M7.33 24l-2.83-2.829 9.339-9.175-9.339-9.167 2.83-2.829 12.17 11.996z"></path></svg></button></a></li><li class=" item "><a href="/aws">Week 2 - AWS<button aria-label="collapse" class="collapser"><svg xmlns="http://www.w3.org/2000/svg" width="12" height="12" viewBox="0 0 24 24"><path d="M7.33 24l-2.83-2.829 9.339-9.175-9.339-9.167 2.83-2.829 12.17 11.996z"></path></svg></button></a></li><li class=" item "><a href="/serverless">Week 3 - Serverless<button aria-label="collapse" class="collapser"><svg xmlns="http://www.w3.org/2000/svg" width="12" height="12" viewBox="0 0 24 24"><path d="M7.33 24l-2.83-2.829 9.339-9.175-9.339-9.167 2.83-2.829 12.17 11.996z"></path></svg></button></a></li><li class=" item "><a aria-current="page" class="" href="/apachespark">Week 4 - Apache Spark<button aria-label="collapse" class="collapser"><svg xmlns="http://www.w3.org/2000/svg" width="12" height="12" viewBox="0 0 24 24"><path d="M7.33 24l-2.83-2.829 9.339-9.175-9.339-9.167 2.83-2.829 12.17 11.996z"></path></svg></button></a></li><li class=" item "><a href="/sparkinternals">Week 5 - Spark Internals<button aria-label="collapse" class="collapser"><svg xmlns="http://www.w3.org/2000/svg" width="12" height="12" viewBox="0 0 24 24"><path d="M7.33 24l-2.83-2.829 9.339-9.175-9.339-9.167 2.83-2.829 12.17 11.996z"></path></svg></button></a></li><li class=" item "><a href="/sparkAPI">Week 6 - Apache Spark APIs<button aria-label="collapse" class="collapser"><svg xmlns="http://www.w3.org/2000/svg" width="12" height="12" viewBox="0 0 24 24"><path d="M7.33 24l-2.83-2.829 9.339-9.175-9.339-9.167 2.83-2.829 12.17 11.996z"></path></svg></button></a></li><li class=" item "><a href="/spark-continued">Week 7 - Apacke Spark Hands-on<button aria-label="collapse" class="collapser"><svg xmlns="http://www.w3.org/2000/svg" width="12" height="12" viewBox="0 0 24 24"><path d="M7.33 24l-2.83-2.829 9.339-9.175-9.339-9.167 2.83-2.829 12.17 11.996z"></path></svg></button></a></li><li class=" item "><a href="/bigdatahistory">Big Data History [Optional Reading]</a></li><li class=" item "><a href="/resources">Resources/Help</a></li></ul></li><style data-emotion-css="1q387v1">.css-1q387v1{list-style:none;padding:0.5rem 0;}.css-1q387v1 hr{margin:0;padding:0;border:0;border-bottom:1px solid #ede7f3;}</style><li class="css-1q387v1 eer5zio2"><hr/></li><style data-emotion-css="1ldulps">.css-1ldulps{list-style:none;}.css-1ldulps a{color:#5c6975;-webkit-text-decoration:none;text-decoration:none;font-weight:400;padding:0.45rem 0 0.45rem 2rem;display:block;position:relative;}.css-1ldulps a:hover{color:#125fb3 !important;}.css-1ldulps a svg{float:right;margin-right:1rem;}</style><li class="css-1ldulps eer5zio0"><a href="http://localhost:8000/" to="http://localhost:8000/" target="_blank" rel="noopener noreferrer"> <!-- -->&lt;- Go Back<svg xmlns="http://www.w3.org/2000/svg" width="14" height="14" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M18 13v6a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V8a2 2 0 0 1 2-2h6"></path><polyline points="15 3 21 3 21 9"></polyline><line x1="10" y1="14" x2="21" y2="3"></line></svg> </a> </li></ul></aside><hr/></div><ul class="navBarUL navBarNav navBarULRight"><li class="divider hiddenMobile"></li><li class="hiddenMobile"><ul class="socialWrapper">
			<li>
		    <a href="https://ceu-bizanalytics.slack.com/#/" target="_blank" rel="noopener">
		      <div class="discordBtn">
		        <img src='https://cdn-5dc591f7f911c91c58a5564e.closte.com/wp-content/uploads/2020/03/slack-icon.png' alt={'Slack'}/>
		      </div>
		    </a>
		  </li></ul></li><li class="githubBtn"><span><a href="https://github.com/zoltanctoth/ceu-cloud-bigdata-course" data-show-count="true" aria-label="Star on GitHub">Star</a></span></li><li><style data-emotion-css="o9dm8b">.css-o9dm8b{display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-box-pack:end;-webkit-justify-content:flex-end;-ms-flex-pack:end;justify-content:flex-end;width:100%;padding:0 20px 0 25px;}.css-o9dm8b .switch{position:relative;display:inline-block;width:50px;height:20px;}.css-o9dm8b .switch input{opacity:0;width:0;height:0;}.css-o9dm8b .slider{position:absolute;cursor:pointer;top:0;left:0;right:0;bottom:0;background-color:#ccc;-webkit-transition:0.4s;-webkit-transition:0.4s;transition:0.4s;}.css-o9dm8b .slider:before{position:absolute;content:'';height:30px;width:30px;left:0px;bottom:4px;top:0;bottom:0;margin:auto 0;-webkit-transition:0.4s;-webkit-transition:0.4s;transition:0.4s;box-shadow:0 0px 15px #2020203d;background:white url(data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABgAAAAYCAYAAADgdz34AAAABHNCSVQICAgIfAhkiAAAAAlwSFlzAAAAsQAAALEBxi1JjQAAABl0RVh0U29mdHdhcmUAd3d3Lmlua3NjYXBlLm9yZ5vuPBoAAAOfSURBVEiJlZVLaFxVGMd/333NJG2a+ujUJnGSSWljGvPoQ0tBbIooulDoQgSpEou4UOqiLlzpxoVFEIsgaotaaEhBEXVV8EUXgrao0SYxk6ROjCUxfaQvm8fMPfd+LqZJ5k4ySfxW93yP/+Ocw7mwTOhw21odbG8rzuf6N3fl+iqNDm5rXGreKlXwB1oe8vtr0yanF4JY1YeR2lDzbgnHn5JwxvYJjuhwR7wUjixUXBc3Wfsk/lg7sUYkvmXC1vB+qe3K5IZa90s2cxTNWQASa4B4C0AAfO8kOx8pxnMi4OdaEmbmcg9mIoF7NxLfAiIvSLIrAyChjswpsysg3jy7tEEuLeZgbotUsQL/SjdmIoF4SPl2QM7YNce/mO1xG85+p27dy3lp1XMbIPCrfbGsY0kCM7DxWzWXqgCINQIugh4TQSMuYRRAxSnM/Ss7jvglCfy+1gfwx/bMuhWv/lbR/rp4wLZw88qzPYIcBDIscpazkZdhXf2YMLy1DwnIq1Muxv5eMLCp5zPta6qQTb03oRdVDkO7XYpAdLhtrZkcuoKavIp4MxK7ByDrJDtLXr+VhmWy/oE5cECkfPYzpiNP37ZSIE23pLSvyVtAIGR3RTLizn0ay25ZEXjm3vVGL/wWxCrfU22PXH1LMVXR7lzhYu+y4H+1bjWTf45jV6/Bq38+OF/zTYTAEnUjAzozb0bp0H+eW7cUgdT93o274QxeDQChhK9GCELcy5GJILKsDHxzaFkX4qUJp99F5agrzrWIgFy68SPxM/vnMw6y5glg/uYJctBOHn9nOaLCyJ1/ZqeE4WrLldgHUTkGzY1EU+jb/si+t4oPsFSYkX3PWqqnLJGdAmD+SNzU4PqquQ6rDKl4LOIi70T7FN6wA/crSR2bKaypPmmbUfdBCezXEN0DqC1hgwAEg42Hwmwmcjji1UPZ9lIipxB+Ah1FLR90A3AfcGdBz5dOsnOv5Nmxgv7ENQ2uV0RgynYgXmolu1Ic03YQbJPUiXT+xyGEtnPXw1heGG37Bc2e+9/oAq9I6kQaCp5r2Xz2tHqpA4hb8DwrzHSjUz9COL0icEXftJOd7xeQRcMMNT1ObuxzDafcaMVGvFrw6sC6HWTB6DTwkpPs/KTIzSIqhrauM8GNTzHjuwsfwvkpB6w1IHEQVGV1r+vc8aJsPPXDgtaSXgEd2FXtc/V1gslHLabWa5jzEAXsACm/IVbZz8iqw05Dz8lSGP8BjRZeDZkbZsEAAAAASUVORK5CYII=);background-repeat:no-repeat;background-position:center;}.css-o9dm8b input:checked + .slider{background:linear-gradient(to right,white,#125fb3);}.css-o9dm8b input:checked + .slider:before{-webkit-transform:translateX(24px);-ms-transform:translateX(24px);-webkit-transform:translateX(24px);-ms-transform:translateX(24px);transform:translateX(24px);background:white url(data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABgAAAAYCAYAAADgdz34AAAABHNCSVQICAgIfAhkiAAAAAlwSFlzAAAApgAAAKYB3X3/OAAAABl0RVh0U29mdHdhcmUAd3d3Lmlua3NjYXBlLm9yZ5vuPBoAAANGSURBVEiJndVPbNRVEAfwz9vd/q8tBQtoxSYYDKYmejMGD3DxYloMiRoT22IEDQcPno3xoFclMf6JHrDFyIVEI3g2eiDoRWOMfygqNrSkoeAWCtIu230e3m+77e6KCZO8vH3zZuY7M+/7mxVjVFu7C+vPt7mmh4fi+eEDMUYFVZkdeZU7dhgIzxOj25ULe3fJx6PYamZkDYD4rRDmmgafDIdE3aIJbcrKxkQF4/GtBtuY/43KGVBxOsT/S3YijAomEVBCBe0geNlYfLfBZ3bfJmFlp7u/ONUcYCIMCw6jL1vhFikUURS9Zn88Vn9ZaOJA8DTuA3n0Zjm3ZlDL2VrASpZE8CwaABormAgPC75Cny7cmYE0kwou4Rq4IWeP0fhdc4DjIe+GD0QvIKcbmzOrtl56t9O2gRBYvsKVcyz9ne7nsQgiPhUdtD8uNVYwGRbQK497qu3ZzsYHUuB1EimepTiVKplBGZQM6rI7liFX5/Ur0rPmpYw3ZcEL7fRso3eQQgcCfffT0Z+i9K3GOFMNvh7gWOjDYGpJpuvbkQK1dND/IF1b6Oynf4jW7jU2a3zY6uPQ3whw0/u4S5DYIqsAOjdrkKqutSfbVcncL+ejOoAQsC39VGN9yOiTa8LmXIGOx8h11RxqzzTgeHLOAGKUM4pFFdzMzJYX0n79YiPAP/O0PUSlHTE9cCXdCJ7zVFxZA4DReA4/gKVMd/WvtJcWKf6e6FlapPgHS0UW3uPyN9b58IuxOFU91Ne+E+kL7cb1Oa5O0zPI0kJaa+XaLIszif21q4x2if+1ClLP/iRrUfYNufQTF79P2ceY2lFaZP5HLqaCFaUxmOSsT3RWD42j4mh4RnQEnTZYP+pCLh1Se2uZF0FZdNC0o16Plf8GgMnwOZ5Eot9GiefVmbQiDbtitif52njcUx+q+TSNTgoZQAlzddblJj7ByWah0htc2LvL7L5Nq9r98YhBLSo2481Vfbkh+DtytljWaiy+3QwgxOnhIfl4AmdoGTXw2eUGq8lwWNCDD1WUBC+hYNyLTf9iZ554RAiPG/jyjYKcR7E1wa3sxKkGh/H4Sp3mULNsVyVvTgxTqYIYmRk5oOK0e0/8fEvH25B/AZyRWA6LDlu9AAAAAElFTkSuQmCC);background-repeat:no-repeat;background-position:center;}.css-o9dm8b .slider.round{border-radius:34px;}.css-o9dm8b .slider.round:before{border-radius:50%;}</style><div class="css-o9dm8b e1brsgsc0"><label id="switch" class="switch"><input type="checkbox" id="slider" checked=""/> <span class="slider round"> </span> </label> </div></li></ul></div></nav><style data-emotion-css="1gvjyvp">.css-1gvjyvp{height:60px;box-shadow:0 3px 6px 0 rgba(0,0,0,0.16);background-color:#f8f8f8;position:relative;display:none;}@media (max-width:767px){.css-1gvjyvp{display:block;}}</style><div class="css-1gvjyvp e1ykirhh0"><div class="navBarDefault removePadd"><span class="navBarToggle" role="button" tabindex="0"><span class="iconBar"></span><span class="iconBar"></span><span class="iconBar"></span></span></div></div></div><style data-emotion-css="1orzczj">.css-1orzczj{display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-box-pack:justify;-webkit-justify-content:space-between;-ms-flex-pack:justify;justify-content:space-between;background:#fff;}.css-1orzczj .sideBarUL li a{color:#3B454E;}.css-1orzczj .sideBarUL .item > a:hover{background-color:#125fb3;color:#fff !important;}@media only screen and (max-width:767px){.css-1orzczj{display:block;}}</style><div class="css-1orzczj eso2aao0"><style data-emotion-css="192n44p">.css-192n44p{width:298px;}</style><div class="hiddenMobile css-192n44p eso2aao3"><style data-emotion-css="8uxxw2">.css-8uxxw2{width:100%;height:100vh;overflow:auto;position:fixed;padding-left:0px;position:-webkit-sticky;position:-moz-sticky;position:-webkit-sticky;position:sticky;top:0;padding-right:0;-webkit-box-shadow:-1px 0px 4px 1px rgba(175,158,232,0.4);}@media only screen and (max-width:1023px){.css-8uxxw2{width:100%;height:100vh;}}@media (min-width:767px) and (max-width:1023px){.css-8uxxw2{padding-left:0;}}@media only screen and (max-width:767px){.css-8uxxw2{padding-left:0px;height:auto;}}</style><aside class="css-8uxxw2 eer5zio1"><div class="sidebarTitle hiddenMobile"><a href='#'>CEU </a><div class='greenCircle'></div><a href='#'>Courseware</a></div><ul class="sideBarUL"><li class="hideFrontLine firstLevel item "><ul><li class=" item "><a href="/syllabus">Welcome - Syllabus</a></li><li class=" item "><a href="/internet">Week 1- Internet<button aria-label="collapse" class="collapser"><svg xmlns="http://www.w3.org/2000/svg" width="12" height="12" viewBox="0 0 24 24"><path d="M7.33 24l-2.83-2.829 9.339-9.175-9.339-9.167 2.83-2.829 12.17 11.996z"></path></svg></button></a></li><li class=" item "><a href="/aws">Week 2 - AWS<button aria-label="collapse" class="collapser"><svg xmlns="http://www.w3.org/2000/svg" width="12" height="12" viewBox="0 0 24 24"><path d="M7.33 24l-2.83-2.829 9.339-9.175-9.339-9.167 2.83-2.829 12.17 11.996z"></path></svg></button></a></li><li class=" item "><a href="/serverless">Week 3 - Serverless<button aria-label="collapse" class="collapser"><svg xmlns="http://www.w3.org/2000/svg" width="12" height="12" viewBox="0 0 24 24"><path d="M7.33 24l-2.83-2.829 9.339-9.175-9.339-9.167 2.83-2.829 12.17 11.996z"></path></svg></button></a></li><li class=" item "><a aria-current="page" class="" href="/apachespark">Week 4 - Apache Spark<button aria-label="collapse" class="collapser"><svg xmlns="http://www.w3.org/2000/svg" width="12" height="12" viewBox="0 0 24 24"><path d="M7.33 24l-2.83-2.829 9.339-9.175-9.339-9.167 2.83-2.829 12.17 11.996z"></path></svg></button></a></li><li class=" item "><a href="/sparkinternals">Week 5 - Spark Internals<button aria-label="collapse" class="collapser"><svg xmlns="http://www.w3.org/2000/svg" width="12" height="12" viewBox="0 0 24 24"><path d="M7.33 24l-2.83-2.829 9.339-9.175-9.339-9.167 2.83-2.829 12.17 11.996z"></path></svg></button></a></li><li class=" item "><a href="/sparkAPI">Week 6 - Apache Spark APIs<button aria-label="collapse" class="collapser"><svg xmlns="http://www.w3.org/2000/svg" width="12" height="12" viewBox="0 0 24 24"><path d="M7.33 24l-2.83-2.829 9.339-9.175-9.339-9.167 2.83-2.829 12.17 11.996z"></path></svg></button></a></li><li class=" item "><a href="/spark-continued">Week 7 - Apacke Spark Hands-on<button aria-label="collapse" class="collapser"><svg xmlns="http://www.w3.org/2000/svg" width="12" height="12" viewBox="0 0 24 24"><path d="M7.33 24l-2.83-2.829 9.339-9.175-9.339-9.167 2.83-2.829 12.17 11.996z"></path></svg></button></a></li><li class=" item "><a href="/bigdatahistory">Big Data History [Optional Reading]</a></li><li class=" item "><a href="/resources">Resources/Help</a></li></ul></li><style data-emotion-css="1q387v1">.css-1q387v1{list-style:none;padding:0.5rem 0;}.css-1q387v1 hr{margin:0;padding:0;border:0;border-bottom:1px solid #ede7f3;}</style><li class="css-1q387v1 eer5zio2"><hr/></li><style data-emotion-css="1ldulps">.css-1ldulps{list-style:none;}.css-1ldulps a{color:#5c6975;-webkit-text-decoration:none;text-decoration:none;font-weight:400;padding:0.45rem 0 0.45rem 2rem;display:block;position:relative;}.css-1ldulps a:hover{color:#125fb3 !important;}.css-1ldulps a svg{float:right;margin-right:1rem;}</style><li class="css-1ldulps eer5zio0"><a href="http://localhost:8000/" to="http://localhost:8000/" target="_blank" rel="noopener noreferrer"> <!-- -->&lt;- Go Back<svg xmlns="http://www.w3.org/2000/svg" width="14" height="14" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M18 13v6a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V8a2 2 0 0 1 2-2h6"></path><polyline points="15 3 21 3 21 9"></polyline><line x1="10" y1="14" x2="21" y2="3"></line></svg> </a> </li></ul></aside></div><div class="sidebarTitle sideBarShow"><a href='#'>CEU </a><div class='greenCircle'></div><a href='#'>Courseware</a></div><style data-emotion-css="zj4uvr">.css-zj4uvr{display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-box-flex:1;-webkit-flex-grow:1;-ms-flex-positive:1;flex-grow:1;margin:0px 88px;padding-top:3rem;background:#fff;}.css-zj4uvr table tr{background:#fff;}@media only screen and (max-width:1023px){.css-zj4uvr{padding-left:0;margin:0 10px;padding-top:3rem;}}</style><main class="css-zj4uvr eso2aao1"><style data-emotion-css="14zj307">@media only screen and (max-width:50rem){.css-14zj307{width:100%;position:relative;}}</style><div class="css-14zj307 eso2aao2"><div class="titleWrapper"><style data-emotion-css="1q31z9a">.css-1q31z9a{font-size:32px;line-height:1.5;font-weight:500;border-left:2px solid #125fb3;padding:0 16px;-webkit-flex:1;-ms-flex:1;flex:1;margin-top:0;padding-top:0;color:#000;}</style><h1 class="css-1q31z9a e1uwyxyb0">Week 4 - Apache Spark</h1><style data-emotion-css="qu2iew">.css-qu2iew{padding:1rem 1.5rem;text-align:right;}.css-qu2iew a{font-size:14px;font-weight:500;line-height:1em;-webkit-text-decoration:none;text-decoration:none;color:#555;border:1px solid rgb(211,220,228);cursor:pointer;border-radius:3px;-webkit-transition:all 0.2s ease-out 0s;transition:all 0.2s ease-out 0s;-webkit-text-decoration:none;text-decoration:none;color:rgb(36,42,49);background-color:rgb(255,255,255);box-shadow:rgba(116,129,141,0.1) 0px 1px 1px 0px;height:30px;padding:5px 16px;}.css-qu2iew a:hover{background-color:rgb(245,247,249);}</style><div class="mobileView css-qu2iew e1uwyxyb1"><a href="https://github.com/zoltanctoth/ceu-cloud-bigdata-course/tree/master/apachespark.md" class="gitBtn"><img src="data:image/svg+xml;base64,PD94bWwgdmVyc2lvbj0iMS4wIiBlbmNvZGluZz0idXRmLTgiPz4NCjwhLS0gR2VuZXJhdG9yOiBBZG9iZSBJbGx1c3RyYXRvciAyMi4xLjAsIFNWRyBFeHBvcnQgUGx1Zy1JbiAuIFNWRyBWZXJzaW9uOiA2LjAwIEJ1aWxkIDApICAtLT4NCjxzdmcgdmVyc2lvbj0iMS4yIiBiYXNlUHJvZmlsZT0idGlueSIgaWQ9IkxheWVyXzEiIHhtbG5zPSJodHRwOi8vd3d3LnczLm9yZy8yMDAwL3N2ZyIgeG1sbnM6eGxpbms9Imh0dHA6Ly93d3cudzMub3JnLzE5OTkveGxpbmsiDQoJIHg9IjBweCIgeT0iMHB4IiB2aWV3Qm94PSIwIDAgMjM1MCAyMzE0LjgiIHhtbDpzcGFjZT0icHJlc2VydmUiPg0KPHBhdGggZD0iTTExNzUsMEM1MjUuOCwwLDAsNTI1LjgsMCwxMTc1YzAsNTUyLjIsMzc4LjksMTAxMC41LDg5MC4xLDExMzkuN2MtNS45LTE0LjctOC44LTM1LjMtOC44LTU1Ljh2LTE5OS44SDczNC40DQoJYy03OS4zLDAtMTUyLjgtMzUuMi0xODUuMS05OS45Yy0zOC4yLTcwLjUtNDQuMS0xNzkuMi0xNDEtMjQ2LjhjLTI5LjQtMjMuNS01LjktNDcsMjYuNC00NC4xYzYxLjcsMTcuNiwxMTEuNiw1OC44LDE1OC42LDEyMC40DQoJYzQ3LDYxLjcsNjcuNiw3Ni40LDE1NS43LDc2LjRjNDEuMSwwLDEwNS43LTIuOSwxNjQuNS0xMS44YzMyLjMtODIuMyw4OC4xLTE1NS43LDE1NS43LTE5MC45Yy0zOTMuNi00Ny01ODEuNi0yNDAuOS01ODEuNi01MDUuMw0KCWMwLTExNC42LDQ5LjktMjIzLjMsMTMyLjItMzE3LjNjLTI2LjQtOTEuMS02MS43LTI3OS4xLDExLjgtMzUyLjVjMTc2LjMsMCwyODIsMTE0LjYsMzA4LjQsMTQzLjljODguMS0yOS40LDE4NS4xLTQ3LDI4NC45LTQ3DQoJYzEwMi44LDAsMTk2LjgsMTcuNiwyODQuOSw0N2MyNi40LTI5LjQsMTMyLjItMTQzLjksMzA4LjQtMTQzLjljNzAuNSw3MC41LDM4LjIsMjYxLjQsOC44LDM1Mi41YzgyLjMsOTEuMSwxMjkuMywyMDIuNywxMjkuMywzMTcuMw0KCWMwLDI2NC40LTE4NS4xLDQ1OC4zLTU3NS43LDQ5OS40YzEwOC43LDU1LjgsMTg1LjEsMjE0LjQsMTg1LjEsMzMxLjlWMjI1NmMwLDguOC0yLjksMTcuNi0yLjksMjYuNA0KCUMyMDIxLDIxMjMuOCwyMzUwLDE2ODkuMSwyMzUwLDExNzVDMjM1MCw1MjUuOCwxODI0LjIsMCwxMTc1LDBMMTE3NSwweiIvPg0KPC9zdmc+DQo=" alt="Github logo"/> Edit on GitHub</a></div></div><style data-emotion-css="1qktglx">.css-1qktglx{max-width:750px;color:#3B454E;}.css-1qktglx ul,.css-1qktglx ol{-webkit-padding-start:40px;-moz-padding-start:40px;-o-padding-start:40px;margin:24px 0px;padding:0px 0px 0px 2em;}.css-1qktglx ul li,.css-1qktglx ol li{font-size:16px;line-height:1.8;font-weight:400;}.css-1qktglx a{-webkit-transition:color 0.15s;transition:color 0.15s;color:#1000EE;}.css-1qktglx code{border:1px solid #ede7f3;border-radius:4px;padding:2px 6px;font-size:0.9375em;background:#fff;}@media (max-width:767px){.css-1qktglx{padding:0 15px;}}</style><div class="css-1qktglx e1uwyxyb2"><h1 class="heading1" id="pythonquickguide">Python Quick Guide</h1><p class="paragraph"><strong>Variables</strong></p><style data-emotion-css="fkgcw9">.css-fkgcw9{padding:16px;background:rgb(245,247,249);}</style><pre class="css-fkgcw9 eyprwjk0"><pre><pre class="prism-code language-javascript pre" style="color:#9CDCFE;background-color:#1E1E1E" p="3"><div class="token-line"><span class="token plain"># </span><span class="token maybe-class-name">Create</span><span class="token plain"> a variable called a that points to </span><span class="token number" style="color:rgb(181, 206, 168)">1</span><span class="token plain"></span></div><div class="token-line"><span class="token plain"></span><span class="token operator" style="color:rgb(212, 212, 212)">&gt;&gt;&gt;</span><span class="token plain"> a </span><span class="token operator" style="color:rgb(212, 212, 212)">=</span><span class="token plain"> </span><span class="token number" style="color:rgb(181, 206, 168)">1</span><span class="token plain">   </span></div><div class="token-line"><span class="token plain"># </span><span class="token maybe-class-name">Create</span><span class="token plain"> another variable</span></div><div class="token-line"><span class="token plain"></span><span class="token operator" style="color:rgb(212, 212, 212)">&gt;&gt;&gt;</span><span class="token plain"> b </span><span class="token operator" style="color:rgb(212, 212, 212)">=</span><span class="token plain"> </span><span class="token number" style="color:rgb(181, 206, 168)">2</span><span class="token plain">   </span></div><div class="token-line"><span class="token plain" style="display:inline-block"></span></div><div class="token-line"><span class="token plain"># </span><span class="token maybe-class-name">Get</span><span class="token plain"> the value that the variable points to</span></div><div class="token-line"><span class="token plain"></span><span class="token operator" style="color:rgb(212, 212, 212)">&gt;&gt;&gt;</span><span class="token plain"> a       </span></div><div class="token-line"><span class="token plain"></span><span class="token number" style="color:rgb(181, 206, 168)">1</span><span class="token plain"></span></div><div class="token-line"><span class="token plain"></span><span class="token operator" style="color:rgb(212, 212, 212)">&gt;&gt;&gt;</span><span class="token plain"> b</span></div><div class="token-line"><span class="token plain"></span><span class="token number" style="color:rgb(181, 206, 168)">2</span><span class="token plain"></span></div></pre></pre></pre><p class="paragraph">Change the value of a variable after setting it:</p><pre class="css-fkgcw9 eyprwjk0"><pre><pre class="prism-code language-javascript pre" style="color:#9CDCFE;background-color:#1E1E1E" p="3"><div class="token-line"><span class="token plain"># </span><span class="token maybe-class-name">Make</span><span class="token plain"> a point to </span><span class="token number" style="color:rgb(181, 206, 168)">2</span><span class="token plain"> instead </span><span class="token keyword" style="color:rgb(86, 156, 214)">of</span><span class="token plain"> </span><span class="token number" style="color:rgb(181, 206, 168)">1</span><span class="token plain"></span></div><div class="token-line"><span class="token plain"></span><span class="token operator" style="color:rgb(212, 212, 212)">&gt;&gt;&gt;</span><span class="token plain"> a </span><span class="token operator" style="color:rgb(212, 212, 212)">=</span><span class="token plain"> </span><span class="token number" style="color:rgb(181, 206, 168)">2</span><span class="token plain">    </span></div><div class="token-line"><span class="token plain"></span><span class="token operator" style="color:rgb(212, 212, 212)">&gt;&gt;&gt;</span><span class="token plain"> a</span></div><div class="token-line"><span class="token plain"></span><span class="token number" style="color:rgb(181, 206, 168)">2</span><span class="token plain"></span></div></pre></pre></pre><p class="paragraph">We can do something with a variable on the right side, then assign the result back to the same variable on the left side.</p><pre class="css-fkgcw9 eyprwjk0"><pre><pre class="prism-code language-javascript pre" style="color:#9CDCFE;background-color:#1E1E1E" p="3"><div class="token-line"><span class="token operator" style="color:rgb(212, 212, 212)">&gt;&gt;&gt;</span><span class="token plain"> a </span><span class="token operator" style="color:rgb(212, 212, 212)">=</span><span class="token plain"> </span><span class="token number" style="color:rgb(181, 206, 168)">1</span><span class="token plain"></span></div><div class="token-line"><span class="token plain"></span><span class="token operator" style="color:rgb(212, 212, 212)">&gt;&gt;&gt;</span><span class="token plain"> a </span><span class="token operator" style="color:rgb(212, 212, 212)">=</span><span class="token plain"> a </span><span class="token operator" style="color:rgb(212, 212, 212)">+</span><span class="token plain"> </span><span class="token number" style="color:rgb(181, 206, 168)">1</span><span class="token plain"></span></div><div class="token-line"><span class="token plain"></span><span class="token operator" style="color:rgb(212, 212, 212)">&gt;&gt;&gt;</span><span class="token plain"> a</span></div><div class="token-line"><span class="token plain"></span><span class="token number" style="color:rgb(181, 206, 168)">2</span><span class="token plain"></span></div></pre></pre></pre><p class="paragraph">To do something to a variable (for example, to add something to it) we can also use +=, -=, <em>= and /= instead of +, -, </em> and /. The &quot;advanced&quot; %=, //= and **= also work.</p><pre class="css-fkgcw9 eyprwjk0"><pre><pre class="prism-code language-javascript pre" style="color:#9CDCFE;background-color:#1E1E1E" p="3"><div class="token-line"><span class="token operator" style="color:rgb(212, 212, 212)">&gt;&gt;&gt;</span><span class="token plain"> a </span><span class="token operator" style="color:rgb(212, 212, 212)">+=</span><span class="token plain"> </span><span class="token number" style="color:rgb(181, 206, 168)">2</span><span class="token plain">          # a </span><span class="token operator" style="color:rgb(212, 212, 212)">=</span><span class="token plain"> a </span><span class="token operator" style="color:rgb(212, 212, 212)">+</span><span class="token plain"> </span><span class="token number" style="color:rgb(181, 206, 168)">2</span><span class="token plain"></span></div><div class="token-line"><span class="token plain"></span><span class="token operator" style="color:rgb(212, 212, 212)">&gt;&gt;&gt;</span><span class="token plain"> a </span><span class="token operator" style="color:rgb(212, 212, 212)">-=</span><span class="token plain"> </span><span class="token number" style="color:rgb(181, 206, 168)">2</span><span class="token plain">          # a </span><span class="token operator" style="color:rgb(212, 212, 212)">=</span><span class="token plain"> a </span><span class="token operator" style="color:rgb(212, 212, 212)">-</span><span class="token plain"> </span><span class="token number" style="color:rgb(181, 206, 168)">2</span><span class="token plain"></span></div><div class="token-line"><span class="token plain"></span><span class="token operator" style="color:rgb(212, 212, 212)">&gt;&gt;&gt;</span><span class="token plain"> a </span><span class="token operator" style="color:rgb(212, 212, 212)">*=</span><span class="token plain"> </span><span class="token number" style="color:rgb(181, 206, 168)">2</span><span class="token plain">          # a </span><span class="token operator" style="color:rgb(212, 212, 212)">=</span><span class="token plain"> a </span><span class="token operator" style="color:rgb(212, 212, 212)">*</span><span class="token plain"> </span><span class="token number" style="color:rgb(181, 206, 168)">2</span><span class="token plain"></span></div><div class="token-line"><span class="token plain"></span><span class="token operator" style="color:rgb(212, 212, 212)">&gt;&gt;&gt;</span><span class="token plain"> a </span><span class="token operator" style="color:rgb(212, 212, 212)">/=</span><span class="token plain"> </span><span class="token number" style="color:rgb(181, 206, 168)">2</span><span class="token plain">          # a </span><span class="token operator" style="color:rgb(212, 212, 212)">=</span><span class="token plain"> a </span><span class="token operator" style="color:rgb(212, 212, 212)">/</span><span class="token plain"> </span><span class="token number" style="color:rgb(181, 206, 168)">2</span><span class="token plain"></span></div><div class="token-line"><span class="token plain" style="display:inline-block"></span></div><div class="token-line"><span class="token plain"># </span><span class="token maybe-class-name">Not</span><span class="token plain"> limited to int</span></div><div class="token-line"><span class="token plain"></span><span class="token operator" style="color:rgb(212, 212, 212)">&gt;&gt;&gt;</span><span class="token plain"> a </span><span class="token operator" style="color:rgb(212, 212, 212)">=</span><span class="token plain"> </span><span class="token string" style="color:rgb(206, 145, 120)">&#x27;hello&#x27;</span><span class="token plain"></span></div><div class="token-line"><span class="token plain"></span><span class="token operator" style="color:rgb(212, 212, 212)">&gt;&gt;&gt;</span><span class="token plain"> a </span><span class="token operator" style="color:rgb(212, 212, 212)">*=</span><span class="token plain"> </span><span class="token number" style="color:rgb(181, 206, 168)">3</span><span class="token plain"></span></div><div class="token-line"><span class="token plain"></span><span class="token operator" style="color:rgb(212, 212, 212)">&gt;&gt;&gt;</span><span class="token plain"> a </span><span class="token operator" style="color:rgb(212, 212, 212)">+=</span><span class="token plain"> </span><span class="token string" style="color:rgb(206, 145, 120)">&#x27;world&#x27;</span><span class="token plain"></span></div><div class="token-line"><span class="token plain"></span><span class="token operator" style="color:rgb(212, 212, 212)">&gt;&gt;&gt;</span><span class="token plain"> a</span></div><div class="token-line"><span class="token plain"></span><span class="token string" style="color:rgb(206, 145, 120)">&#x27;hellohellohelloworld&#x27;</span><span class="token plain"></span></div></pre></pre></pre><p class="paragraph"><strong>Operators</strong></p><table><thead><tr><th>Usage</th><th>Description</th><th>True examples</th></tr></thead><tbody><tr><td><code>a == b</code></td><td>a is equal to b</td><td><code>1 == 1</code></td></tr><tr><td><code>a != b</code></td><td>a is not equal to b</td><td><code>1 != 2</code></td></tr><tr><td><code>a &gt; b</code></td><td>a is greater than b</td><td><code>2 &gt; 1</code></td></tr><tr><td><code>a &gt;= b</code></td><td>a is greater than or equal to b</td><td><code>2 &gt;= 1</code>, <code>1 &gt;= 1</code></td></tr><tr><td><code>a &lt; b</code></td><td>a is less than b</td><td><code>1 &lt; 2</code></td></tr><tr><td><code>a &lt;= b</code></td><td>a is less than or equal to b</td><td><code>1 &lt;= 2</code>, <code>1 &lt;= 1</code></td></tr></tbody></table><p class="paragraph">This table assumes that a and b are Booleans.</p><table><thead><tr><th>Usage</th><th>Description</th><th>True example</th></tr></thead><tbody><tr><td><code>a and b</code></td><td>a is True and b is True</td><td><code>1 == 1 and 2 == 2</code></td></tr><tr><td><code>a or b</code></td><td>a is True, b is True or they&#x27;re both True</td><td><code>False or 1 == 1</code>, <code>True or True</code></td></tr></tbody></table><p class="paragraph"><code>not</code> can be used for negations. If <code>value</code> is True, <code>not value</code> is False, and if <code>value</code> is False, <code>not value</code> is True.</p><p class="paragraph"> <strong>If, else and elif</strong></p><pre class="css-fkgcw9 eyprwjk0"><pre><pre class="prism-code language-javascript pre" style="color:#9CDCFE;background-color:#1E1E1E" p="3"><div class="token-line"><span class="token function" style="color:rgb(220, 220, 170)">print</span><span class="token punctuation" style="color:rgb(212, 212, 212)">(</span><span class="token string" style="color:rgb(206, 145, 120)">&#x27;Hello!&#x27;</span><span class="token punctuation" style="color:rgb(212, 212, 212)">)</span><span class="token plain"></span></div><div class="token-line"><span class="token plain">something </span><span class="token operator" style="color:rgb(212, 212, 212)">=</span><span class="token plain"> </span><span class="token function" style="color:rgb(220, 220, 170)">input</span><span class="token punctuation" style="color:rgb(212, 212, 212)">(</span><span class="token string" style="color:rgb(206, 145, 120)">&quot;Enter something: &quot;</span><span class="token punctuation" style="color:rgb(212, 212, 212)">)</span><span class="token plain"></span></div><div class="token-line"><span class="token plain"></span><span class="token keyword" style="color:rgb(86, 156, 214)">if</span><span class="token plain"> something </span><span class="token operator" style="color:rgb(212, 212, 212)">=</span><span class="token plain"> </span><span class="token string" style="color:rgb(206, 145, 120)">&#x27;hello&#x27;</span><span class="token punctuation" style="color:rgb(212, 212, 212)">:</span><span class="token plain"></span></div><div class="token-line"><span class="token plain">    </span><span class="token function" style="color:rgb(220, 220, 170)">print</span><span class="token punctuation" style="color:rgb(212, 212, 212)">(</span><span class="token string" style="color:rgb(206, 145, 120)">&quot;Hello for you too!&quot;</span><span class="token punctuation" style="color:rgb(212, 212, 212)">)</span><span class="token plain"></span></div><div class="token-line"><span class="token plain" style="display:inline-block"></span></div><div class="token-line"><span class="token plain">elif something </span><span class="token operator" style="color:rgb(212, 212, 212)">=</span><span class="token plain"> </span><span class="token string" style="color:rgb(206, 145, 120)">&#x27;hi&#x27;</span><span class="token plain"></span></div><div class="token-line"><span class="token plain">    </span><span class="token function" style="color:rgb(220, 220, 170)">print</span><span class="token punctuation" style="color:rgb(212, 212, 212)">(</span><span class="token string" style="color:rgb(206, 145, 120)">&#x27;Hi there!&#x27;</span><span class="token punctuation" style="color:rgb(212, 212, 212)">)</span><span class="token plain"></span></div><div class="token-line"><span class="token plain"></span><span class="token keyword" style="color:rgb(86, 156, 214)">else</span><span class="token punctuation" style="color:rgb(212, 212, 212)">:</span><span class="token plain"></span></div><div class="token-line"><span class="token plain">    </span><span class="token function" style="color:rgb(220, 220, 170)">print</span><span class="token punctuation" style="color:rgb(212, 212, 212)">(</span><span class="token string" style="color:rgb(206, 145, 120)">&quot;I don&#x27;t know what,&quot;</span><span class="token plain"> something</span><span class="token punctuation" style="color:rgb(212, 212, 212)">,</span><span class="token plain"> </span><span class="token string" style="color:rgb(206, 145, 120)">&quot;means.&quot;</span><span class="token punctuation" style="color:rgb(212, 212, 212)">)</span><span class="token plain"></span></div></pre></pre></pre><p class="paragraph"><strong>List and list methods</strong></p><pre class="css-fkgcw9 eyprwjk0"><pre><pre class="prism-code language-javascript pre" style="color:#9CDCFE;background-color:#1E1E1E" p="3"><div class="token-line"><span class="token operator" style="color:rgb(212, 212, 212)">&gt;&gt;&gt;</span><span class="token plain"> fruits </span><span class="token operator" style="color:rgb(212, 212, 212)">=</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(212, 212, 212)">[</span><span class="token string" style="color:rgb(206, 145, 120)">&#x27;orange&#x27;</span><span class="token punctuation" style="color:rgb(212, 212, 212)">,</span><span class="token plain"> </span><span class="token string" style="color:rgb(206, 145, 120)">&#x27;apple&#x27;</span><span class="token punctuation" style="color:rgb(212, 212, 212)">,</span><span class="token plain"> </span><span class="token string" style="color:rgb(206, 145, 120)">&#x27;pear&#x27;</span><span class="token punctuation" style="color:rgb(212, 212, 212)">,</span><span class="token plain"> </span><span class="token string" style="color:rgb(206, 145, 120)">&#x27;banana&#x27;</span><span class="token punctuation" style="color:rgb(212, 212, 212)">,</span><span class="token plain"> </span><span class="token string" style="color:rgb(206, 145, 120)">&#x27;kiwi&#x27;</span><span class="token punctuation" style="color:rgb(212, 212, 212)">,</span><span class="token plain"> </span><span class="token string" style="color:rgb(206, 145, 120)">&#x27;apple&#x27;</span><span class="token punctuation" style="color:rgb(212, 212, 212)">,</span><span class="token plain"> </span><span class="token string" style="color:rgb(206, 145, 120)">&#x27;banana&#x27;</span><span class="token punctuation" style="color:rgb(212, 212, 212)">]</span><span class="token plain"></span></div><div class="token-line"><span class="token plain"></span><span class="token operator" style="color:rgb(212, 212, 212)">&gt;&gt;&gt;</span><span class="token plain"> fruits</span><span class="token punctuation" style="color:rgb(212, 212, 212)">.</span><span class="token method function property-access" style="color:rgb(220, 220, 170)">count</span><span class="token punctuation" style="color:rgb(212, 212, 212)">(</span><span class="token string" style="color:rgb(206, 145, 120)">&#x27;apple&#x27;</span><span class="token punctuation" style="color:rgb(212, 212, 212)">)</span><span class="token plain"></span></div><div class="token-line"><span class="token plain"></span><span class="token number" style="color:rgb(181, 206, 168)">2</span><span class="token plain"></span></div><div class="token-line"><span class="token plain"></span><span class="token operator" style="color:rgb(212, 212, 212)">&gt;&gt;&gt;</span><span class="token plain"> fruits</span><span class="token punctuation" style="color:rgb(212, 212, 212)">.</span><span class="token method function property-access" style="color:rgb(220, 220, 170)">count</span><span class="token punctuation" style="color:rgb(212, 212, 212)">(</span><span class="token string" style="color:rgb(206, 145, 120)">&#x27;tangerine&#x27;</span><span class="token punctuation" style="color:rgb(212, 212, 212)">)</span><span class="token plain"></span></div><div class="token-line"><span class="token plain"></span><span class="token number" style="color:rgb(181, 206, 168)">0</span><span class="token plain"></span></div><div class="token-line"><span class="token plain"></span><span class="token operator" style="color:rgb(212, 212, 212)">&gt;&gt;&gt;</span><span class="token plain"> fruits</span><span class="token punctuation" style="color:rgb(212, 212, 212)">.</span><span class="token method function property-access" style="color:rgb(220, 220, 170)">index</span><span class="token punctuation" style="color:rgb(212, 212, 212)">(</span><span class="token string" style="color:rgb(206, 145, 120)">&#x27;banana&#x27;</span><span class="token punctuation" style="color:rgb(212, 212, 212)">)</span><span class="token plain"></span></div><div class="token-line"><span class="token plain"></span><span class="token number" style="color:rgb(181, 206, 168)">3</span><span class="token plain"></span></div><div class="token-line"><span class="token plain"></span><span class="token operator" style="color:rgb(212, 212, 212)">&gt;&gt;&gt;</span><span class="token plain"> fruits</span><span class="token punctuation" style="color:rgb(212, 212, 212)">.</span><span class="token method function property-access" style="color:rgb(220, 220, 170)">index</span><span class="token punctuation" style="color:rgb(212, 212, 212)">(</span><span class="token string" style="color:rgb(206, 145, 120)">&#x27;banana&#x27;</span><span class="token punctuation" style="color:rgb(212, 212, 212)">,</span><span class="token plain"> </span><span class="token number" style="color:rgb(181, 206, 168)">4</span><span class="token punctuation" style="color:rgb(212, 212, 212)">)</span><span class="token plain">  # </span><span class="token maybe-class-name">Find</span><span class="token plain"> next banana starting a position </span><span class="token number" style="color:rgb(181, 206, 168)">4</span><span class="token plain"></span></div><div class="token-line"><span class="token plain"></span><span class="token number" style="color:rgb(181, 206, 168)">6</span><span class="token plain"></span></div><div class="token-line"><span class="token plain"></span><span class="token operator" style="color:rgb(212, 212, 212)">&gt;&gt;&gt;</span><span class="token plain"> fruits</span><span class="token punctuation" style="color:rgb(212, 212, 212)">.</span><span class="token method function property-access" style="color:rgb(220, 220, 170)">reverse</span><span class="token punctuation" style="color:rgb(212, 212, 212)">(</span><span class="token punctuation" style="color:rgb(212, 212, 212)">)</span><span class="token plain"></span></div><div class="token-line"><span class="token plain"></span><span class="token operator" style="color:rgb(212, 212, 212)">&gt;&gt;&gt;</span><span class="token plain"> fruits</span></div><div class="token-line"><span class="token plain"></span><span class="token punctuation" style="color:rgb(212, 212, 212)">[</span><span class="token string" style="color:rgb(206, 145, 120)">&#x27;banana&#x27;</span><span class="token punctuation" style="color:rgb(212, 212, 212)">,</span><span class="token plain"> </span><span class="token string" style="color:rgb(206, 145, 120)">&#x27;apple&#x27;</span><span class="token punctuation" style="color:rgb(212, 212, 212)">,</span><span class="token plain"> </span><span class="token string" style="color:rgb(206, 145, 120)">&#x27;kiwi&#x27;</span><span class="token punctuation" style="color:rgb(212, 212, 212)">,</span><span class="token plain"> </span><span class="token string" style="color:rgb(206, 145, 120)">&#x27;banana&#x27;</span><span class="token punctuation" style="color:rgb(212, 212, 212)">,</span><span class="token plain"> </span><span class="token string" style="color:rgb(206, 145, 120)">&#x27;pear&#x27;</span><span class="token punctuation" style="color:rgb(212, 212, 212)">,</span><span class="token plain"> </span><span class="token string" style="color:rgb(206, 145, 120)">&#x27;apple&#x27;</span><span class="token punctuation" style="color:rgb(212, 212, 212)">,</span><span class="token plain"> </span><span class="token string" style="color:rgb(206, 145, 120)">&#x27;orange&#x27;</span><span class="token punctuation" style="color:rgb(212, 212, 212)">]</span><span class="token plain"></span></div><div class="token-line"><span class="token plain"></span><span class="token operator" style="color:rgb(212, 212, 212)">&gt;&gt;&gt;</span><span class="token plain"> fruits</span><span class="token punctuation" style="color:rgb(212, 212, 212)">.</span><span class="token method function property-access" style="color:rgb(220, 220, 170)">append</span><span class="token punctuation" style="color:rgb(212, 212, 212)">(</span><span class="token string" style="color:rgb(206, 145, 120)">&#x27;grape&#x27;</span><span class="token punctuation" style="color:rgb(212, 212, 212)">)</span><span class="token plain"></span></div><div class="token-line"><span class="token plain"></span><span class="token operator" style="color:rgb(212, 212, 212)">&gt;&gt;&gt;</span><span class="token plain"> fruits</span></div><div class="token-line"><span class="token plain"></span><span class="token punctuation" style="color:rgb(212, 212, 212)">[</span><span class="token string" style="color:rgb(206, 145, 120)">&#x27;banana&#x27;</span><span class="token punctuation" style="color:rgb(212, 212, 212)">,</span><span class="token plain"> </span><span class="token string" style="color:rgb(206, 145, 120)">&#x27;apple&#x27;</span><span class="token punctuation" style="color:rgb(212, 212, 212)">,</span><span class="token plain"> </span><span class="token string" style="color:rgb(206, 145, 120)">&#x27;kiwi&#x27;</span><span class="token punctuation" style="color:rgb(212, 212, 212)">,</span><span class="token plain"> </span><span class="token string" style="color:rgb(206, 145, 120)">&#x27;banana&#x27;</span><span class="token punctuation" style="color:rgb(212, 212, 212)">,</span><span class="token plain"> </span><span class="token string" style="color:rgb(206, 145, 120)">&#x27;pear&#x27;</span><span class="token punctuation" style="color:rgb(212, 212, 212)">,</span><span class="token plain"> </span><span class="token string" style="color:rgb(206, 145, 120)">&#x27;apple&#x27;</span><span class="token punctuation" style="color:rgb(212, 212, 212)">,</span><span class="token plain"> </span><span class="token string" style="color:rgb(206, 145, 120)">&#x27;orange&#x27;</span><span class="token punctuation" style="color:rgb(212, 212, 212)">,</span><span class="token plain"> </span><span class="token string" style="color:rgb(206, 145, 120)">&#x27;grape&#x27;</span><span class="token punctuation" style="color:rgb(212, 212, 212)">]</span><span class="token plain"></span></div><div class="token-line"><span class="token plain"></span><span class="token operator" style="color:rgb(212, 212, 212)">&gt;&gt;&gt;</span><span class="token plain"> fruits</span><span class="token punctuation" style="color:rgb(212, 212, 212)">.</span><span class="token method function property-access" style="color:rgb(220, 220, 170)">sort</span><span class="token punctuation" style="color:rgb(212, 212, 212)">(</span><span class="token punctuation" style="color:rgb(212, 212, 212)">)</span><span class="token plain"></span></div><div class="token-line"><span class="token plain"></span><span class="token operator" style="color:rgb(212, 212, 212)">&gt;&gt;&gt;</span><span class="token plain"> fruits</span></div><div class="token-line"><span class="token plain"></span><span class="token punctuation" style="color:rgb(212, 212, 212)">[</span><span class="token string" style="color:rgb(206, 145, 120)">&#x27;apple&#x27;</span><span class="token punctuation" style="color:rgb(212, 212, 212)">,</span><span class="token plain"> </span><span class="token string" style="color:rgb(206, 145, 120)">&#x27;apple&#x27;</span><span class="token punctuation" style="color:rgb(212, 212, 212)">,</span><span class="token plain"> </span><span class="token string" style="color:rgb(206, 145, 120)">&#x27;banana&#x27;</span><span class="token punctuation" style="color:rgb(212, 212, 212)">,</span><span class="token plain"> </span><span class="token string" style="color:rgb(206, 145, 120)">&#x27;banana&#x27;</span><span class="token punctuation" style="color:rgb(212, 212, 212)">,</span><span class="token plain"> </span><span class="token string" style="color:rgb(206, 145, 120)">&#x27;grape&#x27;</span><span class="token punctuation" style="color:rgb(212, 212, 212)">,</span><span class="token plain"> </span><span class="token string" style="color:rgb(206, 145, 120)">&#x27;kiwi&#x27;</span><span class="token punctuation" style="color:rgb(212, 212, 212)">,</span><span class="token plain"> </span><span class="token string" style="color:rgb(206, 145, 120)">&#x27;orange&#x27;</span><span class="token punctuation" style="color:rgb(212, 212, 212)">,</span><span class="token plain"> </span><span class="token string" style="color:rgb(206, 145, 120)">&#x27;pear&#x27;</span><span class="token punctuation" style="color:rgb(212, 212, 212)">]</span><span class="token plain"></span></div><div class="token-line"><span class="token plain"></span><span class="token operator" style="color:rgb(212, 212, 212)">&gt;&gt;&gt;</span><span class="token plain"> fruits</span><span class="token punctuation" style="color:rgb(212, 212, 212)">.</span><span class="token method function property-access" style="color:rgb(220, 220, 170)">pop</span><span class="token punctuation" style="color:rgb(212, 212, 212)">(</span><span class="token punctuation" style="color:rgb(212, 212, 212)">)</span><span class="token plain"></span></div><div class="token-line"><span class="token plain"></span><span class="token string" style="color:rgb(206, 145, 120)">&#x27;pear&#x27;</span><span class="token plain"></span></div></pre></pre></pre><p class="paragraph"><strong>Tuples</strong>
A tuple consists of a number of values separated by commas:</p><pre class="css-fkgcw9 eyprwjk0"><pre><pre class="prism-code language-javascript pre" style="color:#9CDCFE;background-color:#1E1E1E" p="3"><div class="token-line"><span class="token plain"> </span><span class="token operator" style="color:rgb(212, 212, 212)">&gt;&gt;&gt;</span><span class="token plain"> t </span><span class="token operator" style="color:rgb(212, 212, 212)">=</span><span class="token plain"> </span><span class="token number" style="color:rgb(181, 206, 168)">12345</span><span class="token punctuation" style="color:rgb(212, 212, 212)">,</span><span class="token plain"> </span><span class="token number" style="color:rgb(181, 206, 168)">54321</span><span class="token punctuation" style="color:rgb(212, 212, 212)">,</span><span class="token plain"> </span><span class="token string" style="color:rgb(206, 145, 120)">&#x27;hello!&#x27;</span><span class="token plain"></span></div><div class="token-line"><span class="token plain"></span><span class="token operator" style="color:rgb(212, 212, 212)">&gt;&gt;&gt;</span><span class="token plain"> t</span><span class="token punctuation" style="color:rgb(212, 212, 212)">[</span><span class="token number" style="color:rgb(181, 206, 168)">0</span><span class="token punctuation" style="color:rgb(212, 212, 212)">]</span><span class="token plain"></span></div><div class="token-line"><span class="token plain"></span><span class="token number" style="color:rgb(181, 206, 168)">12345</span><span class="token plain"></span></div><div class="token-line"><span class="token plain"></span><span class="token operator" style="color:rgb(212, 212, 212)">&gt;&gt;&gt;</span><span class="token plain"> </span><span class="token function" style="color:rgb(220, 220, 170)">t</span><span class="token plain"></span></div><div class="token-line"><span class="token plain"></span><span class="token punctuation" style="color:rgb(212, 212, 212)">(</span><span class="token number" style="color:rgb(181, 206, 168)">12345</span><span class="token punctuation" style="color:rgb(212, 212, 212)">,</span><span class="token plain"> </span><span class="token number" style="color:rgb(181, 206, 168)">54321</span><span class="token punctuation" style="color:rgb(212, 212, 212)">,</span><span class="token plain"> </span><span class="token string" style="color:rgb(206, 145, 120)">&#x27;hello!&#x27;</span><span class="token punctuation" style="color:rgb(212, 212, 212)">)</span><span class="token plain"></span></div><div class="token-line"><span class="token plain"></span><span class="token operator" style="color:rgb(212, 212, 212)">&gt;&gt;&gt;</span><span class="token plain"> # </span><span class="token maybe-class-name">Tuples</span><span class="token plain"> may be nested</span><span class="token punctuation" style="color:rgb(212, 212, 212)">:</span><span class="token plain"></span></div><div class="token-line"><span class="token plain"></span><span class="token spread operator" style="color:rgb(212, 212, 212)">...</span><span class="token plain"> u </span><span class="token operator" style="color:rgb(212, 212, 212)">=</span><span class="token plain"> t</span><span class="token punctuation" style="color:rgb(212, 212, 212)">,</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(212, 212, 212)">(</span><span class="token number" style="color:rgb(181, 206, 168)">1</span><span class="token punctuation" style="color:rgb(212, 212, 212)">,</span><span class="token plain"> </span><span class="token number" style="color:rgb(181, 206, 168)">2</span><span class="token punctuation" style="color:rgb(212, 212, 212)">,</span><span class="token plain"> </span><span class="token number" style="color:rgb(181, 206, 168)">3</span><span class="token punctuation" style="color:rgb(212, 212, 212)">,</span><span class="token plain"> </span><span class="token number" style="color:rgb(181, 206, 168)">4</span><span class="token punctuation" style="color:rgb(212, 212, 212)">,</span><span class="token plain"> </span><span class="token number" style="color:rgb(181, 206, 168)">5</span><span class="token punctuation" style="color:rgb(212, 212, 212)">)</span><span class="token plain"></span></div><div class="token-line"><span class="token plain"></span><span class="token operator" style="color:rgb(212, 212, 212)">&gt;&gt;&gt;</span><span class="token plain"> </span><span class="token function" style="color:rgb(220, 220, 170)">u</span><span class="token plain"></span></div><div class="token-line"><span class="token plain"></span><span class="token punctuation" style="color:rgb(212, 212, 212)">(</span><span class="token punctuation" style="color:rgb(212, 212, 212)">(</span><span class="token number" style="color:rgb(181, 206, 168)">12345</span><span class="token punctuation" style="color:rgb(212, 212, 212)">,</span><span class="token plain"> </span><span class="token number" style="color:rgb(181, 206, 168)">54321</span><span class="token punctuation" style="color:rgb(212, 212, 212)">,</span><span class="token plain"> </span><span class="token string" style="color:rgb(206, 145, 120)">&#x27;hello!&#x27;</span><span class="token punctuation" style="color:rgb(212, 212, 212)">)</span><span class="token punctuation" style="color:rgb(212, 212, 212)">,</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(212, 212, 212)">(</span><span class="token number" style="color:rgb(181, 206, 168)">1</span><span class="token punctuation" style="color:rgb(212, 212, 212)">,</span><span class="token plain"> </span><span class="token number" style="color:rgb(181, 206, 168)">2</span><span class="token punctuation" style="color:rgb(212, 212, 212)">,</span><span class="token plain"> </span><span class="token number" style="color:rgb(181, 206, 168)">3</span><span class="token punctuation" style="color:rgb(212, 212, 212)">,</span><span class="token plain"> </span><span class="token number" style="color:rgb(181, 206, 168)">4</span><span class="token punctuation" style="color:rgb(212, 212, 212)">,</span><span class="token plain"> </span><span class="token number" style="color:rgb(181, 206, 168)">5</span><span class="token punctuation" style="color:rgb(212, 212, 212)">)</span><span class="token punctuation" style="color:rgb(212, 212, 212)">)</span><span class="token plain"></span></div><div class="token-line"><span class="token plain"></span><span class="token operator" style="color:rgb(212, 212, 212)">&gt;&gt;&gt;</span><span class="token plain"> # </span><span class="token maybe-class-name">Tuples</span><span class="token plain"> are immutable</span><span class="token punctuation" style="color:rgb(212, 212, 212)">:</span><span class="token plain"></span></div><div class="token-line"><span class="token plain"></span><span class="token spread operator" style="color:rgb(212, 212, 212)">...</span><span class="token plain"> t</span><span class="token punctuation" style="color:rgb(212, 212, 212)">[</span><span class="token number" style="color:rgb(181, 206, 168)">0</span><span class="token punctuation" style="color:rgb(212, 212, 212)">]</span><span class="token plain"> </span><span class="token operator" style="color:rgb(212, 212, 212)">=</span><span class="token plain"> </span><span class="token number" style="color:rgb(181, 206, 168)">88888</span><span class="token plain"></span></div><div class="token-line"><span class="token plain"></span><span class="token function maybe-class-name" style="color:rgb(220, 220, 170)">Traceback</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(212, 212, 212)">(</span><span class="token plain">most recent call last</span><span class="token punctuation" style="color:rgb(212, 212, 212)">)</span><span class="token punctuation" style="color:rgb(212, 212, 212)">:</span><span class="token plain"></span></div><div class="token-line"><span class="token plain">  </span><span class="token maybe-class-name">File</span><span class="token plain"> </span><span class="token string" style="color:rgb(206, 145, 120)">&quot;&lt;stdin&gt;&quot;</span><span class="token punctuation" style="color:rgb(212, 212, 212)">,</span><span class="token plain"> line </span><span class="token number" style="color:rgb(181, 206, 168)">1</span><span class="token punctuation" style="color:rgb(212, 212, 212)">,</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(86, 156, 214)">in</span><span class="token plain"> </span><span class="token operator" style="color:rgb(212, 212, 212)">&lt;</span><span class="token plain">module</span><span class="token operator" style="color:rgb(212, 212, 212)">&gt;</span><span class="token plain"></span></div><div class="token-line"><span class="token plain"></span><span class="token known-class-name class-name" style="color:rgb(78, 201, 176)">TypeError</span><span class="token punctuation" style="color:rgb(212, 212, 212)">:</span><span class="token plain"> </span><span class="token string" style="color:rgb(206, 145, 120)">&#x27;tuple&#x27;</span><span class="token plain"> object does not support item assignment</span></div><div class="token-line"><span class="token plain"></span><span class="token operator" style="color:rgb(212, 212, 212)">&gt;&gt;&gt;</span><span class="token plain"> # but they can contain mutable objects</span><span class="token punctuation" style="color:rgb(212, 212, 212)">:</span><span class="token plain"></span></div><div class="token-line"><span class="token plain"></span><span class="token spread operator" style="color:rgb(212, 212, 212)">...</span><span class="token plain"> v </span><span class="token operator" style="color:rgb(212, 212, 212)">=</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(212, 212, 212)">(</span><span class="token punctuation" style="color:rgb(212, 212, 212)">[</span><span class="token number" style="color:rgb(181, 206, 168)">1</span><span class="token punctuation" style="color:rgb(212, 212, 212)">,</span><span class="token plain"> </span><span class="token number" style="color:rgb(181, 206, 168)">2</span><span class="token punctuation" style="color:rgb(212, 212, 212)">,</span><span class="token plain"> </span><span class="token number" style="color:rgb(181, 206, 168)">3</span><span class="token punctuation" style="color:rgb(212, 212, 212)">]</span><span class="token punctuation" style="color:rgb(212, 212, 212)">,</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(212, 212, 212)">[</span><span class="token number" style="color:rgb(181, 206, 168)">3</span><span class="token punctuation" style="color:rgb(212, 212, 212)">,</span><span class="token plain"> </span><span class="token number" style="color:rgb(181, 206, 168)">2</span><span class="token punctuation" style="color:rgb(212, 212, 212)">,</span><span class="token plain"> </span><span class="token number" style="color:rgb(181, 206, 168)">1</span><span class="token punctuation" style="color:rgb(212, 212, 212)">]</span><span class="token punctuation" style="color:rgb(212, 212, 212)">)</span><span class="token plain"></span></div><div class="token-line"><span class="token plain"></span><span class="token operator" style="color:rgb(212, 212, 212)">&gt;&gt;&gt;</span><span class="token plain"> </span><span class="token function" style="color:rgb(220, 220, 170)">v</span><span class="token plain"></span></div><div class="token-line"><span class="token plain"></span><span class="token punctuation" style="color:rgb(212, 212, 212)">(</span><span class="token punctuation" style="color:rgb(212, 212, 212)">[</span><span class="token number" style="color:rgb(181, 206, 168)">1</span><span class="token punctuation" style="color:rgb(212, 212, 212)">,</span><span class="token plain"> </span><span class="token number" style="color:rgb(181, 206, 168)">2</span><span class="token punctuation" style="color:rgb(212, 212, 212)">,</span><span class="token plain"> </span><span class="token number" style="color:rgb(181, 206, 168)">3</span><span class="token punctuation" style="color:rgb(212, 212, 212)">]</span><span class="token punctuation" style="color:rgb(212, 212, 212)">,</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(212, 212, 212)">[</span><span class="token number" style="color:rgb(181, 206, 168)">3</span><span class="token punctuation" style="color:rgb(212, 212, 212)">,</span><span class="token plain"> </span><span class="token number" style="color:rgb(181, 206, 168)">2</span><span class="token punctuation" style="color:rgb(212, 212, 212)">,</span><span class="token plain"> </span><span class="token number" style="color:rgb(181, 206, 168)">1</span><span class="token punctuation" style="color:rgb(212, 212, 212)">]</span><span class="token punctuation" style="color:rgb(212, 212, 212)">)</span><span class="token plain"></span></div></pre></pre></pre><p class="paragraph"><strong>Sets</strong></p><pre class="css-fkgcw9 eyprwjk0"><pre><pre class="prism-code language-javascript pre" style="color:#9CDCFE;background-color:#1E1E1E" p="3"><div class="token-line"><span class="token operator" style="color:rgb(212, 212, 212)">&gt;&gt;&gt;</span><span class="token plain"> basket </span><span class="token operator" style="color:rgb(212, 212, 212)">=</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(212, 212, 212)">{</span><span class="token string" style="color:rgb(206, 145, 120)">&#x27;apple&#x27;</span><span class="token punctuation" style="color:rgb(212, 212, 212)">,</span><span class="token plain"> </span><span class="token string" style="color:rgb(206, 145, 120)">&#x27;orange&#x27;</span><span class="token punctuation" style="color:rgb(212, 212, 212)">,</span><span class="token plain"> </span><span class="token string" style="color:rgb(206, 145, 120)">&#x27;apple&#x27;</span><span class="token punctuation" style="color:rgb(212, 212, 212)">,</span><span class="token plain"> </span><span class="token string" style="color:rgb(206, 145, 120)">&#x27;pear&#x27;</span><span class="token punctuation" style="color:rgb(212, 212, 212)">,</span><span class="token plain"> </span><span class="token string" style="color:rgb(206, 145, 120)">&#x27;orange&#x27;</span><span class="token punctuation" style="color:rgb(212, 212, 212)">,</span><span class="token plain"> </span><span class="token string" style="color:rgb(206, 145, 120)">&#x27;banana&#x27;</span><span class="token punctuation" style="color:rgb(212, 212, 212)">}</span><span class="token plain"></span></div><div class="token-line"><span class="token plain"></span><span class="token operator" style="color:rgb(212, 212, 212)">&gt;&gt;&gt;</span><span class="token plain"> </span><span class="token function" style="color:rgb(220, 220, 170)">print</span><span class="token punctuation" style="color:rgb(212, 212, 212)">(</span><span class="token plain">basket</span><span class="token punctuation" style="color:rgb(212, 212, 212)">)</span><span class="token plain">                      # show that duplicates have been removed</span></div><div class="token-line"><span class="token plain"></span><span class="token punctuation" style="color:rgb(212, 212, 212)">{</span><span class="token string" style="color:rgb(206, 145, 120)">&#x27;orange&#x27;</span><span class="token punctuation" style="color:rgb(212, 212, 212)">,</span><span class="token plain"> </span><span class="token string" style="color:rgb(206, 145, 120)">&#x27;banana&#x27;</span><span class="token punctuation" style="color:rgb(212, 212, 212)">,</span><span class="token plain"> </span><span class="token string" style="color:rgb(206, 145, 120)">&#x27;pear&#x27;</span><span class="token punctuation" style="color:rgb(212, 212, 212)">,</span><span class="token plain"> </span><span class="token string" style="color:rgb(206, 145, 120)">&#x27;apple&#x27;</span><span class="token punctuation" style="color:rgb(212, 212, 212)">}</span><span class="token plain"></span></div><div class="token-line"><span class="token plain"></span><span class="token operator" style="color:rgb(212, 212, 212)">&gt;&gt;&gt;</span><span class="token plain"> </span><span class="token string" style="color:rgb(206, 145, 120)">&#x27;orange&#x27;</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(86, 156, 214)">in</span><span class="token plain"> basket                 # fast membership testing</span></div><div class="token-line"><span class="token plain"></span><span class="token maybe-class-name">True</span><span class="token plain"></span></div><div class="token-line"><span class="token plain"></span><span class="token operator" style="color:rgb(212, 212, 212)">&gt;&gt;&gt;</span><span class="token plain"> </span><span class="token string" style="color:rgb(206, 145, 120)">&#x27;crabgrass&#x27;</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(86, 156, 214)">in</span><span class="token plain"> basket</span></div><div class="token-line"><span class="token plain"></span><span class="token maybe-class-name">False</span><span class="token plain"></span></div></pre></pre></pre><p class="paragraph"><strong>Dictionaries</strong></p><pre class="css-fkgcw9 eyprwjk0"><pre><pre class="prism-code language-javascript pre" style="color:#9CDCFE;background-color:#1E1E1E" p="3"><div class="token-line"><span class="token operator" style="color:rgb(212, 212, 212)">&gt;&gt;&gt;</span><span class="token plain"> tel </span><span class="token operator" style="color:rgb(212, 212, 212)">=</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(212, 212, 212)">{</span><span class="token string" style="color:rgb(206, 145, 120)">&#x27;jack&#x27;</span><span class="token punctuation" style="color:rgb(212, 212, 212)">:</span><span class="token plain"> </span><span class="token number" style="color:rgb(181, 206, 168)">4098</span><span class="token punctuation" style="color:rgb(212, 212, 212)">,</span><span class="token plain"> </span><span class="token string" style="color:rgb(206, 145, 120)">&#x27;sape&#x27;</span><span class="token punctuation" style="color:rgb(212, 212, 212)">:</span><span class="token plain"> </span><span class="token number" style="color:rgb(181, 206, 168)">4139</span><span class="token punctuation" style="color:rgb(212, 212, 212)">}</span><span class="token plain"></span></div><div class="token-line"><span class="token plain"></span><span class="token operator" style="color:rgb(212, 212, 212)">&gt;&gt;&gt;</span><span class="token plain"> tel</span><span class="token punctuation" style="color:rgb(212, 212, 212)">[</span><span class="token string" style="color:rgb(206, 145, 120)">&#x27;guido&#x27;</span><span class="token punctuation" style="color:rgb(212, 212, 212)">]</span><span class="token plain"> </span><span class="token operator" style="color:rgb(212, 212, 212)">=</span><span class="token plain"> </span><span class="token number" style="color:rgb(181, 206, 168)">4127</span><span class="token plain"></span></div><div class="token-line"><span class="token plain"></span><span class="token operator" style="color:rgb(212, 212, 212)">&gt;&gt;&gt;</span><span class="token plain"> tel</span></div><div class="token-line"><span class="token plain"></span><span class="token punctuation" style="color:rgb(212, 212, 212)">{</span><span class="token string" style="color:rgb(206, 145, 120)">&#x27;jack&#x27;</span><span class="token punctuation" style="color:rgb(212, 212, 212)">:</span><span class="token plain"> </span><span class="token number" style="color:rgb(181, 206, 168)">4098</span><span class="token punctuation" style="color:rgb(212, 212, 212)">,</span><span class="token plain"> </span><span class="token string" style="color:rgb(206, 145, 120)">&#x27;sape&#x27;</span><span class="token punctuation" style="color:rgb(212, 212, 212)">:</span><span class="token plain"> </span><span class="token number" style="color:rgb(181, 206, 168)">4139</span><span class="token punctuation" style="color:rgb(212, 212, 212)">,</span><span class="token plain"> </span><span class="token string" style="color:rgb(206, 145, 120)">&#x27;guido&#x27;</span><span class="token punctuation" style="color:rgb(212, 212, 212)">:</span><span class="token plain"> </span><span class="token number" style="color:rgb(181, 206, 168)">4127</span><span class="token punctuation" style="color:rgb(212, 212, 212)">}</span><span class="token plain"></span></div><div class="token-line"><span class="token plain"></span><span class="token operator" style="color:rgb(212, 212, 212)">&gt;&gt;&gt;</span><span class="token plain"> tel</span><span class="token punctuation" style="color:rgb(212, 212, 212)">[</span><span class="token string" style="color:rgb(206, 145, 120)">&#x27;jack&#x27;</span><span class="token punctuation" style="color:rgb(212, 212, 212)">]</span><span class="token plain"></span></div><div class="token-line"><span class="token plain"></span><span class="token number" style="color:rgb(181, 206, 168)">4098</span><span class="token plain"></span></div><div class="token-line"><span class="token plain"></span><span class="token operator" style="color:rgb(212, 212, 212)">&gt;&gt;&gt;</span><span class="token plain"> del tel</span><span class="token punctuation" style="color:rgb(212, 212, 212)">[</span><span class="token string" style="color:rgb(206, 145, 120)">&#x27;sape&#x27;</span><span class="token punctuation" style="color:rgb(212, 212, 212)">]</span><span class="token plain"></span></div><div class="token-line"><span class="token plain"></span><span class="token operator" style="color:rgb(212, 212, 212)">&gt;&gt;&gt;</span><span class="token plain"> tel</span><span class="token punctuation" style="color:rgb(212, 212, 212)">[</span><span class="token string" style="color:rgb(206, 145, 120)">&#x27;irv&#x27;</span><span class="token punctuation" style="color:rgb(212, 212, 212)">]</span><span class="token plain"> </span><span class="token operator" style="color:rgb(212, 212, 212)">=</span><span class="token plain"> </span><span class="token number" style="color:rgb(181, 206, 168)">4127</span><span class="token plain"></span></div><div class="token-line"><span class="token plain"></span><span class="token operator" style="color:rgb(212, 212, 212)">&gt;&gt;&gt;</span><span class="token plain"> tel</span></div><div class="token-line"><span class="token plain"></span><span class="token punctuation" style="color:rgb(212, 212, 212)">{</span><span class="token string" style="color:rgb(206, 145, 120)">&#x27;jack&#x27;</span><span class="token punctuation" style="color:rgb(212, 212, 212)">:</span><span class="token plain"> </span><span class="token number" style="color:rgb(181, 206, 168)">4098</span><span class="token punctuation" style="color:rgb(212, 212, 212)">,</span><span class="token plain"> </span><span class="token string" style="color:rgb(206, 145, 120)">&#x27;guido&#x27;</span><span class="token punctuation" style="color:rgb(212, 212, 212)">:</span><span class="token plain"> </span><span class="token number" style="color:rgb(181, 206, 168)">4127</span><span class="token punctuation" style="color:rgb(212, 212, 212)">,</span><span class="token plain"> </span><span class="token string" style="color:rgb(206, 145, 120)">&#x27;irv&#x27;</span><span class="token punctuation" style="color:rgb(212, 212, 212)">:</span><span class="token plain"> </span><span class="token number" style="color:rgb(181, 206, 168)">4127</span><span class="token punctuation" style="color:rgb(212, 212, 212)">}</span><span class="token plain"></span></div></pre></pre></pre><p class="paragraph"><strong>For loop</strong></p><pre class="css-fkgcw9 eyprwjk0"><pre><pre class="prism-code language-javascript pre" style="color:#9CDCFE;background-color:#1E1E1E" p="3"><div class="token-line"><span class="token keyword" style="color:rgb(86, 156, 214)">for</span><span class="token plain"> x </span><span class="token keyword" style="color:rgb(86, 156, 214)">in</span><span class="token plain"> </span><span class="token function" style="color:rgb(220, 220, 170)">range</span><span class="token punctuation" style="color:rgb(212, 212, 212)">(</span><span class="token number" style="color:rgb(181, 206, 168)">6</span><span class="token punctuation" style="color:rgb(212, 212, 212)">)</span><span class="token punctuation" style="color:rgb(212, 212, 212)">:</span><span class="token plain"></span></div><div class="token-line"><span class="token plain">  </span><span class="token function" style="color:rgb(220, 220, 170)">print</span><span class="token punctuation" style="color:rgb(212, 212, 212)">(</span><span class="token plain">x</span><span class="token punctuation" style="color:rgb(212, 212, 212)">)</span><span class="token plain"></span></div></pre></pre></pre><p class="paragraph"><strong>While, break</strong></p><pre class="css-fkgcw9 eyprwjk0"><pre><pre class="prism-code language-javascript pre" style="color:#9CDCFE;background-color:#1E1E1E" p="3"><div class="token-line"><span class="token plain">i </span><span class="token operator" style="color:rgb(212, 212, 212)">=</span><span class="token plain"> </span><span class="token number" style="color:rgb(181, 206, 168)">1</span><span class="token plain"></span></div><div class="token-line"><span class="token plain"></span><span class="token keyword" style="color:rgb(86, 156, 214)">while</span><span class="token plain"> i </span><span class="token operator" style="color:rgb(212, 212, 212)">&lt;</span><span class="token plain"> </span><span class="token number" style="color:rgb(181, 206, 168)">6</span><span class="token punctuation" style="color:rgb(212, 212, 212)">:</span><span class="token plain"></span></div><div class="token-line"><span class="token plain">  </span><span class="token function" style="color:rgb(220, 220, 170)">print</span><span class="token punctuation" style="color:rgb(212, 212, 212)">(</span><span class="token plain">i</span><span class="token punctuation" style="color:rgb(212, 212, 212)">)</span><span class="token plain"></span></div><div class="token-line"><span class="token plain">  </span><span class="token keyword" style="color:rgb(86, 156, 214)">if</span><span class="token plain"> i </span><span class="token operator" style="color:rgb(212, 212, 212)">==</span><span class="token plain"> </span><span class="token number" style="color:rgb(181, 206, 168)">3</span><span class="token punctuation" style="color:rgb(212, 212, 212)">:</span><span class="token plain"></span></div><div class="token-line"><span class="token plain">    </span><span class="token keyword" style="color:rgb(86, 156, 214)">break</span><span class="token plain"></span></div></pre></pre></pre><p class="paragraph"><strong>Functions</strong></p><pre class="css-fkgcw9 eyprwjk0"><pre><pre class="prism-code language-javascript pre" style="color:#9CDCFE;background-color:#1E1E1E" p="3"><div class="token-line"><span class="token plain">@</span><span class="token function" style="color:rgb(220, 220, 170)">f1</span><span class="token punctuation" style="color:rgb(212, 212, 212)">(</span><span class="token plain">arg</span><span class="token punctuation" style="color:rgb(212, 212, 212)">)</span><span class="token plain"></span></div><div class="token-line"><span class="token plain">@f2</span></div><div class="token-line"><span class="token plain">def </span><span class="token function" style="color:rgb(220, 220, 170)">func</span><span class="token punctuation" style="color:rgb(212, 212, 212)">(</span><span class="token punctuation" style="color:rgb(212, 212, 212)">)</span><span class="token punctuation" style="color:rgb(212, 212, 212)">:</span><span class="token plain"> pass</span></div><div class="token-line"><span class="token plain" style="display:inline-block"></span></div><div class="token-line"><span class="token plain"># </span><span class="token maybe-class-name">Equivalent</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(86, 156, 214)">of</span><span class="token punctuation" style="color:rgb(212, 212, 212)">:</span><span class="token plain"> </span></div><div class="token-line"><span class="token plain">def </span><span class="token function" style="color:rgb(220, 220, 170)">func</span><span class="token punctuation" style="color:rgb(212, 212, 212)">(</span><span class="token punctuation" style="color:rgb(212, 212, 212)">)</span><span class="token punctuation" style="color:rgb(212, 212, 212)">:</span><span class="token plain"> pass</span></div><div class="token-line"><span class="token plain">func </span><span class="token operator" style="color:rgb(212, 212, 212)">=</span><span class="token plain"> </span><span class="token function" style="color:rgb(220, 220, 170)">f1</span><span class="token punctuation" style="color:rgb(212, 212, 212)">(</span><span class="token plain">arg</span><span class="token punctuation" style="color:rgb(212, 212, 212)">)</span><span class="token punctuation" style="color:rgb(212, 212, 212)">(</span><span class="token function" style="color:rgb(220, 220, 170)">f2</span><span class="token punctuation" style="color:rgb(212, 212, 212)">(</span><span class="token plain">func</span><span class="token punctuation" style="color:rgb(212, 212, 212)">)</span><span class="token punctuation" style="color:rgb(212, 212, 212)">)</span><span class="token plain"></span></div><div class="token-line"><span class="token plain" style="display:inline-block"></span></div><div class="token-line"><span class="token plain"># </span><span class="token constant" style="color:rgb(100, 102, 149)">E</span><span class="token punctuation" style="color:rgb(212, 212, 212)">.</span><span class="token constant" style="color:rgb(100, 102, 149)">G</span><span class="token plain"></span></div><div class="token-line"><span class="token plain">def </span><span class="token function" style="color:rgb(220, 220, 170)">whats_on_the_telly</span><span class="token punctuation" style="color:rgb(212, 212, 212)">(</span><span class="token plain">penguin</span><span class="token operator" style="color:rgb(212, 212, 212)">=</span><span class="token maybe-class-name">None</span><span class="token punctuation" style="color:rgb(212, 212, 212)">)</span><span class="token punctuation" style="color:rgb(212, 212, 212)">:</span><span class="token plain"></span></div><div class="token-line"><span class="token plain">    </span><span class="token keyword" style="color:rgb(86, 156, 214)">if</span><span class="token plain"> penguin is </span><span class="token maybe-class-name">None</span><span class="token punctuation" style="color:rgb(212, 212, 212)">:</span><span class="token plain"></span></div><div class="token-line"><span class="token plain">        penguin </span><span class="token operator" style="color:rgb(212, 212, 212)">=</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(212, 212, 212)">[</span><span class="token punctuation" style="color:rgb(212, 212, 212)">]</span><span class="token plain"></span></div><div class="token-line"><span class="token plain">    penguin</span><span class="token punctuation" style="color:rgb(212, 212, 212)">.</span><span class="token method function property-access" style="color:rgb(220, 220, 170)">append</span><span class="token punctuation" style="color:rgb(212, 212, 212)">(</span><span class="token string" style="color:rgb(206, 145, 120)">&quot;property of the zoo&quot;</span><span class="token punctuation" style="color:rgb(212, 212, 212)">)</span><span class="token plain"></span></div><div class="token-line"><span class="token plain">    </span><span class="token keyword" style="color:rgb(86, 156, 214)">return</span><span class="token plain"> penguin</span></div></pre></pre></pre><hr/><h1 class="heading1" id="hdfsarchitecture(hadoopdistributedfilesystem)">HDFS Architecture (Hadoop Distributed File System)</h1><ul><li>HDFS Architecture Guide: <a href="https://hadoop.apache.org/docs/r1.2.1/hdfs_design.html" target="_blank" rel="noopener noreferrer">https://hadoop.apache.org/docs/r1.2.1/hdfs_design.html</a></li><li>ZooKeeper: <a href="http://zookeeper.apache.org/" target="_blank" rel="noopener noreferrer">http://zookeeper.apache.org/</a></li></ul><p class="paragraph"><strong>Ecosystem:</strong></p><p class="paragraph"><img src="https://2.bp.blogspot.com/-w7KeAnwWnBQ/WfYBJzgtvQI/AAAAAAAAAMk/D58SpZfK7lkJ8QnKnQZW268mKzRvuOOnACLcBGAs/s1600/HadoopStack.png"/></p><h1 class="heading1" id="introduction">Introduction</h1><ul><li>HDFS is a distributed file system - think of it as a bunch of computers networked together that form a cluster</li><li>HDFS is designed to have a master-slave architecture, there is one master and slaves</li><li>The Hadoop master is called the Name Node. The name &quot;Name Node&quot; is telling - it <strong>stores names and manages file system namespace</strong></li><li>Slaves are called Data Node - The name &quot;Data Node&quot; is telling - <strong>it manages the data of the file</strong></li><li>since HDFS is a File System - we can create directories and files using HDFS</li></ul><blockquote><p class="paragraph">Q: What happens when we create a file in HDFS?</p><ul><li>The Hadoop Client will send the request to the Name Node saying &quot;Hey, I&#x27;d like to create this file&quot;<ul><li>The Client will also provide the Client directory name and the file name</li></ul></li><li>When receiving the request, the Name Node will perform various checks e.g whether the directory already exists / not, whether the client has the right permissions or not to create the file etc. <ul><li>Name Node can perform these checks because it maintains an image of the entire HDFS namespace in memory (We call it <strong>in memory fsimage</strong> or file system image)</li></ul></li><li>If all the checks passed then the Name Node will create an entry for the new file and return success (to the client) so the file name creation ended, however it is empty.</li><li>We have not started writing data to the file yet</li><li>The vlient will create an fs data output stream and start writing data to it (hadoop streamer class - it buffers the data locally until you have a reasonable amount of data) - We call this a block. An HDFS data block.</li><li>These HDFS block reaches out to Name Node asking for a block allocation (Asking the Name Node &quot;Hey where do I store this block?&quot;)</li><li>The Name Node doesn&#x27;t store data, however it knows the amount of free disk space at each data node so it assigns a data node to store that block (128 MB . block usually - you can change it)</li><li>So the Name Node will send back the data node name to the streamer</li><li>Now the streamer knows where to send the data block and it sends it to the Data Node</li><li>If the file is larger than 1 block, the streamer will reach out to the Name Node again for a new block allocation (may assign a different Data Node) - so the next block might go to a different Data Node.</li><li>Once writing of the file is finished, the Name Node will commit all the changes</li></ul></blockquote><h1 class="heading1" id="faulttolerance">Fault Tolerance</h1><ul><li>If some Data Nodes fail, what happens to your file?</li><li>Hadoop creates a back up copy of each block and keeps it on some other Data Nodes</li><li>If one copy is not available, you can read it from another copy</li><li>In Hadoop we call this <strong>replication factor = 2</strong></li><li>We can set this replication factor on file to file basis and can change it even after creating a file </li><li>Replication factor of 2 will create 2 copies of each block and Hadoop will keep these two blocks on two different machines</li><li>Typically we set this replication faoctor to 3</li></ul><blockquote><p class="paragraph">What happens if the entire rack fails?</p><ul><li>All three copies would be gone</li><li>Now, you can configure Hadoop to be Rack Aware - then Hadoop wil place at least 1 copy in a different rack to protect you from rack failures</li><li>Each Data Node sends a periodic heartbeat to Name Node and spot all Data Nodes that failed</li><li>In such case the Name Node will initiate the replication of the block and bring it back to three replicas</li><li>So the Name Node continously tracks the replication of each block and initiates replication when necessary</li><li>The problem is that replication factor reduces the storage capacity of your cluster and increases the cost</li><li>Hadoop offers Storage Policies and Erasure Coding as an alternative to replication - however replication is the traditional method</li><li>High Availability refers to the uptime of the system - shows the percentage of time the service is up. </li><li>every enterprise wants a 99.999% uptime for their critical systems </li><li>So note that block failures do not take your cluster down, do not affect availability</li><li>However, when Name Node fails we cannot use the Hadoop cluster - we cannot read/write anything to the cluster</li><li>So the Name Node is a single point of failure SPOF in the Hadoop cluster</li><li>So we want to be protected against Name Node failures - the solution is Backup</li><li>In this case we need to make a backup of the HDFS Namespace information and the standby Name Node machine </li></ul></blockquote><h1 class="heading1" id="hdfsgoals">HDFS Goals</h1><p class="paragraph"> <strong>Hardware Failure</strong>
Hardware failure is the norm rather than the exception. An HDFS instance may consist of hundreds or thousands of server machines, each storing part of the file system’s data. The fact that there are a huge number of components and that each component has a non-trivial probability of failure means that some component of HDFS is always non-functional. Therefore, detection of faults and quick, automatic recovery from them is a core architectural goal of HDFS.</p><p class="paragraph"><strong>Streaming Data Access</strong>
Applications that run on HDFS need streaming access to their data sets. They are not general purpose applications that typically run on general purpose file systems. HDFS is designed more for batch processing rather than interactive use by users. The emphasis is on high throughput of data access rather than low latency of data access. POSIX imposes many hard requirements that are not needed for applications that are targeted for HDFS. POSIX semantics in a few key areas has been traded to increase data throughput rates.</p><p class="paragraph"><strong>Large Data Sets</strong>
Applications that run on HDFS have large data sets. A typical file in HDFS is gigabytes to terabytes in size. Thus, HDFS is tuned to support large files. It should provide high aggregate data band and scale to hundreds of nodes in a single cluster. It should support tens of millions of files in a single instance.</p><p class="paragraph"><strong>Simple Coherency Model</strong>
HDFS applications need a write-once-read-many access model for files. A file once created, written, and closed need not be changed. This assumption simplifies data coherency issues and enables high throughput data access. A MapReduce application or a web crawler application fits perfectly with this model. There is a plan to support appending-writes to files in the future.</p><p class="paragraph"><strong>“Moving Computation is Cheaper than Moving Data”</strong>
A computation requested by an application is much more efficient if it is executed near the data it operates on. This is especially true when the size of the data set is huge. This minimizes network congestion and increases the overall throughput of the system. The assumption is that it is often better to migrate the computation closer to where the data is located rather than moving the data to where the application is running. HDFS provides interfaces for applications to move themselves closer to where the data is located.</p><p class="paragraph"><strong>Portability Across Heterogeneous Hardware and Software Platforms</strong>
HDFS has been designed to be easily portable from one platform to another. This facilitates widespread adoption of HDFS as a platform of choice for a large set of applications.</p><h1 class="heading1" id="namenodeanddatanodes">NameNode and DataNodes</h1><p class="paragraph">HDFS has a master/slave architecture. An HDFS cluster consists of a single NameNode, a master server that manages the file system namespace and regulates access to files by clients. In addition, there are a number of DataNodes, usually one per node in the cluster, which manage storage attached to the nodes that they run on. HDFS exposes a file system namespace and allows user data to be stored in files. Internally, a file is split into one or more blocks and these blocks are stored in a set of DataNodes. The NameNode executes file system namespace operations like opening, closing, and renaming files and directories. It also determines the mapping of blocks to DataNodes. The DataNodes are responsible for serving read and write requests from the file system’s clients. The DataNodes also perform block creation, deletion, and replication upon instruction from the NameNode.</p><p class="paragraph">![](<a href="https://hadoop.apache.org/docs/r1.2.1/images/hdfsarchitecture.gif%22" target="_blank" rel="noopener noreferrer">https://hadoop.apache.org/docs/r1.2.1/images/hdfsarchitecture.gif&quot;</a> =&quot;900&quot;&gt;</p><h1 class="heading1" id="datareplication">Data Replication</h1><ul><li>HDFS is designed to reliably store very large files across machines in a large cluster. It stores each file as a sequence of blocks. The blocks of a file are replicated for fault tolerance. The block size and replication factor are configurable per file</li><li>All blocks in a file except the last block are the same size, while users can start a new block without filling out the last block to the configured block size after the support for variable length block was added to append and hsync.</li><li>An application can specify the number of replicas of a file. The replication factor can be specified at file creation time and can be changed later. Files in HDFS are write-once (except for appends and truncates) and have strictly one writer at any time</li><li>The NameNode makes all decisions regarding replication of blocks. It periodically receives a Heartbeat and a Blockreport from each of the DataNodes in the cluster. Receipt of a Heartbeat implies that the DataNode is functioning properly. A Blockreport contains a list of all blocks on a DataNode</li></ul><p class="paragraph">![](<a href="https://hadoop.apache.org/docs/r1.2.1/images/hdfsdatanodes.gif%22" target="_blank" rel="noopener noreferrer">https://hadoop.apache.org/docs/r1.2.1/images/hdfsdatanodes.gif&quot;</a> </p><h1 class="heading1" id="robustness">Robustness</h1><p class="paragraph">The primary objective of HDFS is to store data reliably even in the presence of failures. The three common types of failures are NameNode failures, DataNode failures and network partitions.</p><p class="paragraph"><strong>Data Disk Failure, Heartbeats and Re-Replication</strong>
Each DataNode sends a Heartbeat message to the NameNode periodically. A network partition can cause a subset of DataNodes to lose connectivity with the NameNode. The NameNode detects this condition by the absence of a Heartbeat message. The NameNode marks DataNodes without recent Heartbeats as dead and does not forward any new IO requests to them. Any data that was registered to a dead DataNode is not available to HDFS any more. DataNode death may cause the replication factor of some blocks to fall below their specified value. The NameNode constantly tracks which blocks need to be replicated and initiates replication whenever necessary. The necessity for re-replication may arise due to many reasons: a DataNode may become unavailable, a replica may become corrupted, a hard disk on a DataNode may fail, or the replication factor of a file may be increased.</p><p class="paragraph"><strong>Cluster Rebalancing</strong>
The HDFS architecture is compatible with data rebalancing schemes. A scheme might automatically move data from one DataNode to another if the free space on a DataNode falls below a certain threshold. In the event of a sudden high demand for a particular file, a scheme might dynamically create additional replicas and rebalance other data in the cluster. These types of data rebalancing schemes are not yet implemented.</p><p class="paragraph"><strong>Data Integrity</strong>
It is possible that a block of data fetched from a DataNode arrives corrupted. This corruption can occur because of faults in a storage device, network faults, or buggy software. The HDFS client software implements checksum checking on the contents of HDFS files. When a client creates an HDFS file, it computes a checksum of each block of the file and stores these checksums in a separate hidden file in the same HDFS namespace. When a client retrieves file contents it verifies that the data it received from each DataNode matches the checksum stored in the associated checksum file. If not, then the client can opt to retrieve that block from another DataNode that has a replica of that block.</p><p class="paragraph"><strong>Metadata Disk Failure</strong>
The FsImage and the EditLog are central data structures of HDFS. A corruption of these files can cause the HDFS instance to be non-functional. For this reason, the NameNode can be configured to support maintaining multiple copies of the FsImage and EditLog. Any update to either the FsImage or EditLog causes each of the FsImages and EditLogs to get updated synchronously. This synchronous updating of multiple copies of the FsImage and EditLog may degrade the rate of namespace transactions per second that a NameNode can support. However, this degradation is acceptable because even though HDFS applications are very data intensive in nature, they are not metadata intensive. When a NameNode restarts, it selects the latest consistent FsImage and EditLog to use.</p><p class="paragraph">The NameNode machine is a single point of failure for an HDFS cluster. If the NameNode machine fails, manual intervention is necessary. Currently, automatic restart and failover of the NameNode software to another machine is not supported.</p><p class="paragraph"><strong>Snapshots</strong>
Snapshots support storing a copy of data at a particular instant of time. One usage of the snapshot feature may be to roll back a corrupted HDFS instance to a previously known good point in time. HDFS does not currently support snapshots but will in a future release.</p><hr/><h1 class="heading1" id="apachesparkoverview">Apache Spark Overview</h1><h1 class="heading1" id="bigdata101">Big Data 101</h1><blockquote><p class="paragraph">The IDC estimated the size of the “digital universe” at 4.4 Zettabytes (1 Trillion Gigabytes) in 2013. It grows by 40% every year, and by 2020 the IDC expects it to be as large as 44 Zettabytes, amounting to a single bit of data for every star in the physical universe.</p></blockquote><ul><li>We have a lot of data, and we aren’t getting rid of any of it. We need a way to store increasing amounts of data at scale</li><li>Even if Excel could store that much data, not many desktop computers have enough hard drive space for that anyway.</li><li>One computer works well for watching movies or working with spreadsheet software. However, there are things a computer is not powerful enough to perform - e.g data processing. Single machines do not have the power and resources to perform computations on huge amounts of information or the user does not have time to wait for the computation to finish</li></ul><p class="paragraph"><img src="https://i.stack.imgur.com/K2Glj.png"/>&quot; =&quot;300&quot;&gt;</p><ul><li>A cluster or group, of computers, pools the resources of many machines together, giving us the ability to use all the cumulative resources as if they were a single computer. </li><li>A group of machines alone is not powerful, you need a framework to coordinate work across them</li><li>Spark does just that! - Coordinating and managing the execution of tasks on data across a cluster of computers.</li></ul><p class="paragraph">Thank the cosmos we have Spark! </p><p class="paragraph"><a href="./big_data_history.md" target="_blank" rel="noopener noreferrer">Brief history of Spark - If you&#x27;d like to see the big picture</a>.</p><h1 class="heading1" id="glossary">Glossary</h1><h1 class="heading1" id="tounderstandspark,firstfamiliarizeyourselfwiththeseterms:">To understand Spark, first familiarize yourself with these terms:</h1><table><thead><tr><th>Glossary</th><th>Definition</th></tr></thead><tbody><tr><td><strong>Cluster</strong></td><td>A group of computers pooling the resources of many machines together, giving us the ability to use all the cumulative resources as if they were a single computer. YARN or Mesos or Spark&#x27;s standalone cluster manager. We then submit Spark Applications to these cluster managers</td></tr><tr><td><strong>Language APIs</strong></td><td>Make it possible to run code using programming languages (Scala, Python, Java, R, SQL)</td></tr><tr><td><strong>Computing Engine</strong></td><td>Spark handles loading data from storage systems and performing computation on it, not being a permanent storage as the end itself. You can use Spark with a wide variety of storage systems such as Azure Storage and Amazon S3, distributed file systems such as Apache Hadoop, key-value stores such as Apache Cassandra and message buses such as Apache Kafka. However, Spark does not store data long-term itself.</td></tr><tr><td><strong>Unified</strong></td><td>Spark is designed to support a wide range of data analytics tasks over the same computing engine and with a consistent set of APIs. Real world data analytics tasks tend to combine many different processing types and libraries. </td></tr><tr><td><strong>Libraries</strong></td><td>Spark supports standard libraries and external libraries. Spark includes libraries for SQL, and structured data SparkSQL, machine learning (MLlib), stream processing (Spark Streaming and the newer Structured Streaming), and graph analytics (GraphX). Beyond these libraries there are a hundreds of open source external libraries. (spark-packages.org)</td></tr><tr><td><strong>Parallel Processing</strong></td><td>Large problems divided into smaller ones, which can then be solved at the same time</td></tr></tbody></table><h1 class="heading1" id="...now,what&#x27;sspark?">...Now, What&#x27;s Spark?</h1><blockquote><p class="paragraph">Apache Spark is a <strong>unified</strong> <strong>computing engine</strong> and a set of libraries for <strong>parallel data processing</strong> on computer <strong>clusters</strong> that supports programming languages like R, Python, Java and Scala and <strong>libraries</strong> ranging from SQL to streaming and machine learning and runs everywhere from a laptop to a cluster of thousands of servers making it easy to scale up to big data processing or incredibly large scale</p></blockquote><p class="paragraph"><img src="https://ogirardot.files.wordpress.com/2015/05/future-of-spark.png"/></p><ul><li><p class="paragraph"><strong>Spark Core:</strong> This is the heart of Spark, and is responsible for management functions such as task scheduling. Spark Core implements and depends upon a programming abstraction known as Resilient Distributed Datasets (RDDs), which is outside the scope of this class.</p></li><li><p class="paragraph"><strong>Spark SQL:</strong> This is Spark’s module for working with structured data, and it is designed to support workloads that combine familiar SQL database queries with more complicated, algorithm-based analytics. Spark SQL supports the open source Hive project, and its SQL-like HiveQL query syntax. Spark SQL also supports JDBC and ODBC connections, enabling a degree of integration with existing databases, data warehouses and business intelligence tools. JDBC connectors can also be used to integrate with Apache Drill, opening up access to an even broader range of data sources.</p></li><li><p class="paragraph"><strong>Spark Streaming:</strong> This module supports scalable and fault-tolerant processing of streaming data, and can integrate with established sources of data streams like Flume (optimized for data logs) and Kafka (optimized for distributed messaging). Spark Streaming’s design, and its use of Spark’s RDD abstraction, are meant to ensure that applications written for streaming data can be repurposed to analyze batches of historical data with little modification.</p></li><li><p class="paragraph"><strong>MLlib:</strong> This is Spark’s scalable machine learning library, which implements a set of commonly used machine learning and statistical algorithms. These include correlations and hypothesis testing, classification and regression, clustering, and principal component analysis.</p></li><li><p class="paragraph"><strong>GraphX:</strong> This module began life as a separate UC Berkeley research project, which was eventually donated to the Apache Spark project. GraphX supports analysis of and computation over graphs of data, and supports a version of graph processing’s Pregel API. GraphX includes a number of widely understood graph algorithms, including PageRank.</p><h1 class="heading1" id="usecases">Use cases</h1><table><thead><tr><th>Use cases</th><th></th></tr></thead><tbody><tr><td><strong>Stream processing</strong></td><td>This data arrives in a steady stream from multiple sources simultaneously. Streams of data related to financial transactions can be processed in real time to identify – and refuse – potentially fraudulent transactions.</td></tr><tr><td><strong>Machine learning</strong></td><td>Spark’s ability to store data in memory and rapidly run repeated queries makes it a good choice for training machine learning algorithms.</td></tr><tr><td><strong>Interactive analytics</strong></td><td>Business analysts and data scientists want to explore their data by asking a question and viewing the results. This interactive query process requires systems such as Spark that are able to respond and adapt quickly.</td></tr><tr><td><strong>Data integration</strong></td><td>Data produced by different systems across a business is rarely clean or consistent enough to simply and easily be combined for reporting or analysis. Spark is used to reduce the cost and time required for this ETL process.</td></tr></tbody></table></li></ul><h1 class="heading1" id="launchingspark&#x27;sinteractiveconsole">Launching Spark&#x27;s Interactive Console</h1><p class="paragraph">You can grab Spark from here, altough we will use Databricks in this course: <a href="https://spark.apache.org/downloads.html" target="_blank" rel="noopener noreferrer">https://spark.apache.org/downloads.html</a></p><p class="paragraph">Spark runs on the <strong>JVM (Java Virtual Machine)</strong> so you need to install Java to run it. If you want to use the Python API, you will also need a Python interpreter. If you want to use R, you will need a version of R on your machine.</p><table><thead><tr><th>Python</th><th align="center">Scala</th><th align="right">SQL</th></tr></thead><tbody><tr><td>./bin/pyspark</td><td align="center">./bin/spark-shell</td><td align="right">./bin/spark-sql</td></tr><tr><td>after you have done that type &quot;spark&quot; and press Enter. You will see the &quot;SparkSession&quot; object printed </td><td align="center">after you have done that type &quot;spark&quot; and press Enter. You will see the &quot;SparkSession&quot; object printed </td><td align="right">after you have done that type &quot;spark&quot; and press Enter. You will see the &quot;SparkSession&quot; object printed </td></tr></tbody></table><ul><li><strong>SparkSession:</strong> You can control your Spark Application through a driver process called the SparkSession. The SparkSession is the way Spark executes user-defined manipulations across the cluster. There is a one-to-one correspondance between a SparkSession and a SparkApplication. SparkSession and Language APIs relationship: </li></ul><p class="paragraph"><img src="https://www.oreilly.com/library/view/spark-the-definitive/9781491912201/assets/spdg_0202.png"/></p><ul><li><strong>Spark Application Architecture:</strong> Spark applications consist of a <strong>driver process</strong> and a set of <strong>executor processes.</strong></li></ul><p class="paragraph"><img src="https://izhangzhihao.github.io/assets/images/spark-01.png"/></p><p class="paragraph">Driver is on the left, four executors on the right.  It demonstrates how the cluster manager controls physical machines and allocates resources to Spark Applications. This can be one of three cluster managers ( YARN, Mesos, Spark&#x27;s standalone cluster manager). This means that there can be multiple Spark Applications running on a cluster at the same time.</p><p class="paragraph"><em>Note: Spark, in addition to a cluster mode, also has a local mode. The driver and the executor are simply processes, this means they can live on the same machine or different machines. 
<strong>Local Mode</strong> - Driver and executor run as threads on your individual computer in stead of a cluster.</em></p><table><thead><tr><th>Driver Process</th><th align="center">Executor Process</th></tr></thead><tbody><tr><td>The heart of a Spark Application, maintains all relevant information during the lifetime of the application. Runs of your main() function, sits on a node in the cluster, and is responsible for: Maintaining information about the Spark Application. Responding to a user&#x27;s program or input. Analyzing, distributing and scheduling work across the executors</td><td align="center">Responsible for actually carrying out the work that the (&lt;-) driver assigns them. Each executor is responsible for: Executing code assigned to it by the driver. Reporting the state of the computation on that executor BACK to the driver node.</td></tr></tbody></table><p class="paragraph"><strong>Key Takeaways:</strong></p><ul><li>Spark employs a cluster manager that keeps track of the resources available</li><li>The driver process is responsible for executing the driver program&#x27;s commands across the executor to complete a given task</li></ul><p class="paragraph">The executor only runs Spark code. However, the driver can be driven from a number of different languages through Spark&#x27;s Language APIs. (Scala, Java, Python, R)</p><h1 class="heading1" id="apioverview">API Overview</h1><p class="paragraph">Structured APIs are a tool for manipulating all sorts of data, from unstructured log files to semi-structured CSV files and highly structured Parquet (Apache Parquet is a columnar storage format available to any project in the Hadoop ecosystem, regardless of the choice of data processing framework, data model or programming language) files. These APIs refer to three core types of distributed collection APIs:</p><ul><li><strong>Datasets</strong></li><li><strong>DataFrames</strong></li><li><strong>SQL Tables and Views</strong></li></ul><p class="paragraph">Majority of the Structured APIs apply to both batch and streaming computation. This means that when you work with the Structured APIs, it should be simple to migrate from batch to streaming or vice versa with little to no effort.  Structured APIs are the fundamental abstraction used to write the majority of data flows. </p><h1 class="heading1" id="dataframes">DataFrames</h1><p class="paragraph">For those familiar with the DataFrames API in other languages like R or pandas in Python, this API will make them feel right at home. In this course, we are going to focus on the <strong>DataFrame</strong> API and skip Datasets &amp; RDDs - but to explain DataFrames - we need to understand RDDs a little.</p><blockquote><p class="paragraph">A Dataframe is a distributed collection of rows under named columns. In simple terms, it looks like an Excel sheet with Column headers, or you can think of it as the equivalent to a table in a relational database or a DataFrame in R or Python.</p></blockquote><p class="paragraph"><img src="https://d1jnx9ba8s6j9r.cloudfront.net/blog/wp-content/uploads/2018/06/1-2.png"/></p><p class="paragraph"><em>Note: A DataFrame is an abstraction on top of RDDs. An RDD is broken down into partitions and a DataFrame is an abstraction on top of RDDs hence DataFrame is also partitioned. DataFrames ultimately compile down to RDDs.</em></p><p class="paragraph">DataFrames (and Datasets) are <strong>distributed table-like collection with well-defined rows and columns</strong>. Each column must have the same number of rows as all the other columns although you can use null to specify the absence of a value and each column has type information that must be consistent for every row in the collection. To Spark, DataFrames (and Datasets) represent <strong>immutable, lazily evaluated plans(transformations)</strong> that specify what operations to apply to data residing at a location to generate some output. When we perform an action on a DataFrame, we instruct Spark to perform the actual transformations and return the results. These represent plans of how to manipulate rows and columns to compute the user&#x27;s desired result. </p><ul><li>To allow every executor to perform work in parallel, Spark breaks up the data into chunks called partitions.</li><li>A partition is a collection of rows that sit on one physical machine in your cluster</li><li>A DataFrame’s partitions represent how the data is physically distributed across the cluster of machines during execution</li><li>If you have one partition, Spark will have a parallelism of only one, even if you have thousands of executors</li><li>If you have many partitions but only one executor, Spark will still have a parallelism of only one because there is only one computation resource.</li></ul><p class="paragraph"><strong>Lazy Evaluation</strong></p><ul><li>Spark waits until the very last moment to execute the graph of computation instructions</li><li>Spark will not modify data immediately when you express some operation, you build up a plan of transformations that you would like to apply to your source data</li><li>Spark optimizes the entire data flow from end to end</li><li><em>Predicate Pushdown - Spark will attempt to move filtering of data as close to the source as possible to avoid loading unnecessary data into memory</em></li><li>DataFrames have a set of columns with an unspecified number of rows -&gt; reading data is a transformation and is a lazy operation<ul><li>Spark only peeks at a couple of rows to try guess what type each column should be</li></ul></li></ul><p class="paragraph"><strong>Actions</strong></p><ul><li>Transformations allow us to build up our logical transformation plan</li><li>To trigger the computation we run an action</li><li>Action instructs Spark to compute a result from a series of transformations</li><li>The simplest action is count, which gives us the total number of records in the DataFrame</li><li>There are three kinds of actions<ul><li>Actions to view data in the console</li><li>Actions to collect data to native objects in the respective language</li><li>Actions to write to output data sources</li></ul></li></ul><p class="paragraph"><strong>Transformations:</strong></p><ul><li>Transformations are the core of how you express your business logic using Spark. There are two types of transformations:<ul><li>those that specify narrow dependencies, which are those for which each input partition will contribute to only one output partition</li><li>and those that specify wide dependencies (shuffles), where we have input partitions contributing to many output partitions</li></ul></li><li>Narrow transformations can be performed in-memory, whereas for shuffles, Spark writes the results to disk</li><li>Spark will not act on transformations until we call an action, that&#x27;s why we say that they are lazily evaluated</li><li>Lazy evaluation means that Spark will wait until the very last moment to execute the graph of computation instructions
</li></ul><p class="paragraph"><img src="https://4.bp.blogspot.com/-RDjf_UrR1Zo/W_5WzQIWuHI/AAAAAAAABGY/RbV9OnTBVhcO471mKcEwJqGMihCnHgR5ACLcBGAs/s1600/2.jpg"/></p><h1 class="heading1" id="therearetwotypesoftransformations:narrowdependenciesandwidedependencies">There are two types of transformations:  Narrow dependencies and  Wide dependencies</h1><p class="paragraph"><strong>Narrow dependencies:</strong> </p><ul><li>Each input partition will contribute to only one output partition</li></ul><pre class="css-fkgcw9 eyprwjk0"><pre><pre class="prism-code language-javascript pre" style="color:#9CDCFE;background-color:#1E1E1E" p="3"><div class="token-line"><span class="token plain">divisBy2 </span><span class="token operator" style="color:rgb(212, 212, 212)">=</span><span class="token plain"> myRange</span><span class="token punctuation" style="color:rgb(212, 212, 212)">.</span><span class="token method function property-access" style="color:rgb(220, 220, 170)">where</span><span class="token punctuation" style="color:rgb(212, 212, 212)">(</span><span class="token string" style="color:rgb(206, 145, 120)">&quot;number % 2 = 0&quot;</span><span class="token punctuation" style="color:rgb(212, 212, 212)">)</span><span class="token plain"></span></div></pre></pre></pre><ul><li>In the above code the &quot;where&quot; statement specifies a narrow dependency, where only one partition contributes to at most one output partition. (see the map, filter part of the picture below)</li><li>Automatically performs an operation called pipelining, meaning that if we specify multiple filters on DataFrames, they will all be performed in-memory</li></ul><p class="paragraph"><strong>Wide dependencies:</strong> </p><ul><li>input partitions contributing to many output partitions</li><li>Also referred to as &quot;Shuffle&quot; whereby Spark will exchange partitions across the cluster</li><li>When we perform a shuffle, Spark writes the results to disk. </li></ul><p class="paragraph"><img src="https://i.stack.imgur.com/MdxSY.png"/></p><pre class="css-fkgcw9 eyprwjk0"><pre><pre class="prism-code language-javascript pre" style="color:#9CDCFE;background-color:#1E1E1E" p="3"><div class="token-line"><span class="token plain">divisBy2 </span><span class="token operator" style="color:rgb(212, 212, 212)">=</span><span class="token plain"> myRange</span><span class="token punctuation" style="color:rgb(212, 212, 212)">.</span><span class="token method function property-access" style="color:rgb(220, 220, 170)">where</span><span class="token punctuation" style="color:rgb(212, 212, 212)">(</span><span class="token string" style="color:rgb(206, 145, 120)">&quot;number % 2 = 0&quot;</span><span class="token punctuation" style="color:rgb(212, 212, 212)">)</span><span class="token plain"></span></div></pre></pre></pre><ul><li>In specifying this action, we started a Spark job that runs our filter transformation (narrow transformation) then an aggregation (wide transformation) that performs the counts on a per partition basis, and then collect, which brings our result to a native object in the respective language</li><li>Spark UI: (for monitoring the progress of a job) Local mode: available on port 4040 of the driver node. http://localhost:4040</li><li>Spark job: represents a set of transformations triggered by an individual action, and you can monitor that job from Spark UI</li></ul><p class="paragraph"><span class="gatsby-resp-image-wrapper" style="position:relative;display:block;margin-left:auto;margin-right:auto;max-width:1035px">
      <a href="/static/73380c95dae3d58ca10013f3be99da11/351ee/spark-jobs.png" target="_blank" rel="noopener noreferrer">
    <span class="gatsby-resp-image-background-image" style="padding-bottom:16.602316602316602%;position:relative;bottom:0;left:0;background-image:url(&#x27;data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAADCAYAAACTWi8uAAAACXBIWXMAABYlAAAWJQFJUiTwAAAAZUlEQVQI163IQQqDMBQA0dz/fmqhKwOiYCMxJhW/+Rlb3bgtdOBtxlRVTWstqkop5Sd6cz0wz+5FPwX+UlHMtKx0LjCMjpTSx5uc88m564kIMcaT9x7ZNlbZaYaZx1fvaecdGzIHvobqV4XFCqYAAAAASUVORK5CYII=&#x27;);background-size:cover;display:block"></span>
  <img class="gatsby-resp-image-image" alt="Spark-Jobs" title="Spark-Jobs" src="/static/73380c95dae3d58ca10013f3be99da11/e3189/spark-jobs.png" srcSet="/static/73380c95dae3d58ca10013f3be99da11/a2ead/spark-jobs.png 259w,/static/73380c95dae3d58ca10013f3be99da11/6b9fd/spark-jobs.png 518w,/static/73380c95dae3d58ca10013f3be99da11/e3189/spark-jobs.png 1035w,/static/73380c95dae3d58ca10013f3be99da11/44d59/spark-jobs.png 1553w,/static/73380c95dae3d58ca10013f3be99da11/a6d66/spark-jobs.png 2070w,/static/73380c95dae3d58ca10013f3be99da11/351ee/spark-jobs.png 3350w" sizes="(max-width: 1035px) 100vw, 1035px" style="width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0" loading="lazy"/>
  </a>
    </span></p><h1 class="heading1" id="overviewofstructuredapiexecution">Overview of Structured API Execution</h1><p class="paragraph">How is the code actually executed across a cluster? Here’s an overview of the steps:</p><ul><li>Write DataFrame/Dataset/SQL Code</li><li>If valid code, Spark converts this to a Logical Plan</li><li>Spark transforms this Logical Plan to a Physical Plan, checking for optimizations along the way</li><li>Spark then executes this Physical Plan on the cluster</li></ul><p class="paragraph"><img src="https://i.stack.imgur.com/Y9oU5.png"/></p><p class="paragraph"><img src="https://www.oreilly.com/library/view/spark-the-definitive/9781491912201/assets/spdg_0402.png"/></p><p class="paragraph"><img src="https://www.oreilly.com/library/view/spark-the-definitive/9781491912201/assets/spdg_0403.png"/></p><h1 class="heading1" id="readdata">Read Data</h1><pre class="css-fkgcw9 eyprwjk0"><pre><pre class="prism-code language-javascript pre" style="color:#9CDCFE;background-color:#1E1E1E" p="3"><div class="token-line"><span class="token plain">df </span><span class="token operator" style="color:rgb(212, 212, 212)">=</span><span class="token plain"> spark</span><span class="token punctuation" style="color:rgb(212, 212, 212)">.</span><span class="token property-access">read</span><span class="token punctuation" style="color:rgb(212, 212, 212)">.</span><span class="token method function property-access" style="color:rgb(220, 220, 170)">options</span><span class="token punctuation" style="color:rgb(212, 212, 212)">(</span><span class="token plain">header </span><span class="token operator" style="color:rgb(212, 212, 212)">=</span><span class="token plain"> </span><span class="token string" style="color:rgb(206, 145, 120)">&quot;true&quot;</span><span class="token punctuation" style="color:rgb(212, 212, 212)">,</span><span class="token plain"> \</span></div><div class="token-line"><span class="token plain">  inferSchema </span><span class="token operator" style="color:rgb(212, 212, 212)">=</span><span class="token plain"> </span><span class="token string" style="color:rgb(206, 145, 120)">&quot;true&quot;</span><span class="token punctuation" style="color:rgb(212, 212, 212)">,</span><span class="token plain"> \</span></div><div class="token-line"><span class="token plain">  nullValue </span><span class="token operator" style="color:rgb(212, 212, 212)">=</span><span class="token plain"> </span><span class="token string" style="color:rgb(206, 145, 120)">&quot;NA&quot;</span><span class="token punctuation" style="color:rgb(212, 212, 212)">,</span><span class="token plain"> \</span></div><div class="token-line"><span class="token plain">  timestampFormat </span><span class="token operator" style="color:rgb(212, 212, 212)">=</span><span class="token plain"> </span><span class="token string" style="color:rgb(206, 145, 120)">&quot;yyyy-MM-dd&#x27;T&#x27;HH:mm?:ss&quot;</span><span class="token punctuation" style="color:rgb(212, 212, 212)">,</span><span class="token plain"> \</span></div><div class="token-line"><span class="token plain">  mode </span><span class="token operator" style="color:rgb(212, 212, 212)">=</span><span class="token plain"> </span><span class="token string" style="color:rgb(206, 145, 120)">&quot;failfast&quot;</span><span class="token punctuation" style="color:rgb(212, 212, 212)">)</span><span class="token punctuation" style="color:rgb(212, 212, 212)">.</span><span class="token method function property-access" style="color:rgb(220, 220, 170)">csv</span><span class="token punctuation" style="color:rgb(212, 212, 212)">(</span><span class="token string" style="color:rgb(206, 145, 120)">&quot;/PATH/TO/FILE&quot;</span><span class="token punctuation" style="color:rgb(212, 212, 212)">)</span><span class="token plain"></span></div></pre></pre></pre><h1 class="heading1" id="dataframeoperations">DataFrame Operations</h1><p class="paragraph">a DataFrame consists of:</p><ul><li><p class="paragraph">A series of records (like rows in a table), that are of type Row</p></li><li><p class="paragraph">A number of columns (like columns in a spreadsheet) that represent a computation expression that can be performed on each individual record in the Dataset</p></li><li><p class="paragraph"><strong>Schemas</strong> define the name as well as the type of data in each column</p><ul><li>A schema defines the column names and types of a DataFrame</li><li>We can either let a data source define the schema or we can define it explicitly ourselves</li><li>To check the schema: <code>df.printSchema()</code></li></ul></li></ul><p class="paragraph"><img src="https://www.edureka.co/blog/content/ver.1554792280/uploads/2019/04/schema-of-character-deaths-DataFrames-in-spark-Edureka.png"/></p><ul><li><p class="paragraph">A schema is a StructType made up of a number of fields, StructFields, that have a name, type, a Boolean flag which specifies whether that column can contain missing or null values, and, finally, users can optionally specify associated metadata with that column.</p></li><li><p class="paragraph"><strong>Partitioning</strong> of the DataFrame defines the layout of the DataFrame or Dataset’s physical distribution across the cluster.</p><ul><li>The partitioning scheme defines how that is allocated. You can set this to be based on values in a certain column or nondeterministically</li></ul></li></ul><h1 class="heading1" id="columnsandexpressions">Columns and Expressions</h1><ul><li>Columns in Spark are similar to columns in a spreadsheet, R dataframe, or pandas DataFrame. You can select, manipulate, and remove columns from DataFrames and these operations are represented as expressions</li><li>To construct columns we can use the <code>withColumn</code> function</li></ul><pre class="css-fkgcw9 eyprwjk0"><pre><pre class="prism-code language-javascript pre" style="color:#9CDCFE;background-color:#1E1E1E" p="3"><div class="token-line"><span class="token plain">df</span><span class="token punctuation" style="color:rgb(212, 212, 212)">.</span><span class="token method function property-access" style="color:rgb(220, 220, 170)">withColumn</span><span class="token punctuation" style="color:rgb(212, 212, 212)">(</span><span class="token string" style="color:rgb(206, 145, 120)">&#x27;newage&#x27;</span><span class="token punctuation" style="color:rgb(212, 212, 212)">,</span><span class="token plain">df</span><span class="token punctuation" style="color:rgb(212, 212, 212)">[</span><span class="token string" style="color:rgb(206, 145, 120)">&#x27;age&#x27;</span><span class="token punctuation" style="color:rgb(212, 212, 212)">]</span><span class="token punctuation" style="color:rgb(212, 212, 212)">)</span><span class="token punctuation" style="color:rgb(212, 212, 212)">.</span><span class="token method function property-access" style="color:rgb(220, 220, 170)">show</span><span class="token punctuation" style="color:rgb(212, 212, 212)">(</span><span class="token punctuation" style="color:rgb(212, 212, 212)">)</span><span class="token plain"></span></div><div class="token-line"><span class="token plain">df</span><span class="token punctuation" style="color:rgb(212, 212, 212)">.</span><span class="token method function property-access" style="color:rgb(220, 220, 170)">withColumn</span><span class="token punctuation" style="color:rgb(212, 212, 212)">(</span><span class="token string" style="color:rgb(206, 145, 120)">&#x27;half_age&#x27;</span><span class="token punctuation" style="color:rgb(212, 212, 212)">,</span><span class="token plain">df</span><span class="token punctuation" style="color:rgb(212, 212, 212)">[</span><span class="token string" style="color:rgb(206, 145, 120)">&#x27;age&#x27;</span><span class="token punctuation" style="color:rgb(212, 212, 212)">]</span><span class="token operator" style="color:rgb(212, 212, 212)">/</span><span class="token number" style="color:rgb(181, 206, 168)">2</span><span class="token punctuation" style="color:rgb(212, 212, 212)">)</span><span class="token punctuation" style="color:rgb(212, 212, 212)">.</span><span class="token method function property-access" style="color:rgb(220, 220, 170)">show</span><span class="token punctuation" style="color:rgb(212, 212, 212)">(</span><span class="token punctuation" style="color:rgb(212, 212, 212)">)</span><span class="token plain"></span></div></pre></pre></pre><h1 class="heading1" id="recordsandrows">Records and Rows</h1><ul><li>In Spark, each row in a DataFrame is a single record. Spark represents this record as an object of type Row</li><li>Spark manipulates Row objects using column expressions in order to produce usable values</li><li>Row objects internally represent arrays of bytes
We can see a row by calling <code>first</code> or <code>head(1)</code> in a DataFrame</li></ul><pre class="css-fkgcw9 eyprwjk0"><pre><pre class="prism-code language-javascript pre" style="color:#9CDCFE;background-color:#1E1E1E" p="3"><div class="token-line"><span class="token plain">df</span><span class="token punctuation" style="color:rgb(212, 212, 212)">.</span><span class="token method function property-access" style="color:rgb(220, 220, 170)">first</span><span class="token punctuation" style="color:rgb(212, 212, 212)">(</span><span class="token punctuation" style="color:rgb(212, 212, 212)">)</span><span class="token plain"></span></div><div class="token-line"><span class="token plain">df</span><span class="token punctuation" style="color:rgb(212, 212, 212)">.</span><span class="token method function property-access" style="color:rgb(220, 220, 170)">head</span><span class="token punctuation" style="color:rgb(212, 212, 212)">(</span><span class="token number" style="color:rgb(181, 206, 168)">1</span><span class="token punctuation" style="color:rgb(212, 212, 212)">)</span><span class="token plain"></span></div></pre></pre></pre><h1 class="heading1" id="dataframetransformations">DataFrame Transformations</h1><ul><li><code>select</code> allows you to do the DataFrame equivalent of SQL queries on a table of data:</li></ul><pre class="css-fkgcw9 eyprwjk0"><pre><pre class="prism-code language-javascript pre" style="color:#9CDCFE;background-color:#1E1E1E" p="3"><div class="token-line"><span class="token plain">df</span><span class="token punctuation" style="color:rgb(212, 212, 212)">.</span><span class="token method function property-access" style="color:rgb(220, 220, 170)">select</span><span class="token punctuation" style="color:rgb(212, 212, 212)">(</span><span class="token string" style="color:rgb(206, 145, 120)">&quot;age&quot;</span><span class="token punctuation" style="color:rgb(212, 212, 212)">)</span><span class="token punctuation" style="color:rgb(212, 212, 212)">.</span><span class="token method function property-access" style="color:rgb(220, 220, 170)">show</span><span class="token punctuation" style="color:rgb(212, 212, 212)">(</span><span class="token number" style="color:rgb(181, 206, 168)">2</span><span class="token punctuation" style="color:rgb(212, 212, 212)">)</span><span class="token plain"></span></div></pre></pre></pre><ul><li>We can register the DataFrame as a SQL temporary view (It&#x27;s thde equivalent of <code>SELECT AGE FROM PEOPLE LIMIT 2</code>)</li></ul><pre class="css-fkgcw9 eyprwjk0"><pre><pre class="prism-code language-javascript pre" style="color:#9CDCFE;background-color:#1E1E1E" p="3"><div class="token-line"><span class="token plain">df</span><span class="token punctuation" style="color:rgb(212, 212, 212)">.</span><span class="token method function property-access" style="color:rgb(220, 220, 170)">createOrReplaceTempView</span><span class="token punctuation" style="color:rgb(212, 212, 212)">(</span><span class="token string" style="color:rgb(206, 145, 120)">&quot;people&quot;</span><span class="token punctuation" style="color:rgb(212, 212, 212)">)</span><span class="token plain"></span></div></pre></pre></pre><p class="paragraph"><strong>Filtering Rows</strong>
Example:</p><pre class="css-fkgcw9 eyprwjk0"><pre><pre class="prism-code language-javascript pre" style="color:#9CDCFE;background-color:#1E1E1E" p="3"><div class="token-line"><span class="token plain">df</span><span class="token punctuation" style="color:rgb(212, 212, 212)">.</span><span class="token method function property-access" style="color:rgb(220, 220, 170)">filter</span><span class="token punctuation" style="color:rgb(212, 212, 212)">(</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(212, 212, 212)">(</span><span class="token plain">df</span><span class="token punctuation" style="color:rgb(212, 212, 212)">[</span><span class="token string" style="color:rgb(206, 145, 120)">&quot;Close&quot;</span><span class="token punctuation" style="color:rgb(212, 212, 212)">]</span><span class="token plain"> </span><span class="token operator" style="color:rgb(212, 212, 212)">&lt;</span><span class="token plain"> </span><span class="token number" style="color:rgb(181, 206, 168)">200</span><span class="token punctuation" style="color:rgb(212, 212, 212)">)</span><span class="token plain"> </span><span class="token operator" style="color:rgb(212, 212, 212)">|</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(212, 212, 212)">(</span><span class="token plain">df</span><span class="token punctuation" style="color:rgb(212, 212, 212)">[</span><span class="token string" style="color:rgb(206, 145, 120)">&#x27;Open&#x27;</span><span class="token punctuation" style="color:rgb(212, 212, 212)">]</span><span class="token plain"> </span><span class="token operator" style="color:rgb(212, 212, 212)">&gt;</span><span class="token plain"> </span><span class="token number" style="color:rgb(181, 206, 168)">200</span><span class="token punctuation" style="color:rgb(212, 212, 212)">)</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(212, 212, 212)">)</span><span class="token punctuation" style="color:rgb(212, 212, 212)">.</span><span class="token method function property-access" style="color:rgb(220, 220, 170)">show</span><span class="token punctuation" style="color:rgb(212, 212, 212)">(</span><span class="token punctuation" style="color:rgb(212, 212, 212)">)</span><span class="token plain"></span></div></pre></pre></pre><p class="paragraph"><strong>Sorting Rows</strong>
For sorting we can use <code>sort</code> and <code>orderBy</code> which function similarly:</p><pre class="css-fkgcw9 eyprwjk0"><pre><pre class="prism-code language-javascript pre" style="color:#9CDCFE;background-color:#1E1E1E" p="3"><div class="token-line"><span class="token plain">df</span><span class="token punctuation" style="color:rgb(212, 212, 212)">.</span><span class="token method function property-access" style="color:rgb(220, 220, 170)">sort</span><span class="token punctuation" style="color:rgb(212, 212, 212)">(</span><span class="token string" style="color:rgb(206, 145, 120)">&quot;Sales&quot;</span><span class="token punctuation" style="color:rgb(212, 212, 212)">)</span><span class="token punctuation" style="color:rgb(212, 212, 212)">.</span><span class="token method function property-access" style="color:rgb(220, 220, 170)">show</span><span class="token punctuation" style="color:rgb(212, 212, 212)">(</span><span class="token punctuation" style="color:rgb(212, 212, 212)">)</span><span class="token plain"></span></div><div class="token-line"><span class="token plain">df</span><span class="token punctuation" style="color:rgb(212, 212, 212)">.</span><span class="token method function property-access" style="color:rgb(220, 220, 170)">orderBy</span><span class="token punctuation" style="color:rgb(212, 212, 212)">(</span><span class="token string" style="color:rgb(206, 145, 120)">&quot;Sales&quot;</span><span class="token punctuation" style="color:rgb(212, 212, 212)">)</span><span class="token punctuation" style="color:rgb(212, 212, 212)">.</span><span class="token method function property-access" style="color:rgb(220, 220, 170)">show</span><span class="token punctuation" style="color:rgb(212, 212, 212)">(</span><span class="token punctuation" style="color:rgb(212, 212, 212)">)</span><span class="token plain"></span></div></pre></pre></pre><p class="paragraph"><strong>Grouping</strong></p><pre class="css-fkgcw9 eyprwjk0"><pre><pre class="prism-code language-javascript pre" style="color:#9CDCFE;background-color:#1E1E1E" p="3"><div class="token-line"><span class="token plain">df</span><span class="token punctuation" style="color:rgb(212, 212, 212)">.</span><span class="token method function property-access" style="color:rgb(220, 220, 170)">groupBy</span><span class="token punctuation" style="color:rgb(212, 212, 212)">(</span><span class="token string" style="color:rgb(206, 145, 120)">&quot;Company&quot;</span><span class="token punctuation" style="color:rgb(212, 212, 212)">)</span><span class="token plain"></span></div><div class="token-line"><span class="token plain">df</span><span class="token punctuation" style="color:rgb(212, 212, 212)">.</span><span class="token method function property-access" style="color:rgb(220, 220, 170)">groupBy</span><span class="token punctuation" style="color:rgb(212, 212, 212)">(</span><span class="token string" style="color:rgb(206, 145, 120)">&quot;Company&quot;</span><span class="token punctuation" style="color:rgb(212, 212, 212)">)</span><span class="token punctuation" style="color:rgb(212, 212, 212)">.</span><span class="token method function property-access" style="color:rgb(220, 220, 170)">count</span><span class="token punctuation" style="color:rgb(212, 212, 212)">(</span><span class="token punctuation" style="color:rgb(212, 212, 212)">)</span><span class="token punctuation" style="color:rgb(212, 212, 212)">.</span><span class="token method function property-access" style="color:rgb(220, 220, 170)">show</span><span class="token punctuation" style="color:rgb(212, 212, 212)">(</span><span class="token punctuation" style="color:rgb(212, 212, 212)">)</span><span class="token plain"></span></div><div class="token-line"><span class="token plain">df</span><span class="token punctuation" style="color:rgb(212, 212, 212)">.</span><span class="token method function property-access" style="color:rgb(220, 220, 170)">groupBy</span><span class="token punctuation" style="color:rgb(212, 212, 212)">(</span><span class="token string" style="color:rgb(206, 145, 120)">&quot;Company&quot;</span><span class="token punctuation" style="color:rgb(212, 212, 212)">)</span><span class="token punctuation" style="color:rgb(212, 212, 212)">.</span><span class="token method function property-access" style="color:rgb(220, 220, 170)">mean</span><span class="token punctuation" style="color:rgb(212, 212, 212)">(</span><span class="token punctuation" style="color:rgb(212, 212, 212)">)</span><span class="token punctuation" style="color:rgb(212, 212, 212)">.</span><span class="token method function property-access" style="color:rgb(220, 220, 170)">show</span><span class="token punctuation" style="color:rgb(212, 212, 212)">(</span><span class="token punctuation" style="color:rgb(212, 212, 212)">)</span><span class="token plain"></span></div><div class="token-line"><span class="token plain">df</span><span class="token punctuation" style="color:rgb(212, 212, 212)">.</span><span class="token method function property-access" style="color:rgb(220, 220, 170)">groupBy</span><span class="token punctuation" style="color:rgb(212, 212, 212)">(</span><span class="token string" style="color:rgb(206, 145, 120)">&quot;Company&quot;</span><span class="token punctuation" style="color:rgb(212, 212, 212)">)</span><span class="token punctuation" style="color:rgb(212, 212, 212)">.</span><span class="token method function property-access" style="color:rgb(220, 220, 170)">min</span><span class="token punctuation" style="color:rgb(212, 212, 212)">(</span><span class="token punctuation" style="color:rgb(212, 212, 212)">)</span><span class="token punctuation" style="color:rgb(212, 212, 212)">.</span><span class="token method function property-access" style="color:rgb(220, 220, 170)">show</span><span class="token punctuation" style="color:rgb(212, 212, 212)">(</span><span class="token punctuation" style="color:rgb(212, 212, 212)">)</span><span class="token plain"></span></div></pre></pre></pre><h1 class="heading1" id="dataframeaggregations">DataFrame Aggregations</h1><ul><li>Aggregating is the act of collecting something together and is a cornerstone of big data analytics. In an aggregation, you will specify a key or grouping and an aggregation function that specifies how you should transform one or more columns</li><li>This function must produce one result for each group, given multiple input values. </li></ul><p class="paragraph">All aggregations are available as functions, most aggregation functions can be found here:
<a href="http://spark.apache.org/docs/latest/api/scala/index.html#org.apache.spark.sql.functions$" target="_blank" rel="noopener noreferrer">http://spark.apache.org/docs/latest/api/scala/index.html#org.apache.spark.sql.functions$</a></p><ul><li><code>count</code> function allows us to specify a specific column to count</li></ul><pre class="css-fkgcw9 eyprwjk0"><pre><pre class="prism-code language-javascript pre" style="color:#9CDCFE;background-color:#1E1E1E" p="3"><div class="token-line"><span class="token plain">df</span><span class="token punctuation" style="color:rgb(212, 212, 212)">.</span><span class="token method function property-access" style="color:rgb(220, 220, 170)">select</span><span class="token punctuation" style="color:rgb(212, 212, 212)">(</span><span class="token function" style="color:rgb(220, 220, 170)">count</span><span class="token punctuation" style="color:rgb(212, 212, 212)">(</span><span class="token string" style="color:rgb(206, 145, 120)">&quot;Sales&quot;</span><span class="token punctuation" style="color:rgb(212, 212, 212)">)</span><span class="token punctuation" style="color:rgb(212, 212, 212)">)</span><span class="token punctuation" style="color:rgb(212, 212, 212)">.</span><span class="token method function property-access" style="color:rgb(220, 220, 170)">show</span><span class="token punctuation" style="color:rgb(212, 212, 212)">(</span><span class="token punctuation" style="color:rgb(212, 212, 212)">)</span><span class="token plain"></span></div></pre></pre></pre><ul><li><code>countdistinct</code> function gives us the number of unique groups</li></ul><pre class="css-fkgcw9 eyprwjk0"><pre><pre class="prism-code language-javascript pre" style="color:#9CDCFE;background-color:#1E1E1E" p="3"><div class="token-line"><span class="token keyword module" style="color:rgb(86, 156, 214)">from</span><span class="token plain"> pyspark</span><span class="token punctuation" style="color:rgb(212, 212, 212)">.</span><span class="token property-access">sql</span><span class="token punctuation" style="color:rgb(212, 212, 212)">.</span><span class="token property-access">functions</span><span class="token plain"> </span><span class="token keyword module" style="color:rgb(86, 156, 214)">import</span><span class="token plain"> countDistinct</span></div><div class="token-line"><span class="token plain">df</span><span class="token punctuation" style="color:rgb(212, 212, 212)">.</span><span class="token method function property-access" style="color:rgb(220, 220, 170)">select</span><span class="token punctuation" style="color:rgb(212, 212, 212)">(</span><span class="token function" style="color:rgb(220, 220, 170)">countDistinct</span><span class="token punctuation" style="color:rgb(212, 212, 212)">(</span><span class="token string" style="color:rgb(206, 145, 120)">&quot;Sales&quot;</span><span class="token punctuation" style="color:rgb(212, 212, 212)">)</span><span class="token punctuation" style="color:rgb(212, 212, 212)">)</span><span class="token punctuation" style="color:rgb(212, 212, 212)">.</span><span class="token method function property-access" style="color:rgb(220, 220, 170)">show</span><span class="token punctuation" style="color:rgb(212, 212, 212)">(</span><span class="token punctuation" style="color:rgb(212, 212, 212)">)</span><span class="token plain"></span></div></pre></pre></pre><h1 class="heading1" id="methods">Methods</h1><p class="paragraph"><a href="http://spark.apache.org/docs/latest/api/scala/index.html#org.apache.spark.sql.functions$" target="_blank" rel="noopener noreferrer">http://spark.apache.org/docs/latest/api/scala/index.html#org.apache.spark.sql.functions$</a>
<a href="http://spark.apache.org/docs/latest/api/scala/index.html#org.apache.spark.sql.DataFrameStatFunctions" target="_blank" rel="noopener noreferrer">http://spark.apache.org/docs/latest/api/scala/index.html#org.apache.spark.sql.DataFrameStatFunctions</a>
<a href="http://spark.apache.org/docs/latest/api/scala/index.html#org.apache.spark.sql.Column" target="_blank" rel="noopener noreferrer">http://spark.apache.org/docs/latest/api/scala/index.html#org.apache.spark.sql.Column</a>
<a href="http://spark.apache.org/docs/latest/api/scala/index.html#org.apache.spark.sql.Dataset" target="_blank" rel="noopener noreferrer">http://spark.apache.org/docs/latest/api/scala/index.html#org.apache.spark.sql.Dataset</a></p><h1 class="heading1" id="joins">Joins</h1><ul><li><p class="paragraph">Joins are an essential part of nearly all Spark workloads. Spark’s ability to talk to different data means that you gain the ability to tap into a variety of data sources across your company</p></li><li><p class="paragraph">Whereas the join expression determines whether two rows should join, the join type determines what should be in the result set. There are a variety of different join types available in Spark for you to use such as (list not-exhaustive):</p></li><li><p class="paragraph">Inner joins (keep rows with keys that exist in the left and right datasets)</p></li><li><p class="paragraph">Outer joins (keep rows with keys in either the left or right datasets)</p></li><li><p class="paragraph">Left outer joins (keep rows with keys in the left dataset)</p></li><li><p class="paragraph">Right outer joins (keep rows with keys in the right dataset)</p></li></ul><p class="paragraph"><strong>Key Takeaways:</strong></p><ul><li>Lazy Evaluation in Spark means that the execution will not start until an action is triggered.</li><li>Transformations are lazy in nature i.e., they get execute when we call an action. They are not executed immediately. Two most basic type of transformations is a <code>map()</code>, <code>filter()</code>.</li><li>Actions are like a valve and until action is fired, the data to be processed is not even in the pipes, i.e. transformations. Only actions can materialize the entire processing pipeline with real data. </li></ul><h1 class="heading1" id="example">Example</h1><p class="paragraph"><a href="https://ocw.mit.edu/ans7870/6/6.006/s08/lecturenotes/files/t8.shakespeare.txt" target="_blank" rel="noopener noreferrer">https://ocw.mit.edu/ans7870/6/6.006/s08/lecturenotes/files/t8.shakespeare.txt</a></p><p class="paragraph"><strong>A simple program that performs a word count on the collected works of Shakespeare</strong></p><pre class="css-fkgcw9 eyprwjk0"><pre><pre class="prism-code language-javascript pre" style="color:#9CDCFE;background-color:#1E1E1E" p="3"><div class="token-line"><span class="token keyword module" style="color:rgb(86, 156, 214)">from</span><span class="token plain"> pyspark </span><span class="token keyword module" style="color:rgb(86, 156, 214)">import</span><span class="token plain"> </span><span class="token maybe-class-name">SparkContext</span><span class="token punctuation" style="color:rgb(212, 212, 212)">,</span><span class="token plain"> </span><span class="token maybe-class-name">SparkConf</span><span class="token plain"></span></div><div class="token-line"><span class="token plain">conf </span><span class="token operator" style="color:rgb(212, 212, 212)">=</span><span class="token plain"> </span><span class="token function maybe-class-name" style="color:rgb(220, 220, 170)">SparkConf</span><span class="token punctuation" style="color:rgb(212, 212, 212)">(</span><span class="token punctuation" style="color:rgb(212, 212, 212)">)</span><span class="token punctuation" style="color:rgb(212, 212, 212)">.</span><span class="token method function property-access" style="color:rgb(220, 220, 170)">setAppName</span><span class="token punctuation" style="color:rgb(212, 212, 212)">(</span><span class="token string" style="color:rgb(206, 145, 120)">&#x27;MyFirstStandaloneApp&#x27;</span><span class="token punctuation" style="color:rgb(212, 212, 212)">)</span><span class="token plain"></span></div><div class="token-line"><span class="token plain">sc </span><span class="token operator" style="color:rgb(212, 212, 212)">=</span><span class="token plain"> </span><span class="token function maybe-class-name" style="color:rgb(220, 220, 170)">SparkContext</span><span class="token punctuation" style="color:rgb(212, 212, 212)">(</span><span class="token plain">conf</span><span class="token operator" style="color:rgb(212, 212, 212)">=</span><span class="token plain">conf</span><span class="token punctuation" style="color:rgb(212, 212, 212)">)</span><span class="token plain"></span></div><div class="token-line"><span class="token plain">text_file </span><span class="token operator" style="color:rgb(212, 212, 212)">=</span><span class="token plain"> sc</span><span class="token punctuation" style="color:rgb(212, 212, 212)">.</span><span class="token method function property-access" style="color:rgb(220, 220, 170)">textFile</span><span class="token punctuation" style="color:rgb(212, 212, 212)">(</span><span class="token string" style="color:rgb(206, 145, 120)">&quot;./shakespeare.txt&quot;</span><span class="token punctuation" style="color:rgb(212, 212, 212)">)</span><span class="token plain"></span></div><div class="token-line"><span class="token plain">counts </span><span class="token operator" style="color:rgb(212, 212, 212)">=</span><span class="token plain"> text_file</span><span class="token punctuation" style="color:rgb(212, 212, 212)">.</span><span class="token method function property-access" style="color:rgb(220, 220, 170)">flatMap</span><span class="token punctuation" style="color:rgb(212, 212, 212)">(</span><span class="token plain">lambda line</span><span class="token punctuation" style="color:rgb(212, 212, 212)">:</span><span class="token plain"> line</span><span class="token punctuation" style="color:rgb(212, 212, 212)">.</span><span class="token method function property-access" style="color:rgb(220, 220, 170)">split</span><span class="token punctuation" style="color:rgb(212, 212, 212)">(</span><span class="token string" style="color:rgb(206, 145, 120)">&quot; &quot;</span><span class="token punctuation" style="color:rgb(212, 212, 212)">)</span><span class="token punctuation" style="color:rgb(212, 212, 212)">)</span><span class="token plain"> \</span></div><div class="token-line"><span class="token plain">             </span><span class="token punctuation" style="color:rgb(212, 212, 212)">.</span><span class="token method function property-access" style="color:rgb(220, 220, 170)">map</span><span class="token punctuation" style="color:rgb(212, 212, 212)">(</span><span class="token plain">lambda word</span><span class="token punctuation" style="color:rgb(212, 212, 212)">:</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(212, 212, 212)">(</span><span class="token plain">word</span><span class="token punctuation" style="color:rgb(212, 212, 212)">,</span><span class="token plain"> </span><span class="token number" style="color:rgb(181, 206, 168)">1</span><span class="token punctuation" style="color:rgb(212, 212, 212)">)</span><span class="token punctuation" style="color:rgb(212, 212, 212)">)</span><span class="token plain"> \</span></div><div class="token-line"><span class="token plain">             </span><span class="token punctuation" style="color:rgb(212, 212, 212)">.</span><span class="token method function property-access" style="color:rgb(220, 220, 170)">reduceByKey</span><span class="token punctuation" style="color:rgb(212, 212, 212)">(</span><span class="token plain">lambda a</span><span class="token punctuation" style="color:rgb(212, 212, 212)">,</span><span class="token plain"> b</span><span class="token punctuation" style="color:rgb(212, 212, 212)">:</span><span class="token plain"> a </span><span class="token operator" style="color:rgb(212, 212, 212)">+</span><span class="token plain"> b</span><span class="token punctuation" style="color:rgb(212, 212, 212)">)</span><span class="token plain"></span></div><div class="token-line"><span class="token plain"></span><span class="token function" style="color:rgb(220, 220, 170)">print</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(212, 212, 212)">(</span><span class="token string" style="color:rgb(206, 145, 120)">&quot;Number of elements: &quot;</span><span class="token plain"> </span><span class="token operator" style="color:rgb(212, 212, 212)">+</span><span class="token plain"> </span><span class="token function" style="color:rgb(220, 220, 170)">str</span><span class="token punctuation" style="color:rgb(212, 212, 212)">(</span><span class="token plain">counts</span><span class="token punctuation" style="color:rgb(212, 212, 212)">.</span><span class="token method function property-access" style="color:rgb(220, 220, 170)">count</span><span class="token punctuation" style="color:rgb(212, 212, 212)">(</span><span class="token punctuation" style="color:rgb(212, 212, 212)">)</span><span class="token punctuation" style="color:rgb(212, 212, 212)">)</span><span class="token punctuation" style="color:rgb(212, 212, 212)">)</span><span class="token plain"></span></div><div class="token-line"><span class="token plain">counts</span><span class="token punctuation" style="color:rgb(212, 212, 212)">.</span><span class="token method function property-access" style="color:rgb(220, 220, 170)">saveAsTextFile</span><span class="token punctuation" style="color:rgb(212, 212, 212)">(</span><span class="token string" style="color:rgb(206, 145, 120)">&quot;./shakespeareWordCount&quot;</span><span class="token punctuation" style="color:rgb(212, 212, 212)">)</span><span class="token plain"></span></div></pre></pre></pre><p class="paragraph">Sources:
To be finished</p></div><div class="addPaddTopBottom"><style data-emotion-css="1594l43">.css-1594l43{margin:0px;padding:0px;width:auto;display:grid;grid-template-rows:auto;-webkit-column-gap:24px;column-gap:24px;grid-template-columns:calc(50% - 8px) calc(50% - 8px);}.css-1594l43 .previousBtn{cursor:pointer;-moz-box-align:center;-moz-box-direction:normal;-moz-box-orient:horizontal;margin:0px;padding:0px;position:relative;display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-flex-direction:row;-ms-flex-direction:row;flex-direction:row;-webkit-align-items:center;-webkit-box-align:center;-ms-flex-align:center;align-items:center;place-self:stretch;border-radius:3px;border:1px solid rgb(230,236,241);-webkit-transition:border 200ms ease 0s;transition:border 200ms ease 0s;box-shadow:rgba(116,129,141,0.1) 0px 3px 8px 0px;-webkit-text-decoration:none;text-decoration:none;background-color:#fff;color:#3B454E;}.css-1594l43 .nextBtn{cursor:pointer;-moz-box-align:center;-moz-box-direction:normal;-moz-box-orient:horizontal;margin:0px;padding:0px;position:relative;display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-flex-direction:row;-ms-flex-direction:row;flex-direction:row;-webkit-align-items:center;-webkit-box-align:center;-ms-flex-align:center;align-items:center;place-self:stretch;border-radius:3px;border:1px solid rgb(230,236,241);-webkit-transition:border 200ms ease 0s;transition:border 200ms ease 0s;box-shadow:rgba(116,129,141,0.1) 0px 3px 8px 0px;-webkit-text-decoration:none;text-decoration:none;background-color:#fff;color:#3B454E;}.css-1594l43 .nextBtn:hover,.css-1594l43 .previousBtn:hover{-webkit-text-decoration:none;text-decoration:none;border:1px solid #125fb3;}.css-1594l43 .nextBtn:hover .rightArrow,.css-1594l43 .previousBtn:hover .leftArrow{color:#125fb3;}.css-1594l43 .leftArrow{display:block;margin:0px;color:rgb(157,170,182);-webkit-flex:0 0 auto;-ms-flex:0 0 auto;flex:0 0 auto;font-size:24px;-webkit-transition:color 200ms ease 0s;transition:color 200ms ease 0s;padding:16px;padding-right:16px;}.css-1594l43 .rightArrow{-webkit-flex:0 0 auto;-ms-flex:0 0 auto;flex:0 0 auto;font-size:24px;-webkit-transition:color 200ms ease 0s;transition:color 200ms ease 0s;padding:16px;padding-left:16px;display:block;margin:0px;color:rgb(157,170,182);}.css-1594l43 .nextPreviousTitle{display:block;margin:0px;padding:0px;-webkit-transition:color 200ms ease 0s;transition:color 200ms ease 0s;}.css-1594l43 .nextPreviousTitle span{font-size:16px;line-height:1.5;font-weight:500;}@media (max-width:767px){.css-1594l43{display:block;padding:0 15px;}.css-1594l43 .previousBtn{margin-bottom:20px;}}</style><div class="css-1594l43 eg6ngbo0"><a class="previousBtn" href="/serverless/3-serverless"><div class="leftArrow"><svg preserveAspectRatio="xMidYMid meet" height="1em" width="1em" fill="none" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" stroke="currentColor" class="_13gjrqj"><g><line x1="19" y1="12" x2="5" y2="12"></line><polyline points="12 19 5 12 12 5"></polyline></g></svg></div><div class="preRightWrapper"><div class="smallContent"><span>Previous</span></div><div class="nextPreviousTitle"><span>Homework</span></div></div></a><a class="nextBtn" href="/apachespark/1-apachespark"><div class="nextRightWrapper"><div class="smallContent"><span>Next</span></div><div class="nextPreviousTitle"><span>Class Resources</span></div></div><div class="rightArrow"><svg preserveAspectRatio="xMidYMid meet" height="1em" width="1em" fill="none" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" stroke="currentColor" class="_13gjrqj"><g><line x1="5" y1="12" x2="19" y2="12"></line><polyline points="12 5 19 12 12 19"></polyline></g></svg></div></a></div></div></div></main><style data-emotion-css="gqp3x7">.css-gqp3x7{width:224px;}</style><div class="hiddenMobile css-gqp3x7 eso2aao4"><style data-emotion-css="1dq6tsi">.css-1dq6tsi{width:100%;border-right:1px solid #ede7f3;height:100vh;overflow:auto;position:fixed;padding-left:24px;position:-webkit-sticky;position:-moz-sticky;position:-webkit-sticky;position:sticky;top:0;background:#fff;}.css-1dq6tsi .rightSideTitle{font-size:10px;line-height:1;font-weight:700;text-transform:uppercase;-webkit-letter-spacing:1.2px;-moz-letter-spacing:1.2px;-ms-letter-spacing:1.2px;letter-spacing:1.2px;padding:7px 24px 7px 16px;border-left:1px solid #e6ecf1;border-left-color:rgb(230,236,241);color:#3B454E;}.css-1dq6tsi .rightSideBarUL{margin-top:32px;}.css-1dq6tsi .rightSideBarUL li{list-style-type:none;border-left:1px solid #e6ecf1;border-left-color:rgb(230,236,241);}.css-1dq6tsi .rightSideBarUL li a{font-size:12px;font-weight:500;line-height:1.5;padding:7px 24px 7px 16px;color:#3B454E;}@media only screen and (max-width:50rem){.css-1dq6tsi{width:100%;position:relative;}}</style><aside class="css-1dq6tsi e1djfo3h0"><ul class="rightSideBarUL"><li class="rightSideTitle">CONTENTS</li><style data-emotion-css="36sxcj">.css-36sxcj{list-style:none;}.css-36sxcj a{color:#5c6975;-webkit-text-decoration:none;text-decoration:none;font-weight:400;padding:0.45rem 0 0.45rem 3rem;display:block;position:relative;}.css-36sxcj a:hover{color:#125fb3 !important;}.css-36sxcj a svg{float:right;margin-right:1rem;}</style><li class="css-36sxcj e1djfo3h1"><a href="#pythonquickguide" to="#pythonquickguide"> <!-- -->Python Quick Guide<!-- --> </a> </li><li class="css-36sxcj e1djfo3h1"><a href="#hdfsarchitecture(hadoopdistributedfilesystem)" to="#hdfsarchitecture(hadoopdistributedfilesystem)"> <!-- -->HDFS Architecture (Hadoop Distributed File System)<!-- --> </a> </li><li class="css-36sxcj e1djfo3h1"><a href="#introduction" to="#introduction"> <!-- -->Introduction<!-- --> </a> </li><li class="css-36sxcj e1djfo3h1"><a href="#faulttolerance" to="#faulttolerance"> <!-- -->Fault Tolerance<!-- --> </a> </li><li class="css-36sxcj e1djfo3h1"><a href="#hdfsgoals" to="#hdfsgoals"> <!-- -->HDFS Goals<!-- --> </a> </li><li class="css-36sxcj e1djfo3h1"><a href="#namenodeanddatanodes" to="#namenodeanddatanodes"> <!-- -->NameNode and DataNodes<!-- --> </a> </li><li class="css-36sxcj e1djfo3h1"><a href="#datareplication" to="#datareplication"> <!-- -->Data Replication<!-- --> </a> </li><li class="css-36sxcj e1djfo3h1"><a href="#robustness" to="#robustness"> <!-- -->Robustness<!-- --> </a> </li><li class="css-36sxcj e1djfo3h1"><a href="#apachesparkoverview" to="#apachesparkoverview"> <!-- -->Apache Spark Overview<!-- --> </a> </li><li class="css-36sxcj e1djfo3h1"><a href="#bigdata101" to="#bigdata101"> <!-- -->Big Data 101<!-- --> </a> </li><li class="css-36sxcj e1djfo3h1"><a href="#glossary" to="#glossary"> <!-- -->Glossary<!-- --> </a> </li><li class="css-36sxcj e1djfo3h1"><a href="#tounderstandspark,firstfamiliarizeyourselfwiththeseterms:" to="#tounderstandspark,firstfamiliarizeyourselfwiththeseterms:"> <!-- -->To understand Spark, first familiarize yourself with these terms:<!-- --> </a> </li><li class="css-36sxcj e1djfo3h1"><a href="#...now,what&#x27;sspark?" to="#...now,what&#x27;sspark?"> <!-- -->...Now, What&#x27;s Spark?<!-- --> </a> </li><li class="css-36sxcj e1djfo3h1"><a href="#launchingspark&#x27;sinteractiveconsole" to="#launchingspark&#x27;sinteractiveconsole"> <!-- -->Launching Spark&#x27;s Interactive Console<!-- --> </a> </li><li class="css-36sxcj e1djfo3h1"><a href="#apioverview" to="#apioverview"> <!-- -->API Overview<!-- --> </a> </li><li class="css-36sxcj e1djfo3h1"><a href="#dataframes" to="#dataframes"> <!-- -->DataFrames<!-- --> </a> </li><li class="css-36sxcj e1djfo3h1"><a href="#therearetwotypesoftransformations:narrowdependenciesandwidedependencies" to="#therearetwotypesoftransformations:narrowdependenciesandwidedependencies"> <!-- -->There are two types of transformations:  Narrow dependencies and  Wide dependencies<!-- --> </a> </li><li class="css-36sxcj e1djfo3h1"><a href="#overviewofstructuredapiexecution" to="#overviewofstructuredapiexecution"> <!-- -->Overview of Structured API Execution<!-- --> </a> </li><li class="css-36sxcj e1djfo3h1"><a href="#readdata" to="#readdata"> <!-- -->Read Data<!-- --> </a> </li><li class="css-36sxcj e1djfo3h1"><a href="#dataframeoperations" to="#dataframeoperations"> <!-- -->DataFrame Operations<!-- --> </a> </li><li class="css-36sxcj e1djfo3h1"><a href="#columnsandexpressions" to="#columnsandexpressions"> <!-- -->Columns and Expressions<!-- --> </a> </li><li class="css-36sxcj e1djfo3h1"><a href="#recordsandrows" to="#recordsandrows"> <!-- -->Records and Rows<!-- --> </a> </li><li class="css-36sxcj e1djfo3h1"><a href="#dataframetransformations" to="#dataframetransformations"> <!-- -->DataFrame Transformations<!-- --> </a> </li><li class="css-36sxcj e1djfo3h1"><a href="#dataframeaggregations" to="#dataframeaggregations"> <!-- -->DataFrame Aggregations<!-- --> </a> </li><li class="css-36sxcj e1djfo3h1"><a href="#methods" to="#methods"> <!-- -->Methods<!-- --> </a> </li><li class="css-36sxcj e1djfo3h1"><a href="#joins" to="#joins"> <!-- -->Joins<!-- --> </a> </li><li class="css-36sxcj e1djfo3h1"><a href="#example" to="#example"> <!-- -->Example<!-- --> </a> </li></ul></aside></div></div></div></div><div id="gatsby-announcer" style="position:absolute;top:0;width:1px;height:1px;padding:0;overflow:hidden;clip:rect(0, 0, 0, 0);white-space:nowrap;border:0" aria-live="assertive" aria-atomic="true"></div></div><script id="gatsby-script-loader">/*<![CDATA[*/window.pagePath="/apachespark";/*]]>*/</script><script id="gatsby-chunk-mapping">/*<![CDATA[*/window.___chunkMapping={"polyfill":["/polyfill-50eea0acba5bd0bbefbf.js"],"app":["/app-a00f8caa95f00bf7280b.js"],"component---src-templates-docs-js":[]};/*]]>*/</script><script src="/polyfill-50eea0acba5bd0bbefbf.js" nomodule=""></script><script src="/app-a00f8caa95f00bf7280b.js" async=""></script><script src="/commons-2ef445fb87a62dd81c1d.js" async=""></script><script src="/framework-c90682c3d94fb45fdc20.js" async=""></script><script src="/webpack-runtime-22c4b15bc7d72b664a75.js" async=""></script><script defer="">
            function navBarClose() {
              document.getElementById("navbar").classList.toggle("responsive");
            }
            document.addEventListener('click',function(e){
              if(e.target && e.target.tagName.toLowerCase() === 'a'){
                navBarClose();
              }
           });
            </script></body></html>